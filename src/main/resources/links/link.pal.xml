<?xml version='1.0' encoding='UTF-8'?>
<links xmlns="http://www.intertrust.ru/schema/palette/links">
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="EDM-Docs"/>
      <module ident="InputDocs"/>
      <module ident="Tasks"/>
    </source>
    <target doc-type="">
      <module ident="ContractsLite"/>
      <module ident="InputDocs"/>
      <module ident="Tasks"/>
    </target>
    <link-types>
      <link-type-ref ref="IN_ADDITION" direction="from" select="true"/>
      <link-type-ref ref="SEE_ALSO" direction="without" back-ref="SEE_ALSO" select="true" default="true" link-on="registration"/>
      <link-type-ref ref="LINK_WITH" direction="without" back-ref="LINK_WITH" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;var Form = ctx.get('form');Form = Form.size() > 0 ? Form.get(0) : '';var secStamp = ctx.get('security_stamp_name');if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {ctx.setResult('Имеется гриф ограничения доступа');} else  if ("Dog".equals(Form) || "Finance".equals(Form)) {    result = ctx.get('DocSubject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("AddAgr".equals(Form)) {    result = ctx.get('SubjectA');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("DocDogovor".equals(Form)) {    result = ctx.get('Displayheader');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else {    result = ctx.get('Subject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);}]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="InputDocsPrev"/>
    </source>
    <target doc-type="">
      <module ident="MissionsPrev"/>
    </target>
    <link-types>
      <link-type-ref ref="FROM" direction="from" back-ref="AT" link-on="now"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[@Unsupported]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <meta>
      <documentation>Тип "Исполнение" является системным.</documentation>
    </meta>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="Requests"/>
      <module ident="RequestsPrev"/>
    </source>
    <target doc-type="">
      <module ident="InputDocsPrev"/>
      <module ident="InputDocs"/>
    </target>
    <link-types>
      <link-type-ref ref="EXECUTED" direction="to" back-ref="EXECUTE" link-on="registration"/>
      <link-type-ref ref="FROM" direction="from" back-ref="AT" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link for-general-document="true">
    <meta>
      <documentation>Тип "В ответ на" является системным.</documentation>
    </meta>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="OutputDocs"/>
      <module ident="OutputDocsPrev"/>
    </source>
    <target doc-type="">
      <module ident="InputDocsPrev"/>
      <module ident="InputDocs"/>
    </target>
    <link-types>
      <link-type-ref ref="FROM" direction="from" back-ref="AT" select="true" default="true" link-on="registration"/>
      <link-type-ref ref="AT" direction="to" back-ref="FROM" select="true" link-on="registration"/>
      <link-type-ref ref="EXECUTE" direction="from" back-ref="EXECUTED" select="true" link-on="registration"/>
      <link-type-ref ref="EXECUTED" direction="to" back-ref="EXECUTE" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="Tasks"/>
    </source>
    <target doc-type="">
      <module ident="Tasks"/>
    </target>
    <link-types>
      <link-type-ref ref="EXECUTE" direction="from" back-ref="EXECUTED" select="true" link-on="registration"/>
      <link-type-ref ref="ADD" direction="from" back-ref="ADDED" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="Dog">
      <module ident="ContractsLite"/>
    </source>
    <target doc-type="">
      <module ident="Tasks"/>
    </target>
    <link-types>
      <link-type-ref ref="EXECUTED" direction="to" back-ref="EXECUTE" select="true" link-on="registration"/>
      <link-type-ref ref="ADDED" direction="to" back-ref="ADD" select="true" link-on="registration"/>
      <link-type-ref ref="SEE_ALSO" direction="without" back-ref="SEE_ALSO" select="true" link-on="now"/>
      <link-type-ref ref="LINK_WITH" direction="without" back-ref="LINK_WITH" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA['Заявка №' + ctx.get('id_spo_og_request') + ' от ' + ctx.get('proposal_date');]]></calc-doc-info>
    <source doc-type="">
      <module ident="RequestsPrev"/>
      <module ident="Requests"/>
    </source>
    <target doc-type="">
      <module ident="OgProposal"/>
    </target>
    <link-types>
      <link-type-ref ref="BASED_ON2" direction="to" back-ref="CREATED2" link-on="now"/>
    </link-types>
    <get-doc way="byDocID"/>
  </link>
  <link for-general-document="true">
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="Tasks"/>
    </source>
    <target doc-type="">
      <module ident="OutputDocs"/>
      <module ident="InputDocs"/>
      <module ident="ContractsLite"/>
      <module ident="Requests"/>
      <module ident="OutputDocsPrev"/>
      <module ident="InputDocsPrev"/>
      <module ident="RequestsPrev"/>
    </target>
    <link-types>
      <link-type-ref ref="EXECUTE" direction="from" back-ref="EXECUTED" select="true" link-on="registration"/>
      <link-type-ref ref="ADD" direction="from" back-ref="ADDED" select="true" link-on="registration"/>
      <link-type-ref ref="LINK_WITH" direction="without" back-ref="LINK_WITH" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[var docInfo;var eventDate=ctx.get('EventDate');var Form=ctx.get('Form');Form=Form.size()>0?Form.get(0):'';if("point".equals(Form)){docInfo=''}else{docInfo='Заседание от '+(eventDate.size()>0?eventDate.get(0):'')}var result=docInfo;ctx.setResult(result);]]></calc-doc-info>
    <source doc-type="">
      <module ident="Missions"/>
    </source>
    <target doc-type="point">
      <module ident="Meetings"/>
    </target>
    <link-types>
      <link-type-ref ref="LINK_WITH" direction="without" back-ref="LINK_WITH" link-on="registration"/>
      <link-type-ref ref="AT" direction="to" back-ref="FROM" link-on="registration"/>
      <link-type-ref ref="FROM" direction="from" back-ref="AT" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var subject;var meetingType=ctx.get('Type');var Form=ctx.get('Form');Form=Form.size()>0?Form.get(0):'';if("point".equals(Form)){subject=ctx.get('pointText');subject=subject.size()>0?subject.get(0):''}else{subject=meetingType.size()>0?meetingType.get(0):'Заседание'}var result=subject;ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link for-general-document="true">
    <meta>
      <documentation>Тип "Исполнение" является системным&#xd;
Тип "Ответ" является системным.</documentation>
    </meta>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="InternalDocsPrev"/>
      <module ident="InternalDocs"/>
    </source>
    <target doc-type="">
      <module ident="InputDocsPrev"/>
      <module ident="InputDocs"/>
    </target>
    <link-types>
      <link-type-ref ref="FROM" direction="from" back-ref="AT" select="true" link-on="registration"/>
      <link-type-ref ref="EXECUTE" direction="from" back-ref="EXECUTED" select="true" link-on="registration"/>
      <link-type-ref ref="EXECUTED" direction="to" back-ref="EXECUTE" link-on="registration"/>
      <link-type-ref ref="AT" direction="to" back-ref="FROM" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="AddAgr">
      <module ident="ContractsLite"/>
    </source>
    <target doc-type="">
      <module ident="Tasks"/>
    </target>
    <link-types>
      <link-type-ref ref="EXECUTE" direction="from" back-ref="EXECUTED" select="true" link-on="now"/>
      <link-type-ref ref="ADD" direction="from" back-ref="ADDED" select="true" link-on="now"/>
      <link-type-ref ref="SEE_ALSO" direction="without" back-ref="SEE_ALSO" select="true" link-on="now"/>
      <link-type-ref ref="LINK_WITH" direction="without" back-ref="LINK_WITH" select="true" link-on="now"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="DocDogovor">
      <module ident="ContractsLite"/>
    </source>
    <target doc-type="">
      <module ident="Tasks"/>
    </target>
    <link-types>
      <link-type-ref ref="EXECUTE" direction="from" back-ref="EXECUTED" select="true" link-on="now"/>
      <link-type-ref ref="ADD" direction="from" back-ref="ADDED" select="true" link-on="now"/>
      <link-type-ref ref="SEE_ALSO" direction="without" back-ref="SEE_ALSO" select="true" link-on="now"/>
      <link-type-ref ref="LINK_WITH" direction="without" back-ref="LINK_WITH" select="true" link-on="now"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="InputDocsPrev"/>
      <module ident="InputDocs"/>
    </source>
    <target doc-type="">
      <module ident="InternalDocsPrev"/>
      <module ident="InternalDocs"/>
    </target>
    <link-types>
      <link-type-ref ref="AT" direction="to" back-ref="FROM" link-on="registration"/>
      <link-type-ref ref="EXECUTED" direction="to" back-ref="EXECUTE" select="true" link-on="registration"/>
      <link-type-ref ref="EXECUTE" direction="from" back-ref="EXECUTED" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[var docInfo;var eventDate=ctx.get('EventDate');var Form=ctx.get('Form');Form=Form.size()>0?Form.get(0):'';if("point".equals(Form)){docInfo=''}else{docInfo='Заседание от '+(eventDate.size()>0?eventDate.get(0):'')}var result=docInfo;ctx.setResult(result);]]></calc-doc-info>
    <source doc-type="">
      <module ident="Missions"/>
    </source>
    <target doc-type="point">
      <module ident="Meetings"/>
    </target>
    <link-types>
      <link-type-ref ref="EXECUTED" direction="to" back-ref="EXECUTE" link-on="now"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var subject;var meetingType=ctx.get('Type');var Form=ctx.get('Form');Form=Form.size()>0?Form.get(0):'';if("point".equals(Form)){subject=ctx.get('pointText');subject=subject.size()>0?subject.get(0):''}else{subject=meetingType.size()>0?meetingType.get(0):'Заседание'}var result=subject;ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="Finance">
      <module ident="ContractsLite"/>
    </source>
    <target doc-type="">
      <module ident="InternalDocs"/>
      <module ident="InternalDocsPrev"/>
      <module ident="OutputDocs"/>
      <module ident="InputDocs"/>
      <module ident="OutputDocsPrev"/>
      <module ident="InputDocsPrev"/>
    </target>
    <link-types>
      <link-type-ref ref="EXECUTED" direction="to" back-ref="EXECUTE" select="true" link-on="now"/>
      <link-type-ref ref="BEFORE" direction="from" back-ref="AFTER" select="true" link-on="now"/>
      <link-type-ref ref="AFTER" direction="to" back-ref="BEFORE" select="true" link-on="now"/>
      <link-type-ref ref="EXECUTE" direction="from" back-ref="EXECUTED" select="true" link-on="now"/>
      <link-type-ref ref="ADD" direction="from" back-ref="ADDED" select="true" link-on="now"/>
      <link-type-ref ref="CANCEL" direction="from" back-ref="CANCELED" select="true" link-on="now"/>
      <link-type-ref ref="PROLONG" direction="from" back-ref="PROLONGED" select="true" link-on="now"/>
      <link-type-ref ref="LINK_WITH" direction="without" back-ref="LINK_WITH" select="true" link-on="now"/>
      <link-type-ref ref="SEE_ALSO" direction="without" back-ref="SEE_ALSO" select="true" link-on="now"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <meta>
      <documentation>Тип "В исполнение" является системным.</documentation>
    </meta>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="InputDocsPrev"/>
      <module ident="InputDocs"/>
    </source>
    <target doc-type="">
      <module ident="Requests"/>
    </target>
    <link-types>
      <link-type-ref ref="EXECUTE" direction="from" back-ref="EXECUTED" link-on="registration"/>
      <link-type-ref ref="FROM" direction="from" back-ref="AT" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link for-general-document="true">
    <calc-doc-info lang="JavaScript"><![CDATA[var result;var rprist = ctx.get('rprist');var RNumber = ctx.get('RNumber');var rfin = ctx.get('rfin');var RDate = ctx.get('RDate');rprist = rprist.size() > 0 ? rprist.get(0) : '';RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';rfin = rfin.size() > 0 ? rfin.get(0) : '';RDate = RDate.size() > 0 ? RDate.get(0).toString() : '';result = rprist + RNumber + rfin + " от " + RDate;ctx.setResult(result);]]></calc-doc-info>
    <source doc-type="">
      <module ident="Requests"/>
    </source>
    <target doc-type="">
      <module ident="OutputDocs"/>
    </target>
    <link-types>
      <link-type-ref ref="SLATTERTO" direction="to" back-ref="SLATTERFROM" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link for-general-document="true">
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="OutputDocs"/>
      <module ident="OutputDocsPrev"/>
    </source>
    <target doc-type="">
      <module ident="OutputDocs"/>
      <module ident="OutputDocsPrev"/>
    </target>
    <link-types>
      <link-type-ref ref="AFTER" direction="to" back-ref="BEFORE" select="true" link-on="registration"/>
      <link-type-ref ref="BEFORE" direction="from" back-ref="AFTER" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="AdvInput"/>
    </source>
    <target doc-type="">
      <module ident="DocProjects"/>
      <module ident="InputDocs"/>
    </target>
    <link-types>
      <link-type-ref ref="ADVINPUT" direction="from" select="true"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="Missions"/>
    </source>
    <target doc-type="">
      <module ident="InputDocs"/>
      <module ident="Tasks"/>
    </target>
    <link-types>
      <link-type-ref ref="ADD" direction="from" back-ref="ADDED" select="true" default="true" link-on="registration"/>
      <link-type-ref ref="ADDED" direction="to" back-ref="ADD" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;var Form = ctx.get('form');Form = Form.size() > 0 ? Form.get(0) : '';var secStamp = ctx.get('security_stamp_name');if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {ctx.setResult('Имеется гриф ограничения доступа');} else  if ("Dog".equals(Form) || "Finance".equals(Form)) {    result = ctx.get('DocSubject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("AddAgr".equals(Form)) {    result = ctx.get('SubjectA');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("DocDogovor".equals(Form)) {    result = ctx.get('Displayheader');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("resolution".equals(Form)) {    result = ctx.get('resolution');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else {    result = ctx.get('Subject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);}]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link for-general-document="true">
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="InternalDocs"/>
      <module ident="OutputDocsPrev"/>
      <module ident="InternalDocsPrev"/>
      <module ident="InputDocsPrev"/>
      <module ident="OutputDocs"/>
      <module ident="InputDocs"/>
    </source>
    <target doc-type="">
      <module ident="ContractsLite"/>
    </target>
    <link-types>
      <link-type-ref ref="LINK_WITH" direction="to" back-ref="LINK_WITH_2" link-on="now"/>
      <link-type-ref ref="BEFORE" direction="from" back-ref="AFTER" select="true" link-on="now"/>
      <link-type-ref ref="AFTER" direction="to" back-ref="BEFORE" select="true" link-on="now"/>
      <link-type-ref ref="EXECUTED" direction="to" back-ref="EXECUTE" select="true" link-on="now"/>
      <link-type-ref ref="EXECUTE" direction="from" back-ref="EXECUTED" select="true" link-on="now"/>
      <link-type-ref ref="ADDED" direction="to" back-ref="ADD" select="true" link-on="now"/>
      <link-type-ref ref="CANCELED" direction="to" back-ref="CANCEL" link-on="now"/>
      <link-type-ref ref="PROLONGED" direction="to"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;
var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
	ctx.setResult('Имеется гриф ограничения доступа');
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = ctx.get('DocSubject');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else if ("AddAgr".equals(Form)) {
    result = ctx.get('SubjectA');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else if ("DocDogovor".equals(Form)) {
    result = ctx.get('Displayheader');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else {
    result = ctx.get('Subject');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
}]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <meta>
      <documentation>Тип "В исполнение" является системными.</documentation>
    </meta>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="InputDocsPrev"/>
      <module ident="InputDocs"/>
    </source>
    <target doc-type="">
      <module ident="Missions"/>
      <module ident="MissionsPrev"/>
    </target>
    <link-types>
      <link-type-ref ref="AFTER" direction="to" back-ref="BECAUSE" select="true" link-on="registration"/>
      <link-type-ref ref="EXECUTE" direction="from" back-ref="EXECUTED" select="true" link-on="registration"/>
      <link-type-ref ref="BASE_FOR" direction="to" back-ref="BASED_ON" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="EDM-Docs"/>
    </source>
    <target doc-type="">
      <module ident="ContractsLite"/>
    </target>
    <link-types>
      <link-type-ref ref="IN_ADDITION" direction="from" select="true"/>
      <link-type-ref ref="SEE_ALSO" direction="without" back-ref="SEE_ALSO" select="true" link-on="now"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;
var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
	ctx.setResult('Имеется гриф ограничения доступа');
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = ctx.get('DocSubject');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else if ("AddAgr".equals(Form)) {
    result = ctx.get('SubjectA');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else if ("DocDogovor".equals(Form)) {
    result = ctx.get('Displayheader');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else {
    result = ctx.get('Subject');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
}]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[ctx.get('publish_date')]]></calc-doc-info>
    <source doc-type="">
      <module ident="MissionsPrev"/>
      <module ident="Missions"/>
    </source>
    <target doc-type="">
      <module ident="Publications"/>
    </target>
    <link-types>
      <link-type-ref ref="PUBLISHED2" direction="from" back-ref="FORPUBLISH2" link-on="now"/>
      <link-type-ref ref="UNPUBLISHED2" direction="from" back-ref="FORUNPUBLISH2" link-on="now"/>
    </link-types>
    <get-doc way="byDocID"/>
  </link>
  <link for-general-document="true">
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="Requests"/>
    </source>
    <target doc-type="">
      <module ident="OutputDocsPrev"/>
      <module ident="OutputDocs"/>
      <module ident="InternalDocs"/>
      <module ident="InternalDocsPrev"/>
    </target>
    <link-types>
      <link-type-ref ref="AT" direction="to" back-ref="FROM" select="true" default="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="Dog">
      <module ident="ContractsLite"/>
    </source>
    <target doc-type="">
      <module ident="ContractsLite"/>
    </target>
    <link-types>
      <link-type-ref ref="BEFORE" direction="from" back-ref="AFTER" link-on="now"/>
      <link-type-ref ref="AFTER" direction="to" back-ref="BEFORE" link-on="now"/>
      <link-type-ref ref="ADDED" direction="to" back-ref="ADD" link-on="now"/>
      <link-type-ref ref="CANCELED" direction="to" back-ref="CANCEL" link-on="now"/>
      <link-type-ref ref="LINK_WITH" direction="without" back-ref="LINK_WITH" select="true" link-on="now"/>
      <link-type-ref ref="PROLONGED" direction="to" back-ref="PROLONG" link-on="now"/>
      <link-type-ref ref="SEE_ALSO" direction="without" back-ref="SEE_ALSO" select="true" link-on="now"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;
var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
	ctx.setResult('Имеется гриф ограничения доступа');
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = ctx.get('DocSubject');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else if ("AddAgr".equals(Form)) {
    result = ctx.get('SubjectA');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else if ("DocDogovor".equals(Form)) {
    result = ctx.get('Displayheader');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else {
    result = ctx.get('Subject');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
}]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="OgProposal"/>
    </source>
    <target doc-type="">
      <module ident="RequestsPrev"/>
      <module ident="Requests"/>
    </target>
    <link-types>
      <link-type-ref ref="CREATED2" direction="from" back-ref="BASED_ON2" link-on="now"/>
    </link-types>
    <get-doc way="byDocID"/>
  </link>
  <link for-general-document="true">
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="Missions"/>
      <module ident="MissionsPrev"/>
    </source>
    <target doc-type="">
      <module ident="InternalDocsPrev"/>
      <module ident="InternalDocs"/>
      <module ident="InputDocsPrev"/>
      <module ident="InputDocs"/>
    </target>
    <link-types>
      <link-type-ref ref="EXECUTED" direction="to" back-ref="EXECUTE" select="true" link-on="registration"/>
      <link-type-ref ref="BASED_ON" direction="from" back-ref="BASE_FOR" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[
var result;

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);		
	}
}

var vers = context.get('Cm6$Subject');
vers = vers.size() > 0 ? vers.get(0) : '';
if (vers != '') {
    var subj = context.get('title');
    subj = subj.size() > 0 ? subj.get(0) : '';
    result = subj;
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}
ctx.setResult(result);
    ]]>
    </calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="InternalDocs"/>
      <module ident="InternalDocsPrev"/>
    </source>
    <target doc-type="">
      <module ident="Requests"/>
      <module ident="RequestsPrev"/>
    </target>
    <link-types>
      <link-type-ref ref="FROM" direction="from" back-ref="AT" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="Finance">
      <module ident="ContractsLite"/>
    </source>
    <target doc-type="">
      <module ident="ContractsLite"/>
    </target>
    <link-types>
      <link-type-ref ref="ADD" direction="from" back-ref="ADDED" select="true" link-on="now"/>
      <link-type-ref ref="CANCEL" direction="from" back-ref="CANCELED" select="true" link-on="now"/>
      <link-type-ref ref="PROLONG" direction="from" back-ref="PROLONGED" select="true" link-on="now"/>
      <link-type-ref ref="LINK_WITH" direction="without" back-ref="LINK_WITH" select="true" link-on="now"/>
      <link-type-ref ref="BEFORE" direction="from" back-ref="AFTER" select="true" link-on="now"/>
      <link-type-ref ref="AFTER" direction="to" back-ref="BEFORE" select="true" link-on="now"/>
      <link-type-ref ref="SEE_ALSO" direction="without" back-ref="SEE_ALSO" select="true" link-on="now"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;
var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
	ctx.setResult('Имеется гриф ограничения доступа');
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = ctx.get('DocSubject');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else if ("AddAgr".equals(Form)) {
    result = ctx.get('SubjectA');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else if ("DocDogovor".equals(Form)) {
    result = ctx.get('Displayheader');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else {
    result = ctx.get('Subject');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
}]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="Dog">
      <module ident="ContractsLite"/>
    </source>
    <target doc-type="">
      <module ident="InputDocs"/>
      <module ident="InternalDocs"/>
      <module ident="InternalDocsPrev"/>
      <module ident="InputDocsPrev"/>
      <module ident="OutputDocs"/>
      <module ident="OutputDocsPrev"/>
    </target>
    <link-types>
      <link-type-ref ref="EXECUTE" direction="from" back-ref="EXECUTED" select="true" link-on="registration"/>
      <link-type-ref ref="BEFORE" direction="from" back-ref="AFTER" select="true" link-on="registration"/>
      <link-type-ref ref="AFTER" direction="to" back-ref="BEFORE" select="true" link-on="registration"/>
      <link-type-ref ref="EXECUTED" direction="to" back-ref="EXECUTE" select="true" link-on="registration"/>
      <link-type-ref ref="ADD" direction="from" back-ref="ADDED" select="true" link-on="registration"/>
      <link-type-ref ref="CANCEL" direction="from" back-ref="CANCELED" select="true" link-on="registration"/>
      <link-type-ref ref="PROLONG" direction="from" back-ref="PROLONGED" select="true" link-on="registration"/>
      <link-type-ref ref="LINK_WITH" direction="without" back-ref="LINK_WITH" select="true" link-on="registration"/>
      <link-type-ref ref="SEE_ALSO" direction="without" back-ref="SEE_ALSO" select="true" link-on="now"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="DocDogovor">
      <module ident="ContractsLite"/>
    </source>
    <target doc-type="">
      <module ident="ContractsLite"/>
    </target>
    <link-types>
      <link-type-ref ref="BEFORE" direction="from" back-ref="AFTER" select="true" link-on="now"/>
      <link-type-ref ref="AFTER" direction="to" back-ref="BEFORE" select="true" link-on="now"/>
      <link-type-ref ref="ADD" direction="from" back-ref="ADDED" select="true" link-on="now"/>
      <link-type-ref ref="CANCEL" direction="from" back-ref="CANCELED" select="true" link-on="now"/>
      <link-type-ref ref="PROLONG" direction="from" back-ref="PROLONGED" select="true" link-on="now"/>
      <link-type-ref ref="LINK_WITH" direction="without" back-ref="LINK_WITH" select="true" link-on="now"/>
      <link-type-ref ref="CANCELED" direction="to" back-ref="CANCEL" select="true" link-on="now"/>
      <link-type-ref ref="ADDED" direction="to" back-ref="ADD" select="true" link-on="now"/>
      <link-type-ref ref="SEE_ALSO" direction="without" back-ref="SEE_ALSO" select="true" link-on="now"/>
      <link-type-ref ref="LINK" direction="from" select="true"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;
var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
	ctx.setResult('Имеется гриф ограничения доступа');
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = ctx.get('DocSubject');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else if ("AddAgr".equals(Form)) {
    result = ctx.get('SubjectA');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else if ("DocDogovor".equals(Form)) {
    result = ctx.get('Displayheader');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else {
    result = ctx.get('Subject');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
}]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[var result;var typeName;var vers=ctx.get('Cm6$Subject');vers = vers.size() > 0 ? vers.get(0) : '';if (vers != '') {typeName = ctx.get('type_document');var subj = ctx.get('title');subj = subj.size() > 0 ? subj.get(0) : '';typeName = typeName.size() > 0 ? typeName.get(0) : '';result = typeName + " " + subj;ctx.setResult(result);}else{ Type_Name = ctx.get('Type_Name');var Subject = ctx.get('Subject');Type_Name = Type_Name.size() > 0 ? Type_Name.get(0) : '';Subject = Subject.size() > 0 ? Subject.get(0) : ''; result = Type_Name + " " + Subject;ctx.setResult(result);}]]></calc-doc-info>
    <source doc-type="">
      <module ident="OutputDocs"/>
      <module ident="ContractsLite"/>
      <module ident="OutputDocsPrev"/>
      <module ident="InternalDocsPrev"/>
      <module ident="InputDocsPrev"/>
      <module ident="InternalDocs"/>
      <module ident="InputDocs"/>
      <module ident="Missions"/>
      <module ident="MissionsPrev"/>
    </source>
    <target doc-type="">
      <module ident="EDM-Docs"/>
      <module ident="OutputDocs"/>
    </target>
    <link-types>
      <link-type-ref ref="SEE_ALSO" direction="without" back-ref="SEE_ALSO" select="true" default="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;var vers=ctx.get('Cm6$Subject');vers = vers.size() > 0 ? vers.get(0) : '';if (vers != '') {var subj = ctx.get('title');subj = subj.size() > 0 ? subj.get(0) : '';result = subj;}else{ result = ctx.get('Subject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);}ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[var result;var rprist = ctx.get('rprist');var RNumber = ctx.get('RNumber');var rfin = ctx.get('rfin');rprist = rprist.size() > 0 ? rprist.get(0) : '';RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';rfin = rfin.size() > 0 ? rfin.get(0) : '';result = rprist + RNumber + rfin;ctx.setResult(result);]]></calc-doc-info>
    <source doc-type="">
      <module ident="*"/>
    </source>
    <target doc-type="">
      <module ident="*"/>
    </target>
    <link-types>
      <link-type-ref ref="SEE_ALSO" direction="without" back-ref="SEE_ALSO" select="true" default="true" link-on="now"/>
      <link-type-ref ref="LINK_WITH" direction="without" back-ref="LINK_WITH" select="true" link-on="registration"/>
    </link-types>
      <calc-name lang="JavaScript"><![CDATA[var result;var vers=ctx.get('Cm6$Subject');vers = vers.size() > 0 ? vers.get(0) : '';if (vers != '') {var subj = ctx.get('title');subj = subj.size() > 0 ? subj.get(0) : '';result = subj;}else{ result = ctx.get('Subject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);}ctx.setResult(result);]]></calc-name>
      <get-doc way="byDocID"/>
  </link>
  <link>
    <meta>
      <documentation>rrr 000</documentation>
    </meta>
    <calc-doc-info lang="JavaScript"><![CDATA[var result;
var typeName;
var vers=ctx.get('Cm6$Subject');
vers = vers.size() > 0 ? vers.get(0) : '';
if (vers != '') {
typeName = ctx.get('type_document');
var subj = ctx.get('title');
subj = subj.size() > 0 ? subj.get(0) : '';
typeName = typeName.size() > 0 ? typeName.get(0) : '';
result = typeName + " " + subj;

ctx.setResult(result);
}else{
 Type_Name = ctx.get('Type_Name');var Subject = ctx.get('Subject');Type_Name = Type_Name.size() > 0 ? Type_Name.get(0) : '';Subject = Subject.size() > 0 ? Subject.get(0) : ''; result = Type_Name + " " + Subject;ctx.setResult(result);

}]]></calc-doc-info>
    <source doc-type="">
      <module ident="EDM-Catalog"/>
      <module ident="EDM-Docs"/>
    </source>
    <target doc-type="">
      <module ident="EDM-Docs"/>
    </target>
    <link-types>
      <link-type-ref ref="SHORTCUT" direction="from" select="true" default="true"/>
      <link-type-ref ref="SEE_ALSO" direction="without" back-ref="SEE_ALSO" select="true" link-on="now"/>
      <link-type-ref ref="LINK_WITH" direction="without" back-ref="LINK_WITH" select="true" link-on="now"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link for-general-document="true">
    <meta>
      <documentation>Тип "Исполнение" является системным.</documentation>
    </meta>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="Missions"/>
      <module ident="MissionsPrev"/>
    </source>
    <target doc-type="">
      <module ident="InputDocsPrev"/>
      <module ident="InputDocs"/>
    </target>
    <link-types>
      <link-type-ref ref="BECAUSE" direction="from" back-ref="AFTER" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;var Form = ctx.get('form');Form = Form.size() > 0 ? Form.get(0) : '';var secStamp = ctx.get('security_stamp_name');if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {ctx.setResult('Имеется гриф ограничения доступа');} else  if ("Dog".equals(Form) || "Finance".equals(Form)) {    result = ctx.get('DocSubject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("AddAgr".equals(Form)) {    result = ctx.get('SubjectA');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("DocDogovor".equals(Form)) {    result = ctx.get('Displayheader');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("resolution".equals(Form)) {    result = ctx.get('resolution');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else {    result = ctx.get('Subject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);}]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="point">
      <module ident="Meetings"/>
    </source>
    <target doc-type="">
      <module ident="MissionsPrev"/>
      <module ident="Missions"/>
    </target>
    <link-types>
      <link-type-ref ref="EXECUTE" direction="from" back-ref="EXECUTED" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[
var result;

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);		
	}
}

var vers = context.get('Cm6$Subject');
vers = vers.size() > 0 ? vers.get(0) : '';
if (vers != '') {
    var subj = context.get('title');
    subj = subj.size() > 0 ? subj.get(0) : '';
    result = subj;
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}
ctx.setResult(result);
    ]]>
    </calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link for-general-document="true">
    <calc-doc-info lang="JavaScript"><![CDATA[var docInfo;var eventDate=ctx.get('EventDate');var Form=ctx.get('Form');Form=Form.size()>0?Form.get(0):'';if("point".equals(Form)){docInfo=''}else{docInfo='Заседание от '+(eventDate.size()>0?eventDate.get(0):'')}var result=docInfo;ctx.setResult(result);]]></calc-doc-info>
    <source doc-type="">
      <module ident="InternalDocs"/>
      <module ident="OutputDocs"/>
      <module ident="Missions"/>
      <module ident="InputDocs"/>
      <module ident="InternalDocsPrev"/>
      <module ident="OutputDocsPrev"/>
      <module ident="InputDocsPrev"/>
      <module ident="MissionsPrev"/>
    </source>
    <target doc-type="">
      <module ident="Meetings"/>
    </target>
    <link-types>
      <link-type-ref ref="LINK_WITH" direction="without" back-ref="LINK_WITH" select="true" link-on="now"/>
      <link-type-ref ref="FROM" direction="from" back-ref="AT" select="true" link-on="now"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var subject;var meetingType=ctx.get('Type');var Form=ctx.get('Form');Form=Form.size()>0?Form.get(0):'';if("point".equals(Form)){subject=ctx.get('pointText');subject=subject.size()>0?subject.get(0):''}else{subject=meetingType.size()>0?meetingType.get(0):'Заседание'}var result=subject;ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link for-general-document="true">
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="OutputDocsPrev"/>
      <module ident="OutputDocs"/>
    </source>
    <target doc-type="">
      <module ident="Requests"/>
      <module ident="InternalDocsPrev"/>
      <module ident="InternalDocs"/>
    </target>
    <link-types>
      <link-type-ref ref="FROM" direction="from" back-ref="AT" select="true" default="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="Publications"/>
    </source>
    <target doc-type="">
      <module ident="MissionsPrev"/>
      <module ident="Missions"/>
    </target>
    <link-types>
      <link-type-ref ref="FORPUBLISH2" direction="to" back-ref="PUBLISHED2" link-on="now"/>
      <link-type-ref ref="FORUNPUBLISH2" direction="to" back-ref="UNPUBLISHED2" link-on="now"/>
    </link-types>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="InputDocs"/>
      <module ident="InputDocsPrev"/>
    </source>
    <target doc-type="">
      <module ident="InputDocs"/>
      <module ident="InputDocsPrev"/>
    </target>
    <link-types>
      <link-type-ref ref="SEE_ALSO" direction="without" back-ref="SEE_ALSO" select="true" default="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;var Form = ctx.get('form');Form = Form.size() > 0 ? Form.get(0) : '';var secStamp = ctx.get('security_stamp_name');if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {ctx.setResult('Имеется гриф ограничения доступа');} else  if ("Dog".equals(Form) || "Finance".equals(Form)) {    result = ctx.get('DocSubject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("AddAgr".equals(Form)) {    result = ctx.get('SubjectA');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("DocDogovor".equals(Form)) {    result = ctx.get('Displayheader');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("resolution".equals(Form)) {    result = ctx.get('resolution');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else {    result = ctx.get('Subject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);}]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="EDM-Catalog"/>
      <module ident="EDM-Docs"/>
    </source>
    <target doc-type="">
      <module ident="OutputDocsPrev"/>
      <module ident="InternalDocsPrev"/>
      <module ident="InputDocsPrev"/>
      <module ident="Requests"/>
      <module ident="InternalDocs"/>
      <module ident="RequestsPrev"/>
      <module ident="InputDocs"/>
      <module ident="Missions"/>
      <module ident="MissionsPrev"/>
      <module ident="OutputDocs"/>
    </target>
    <link-types>
      <link-type-ref ref="SEE_ALSO" direction="from" select="true" default="true"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var form = ctx.get('form');
form = form.size() > 0 ? form.get(0) : '';var subject = ctx.get('Subject');
subject = subject.size() > 0 ? subject.get(0) : '';var result;
var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
	ctx.setResult('Имеется гриф ограничения доступа');
} else if ("Dog".equals(form) || "Finance".equals(Form)) {
    result = ctx.get('DocSubject');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else if ("AddAgr".equals(form)) {
    result = ctx.get('SubjectA');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else if ("DocDogovor".equals(form)) {
    result = ctx.get('Displayheader');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else if ("resolution".equals(form)) {
    result = ctx.get('resolution');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else if (!"".equals(subject)) {
    result = subject;
ctx.setResult(result);
} else {
    result = ctx.get('ProjectName');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
}]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="DocDogovor">
      <module ident="ContractsLite"/>
    </source>
    <target doc-type="">
      <module ident="ContractsLite"/>
    </target>
    <link-types>
      <link-type-ref ref="BEFORE" direction="from" back-ref="AFTER" select="true" link-on="now"/>
      <link-type-ref ref="AFTER" direction="to" back-ref="BEFORE" select="true" link-on="now"/>
      <link-type-ref ref="ADD" direction="from" back-ref="ADDED" select="true" link-on="now"/>
      <link-type-ref ref="CANCEL" direction="from" back-ref="CANCELED" select="true" link-on="now"/>
      <link-type-ref ref="PROLONG" direction="from" back-ref="PROLONGED" select="true" link-on="now"/>
      <link-type-ref ref="LINK_WITH" direction="without" back-ref="LINK_WITH" select="true" link-on="now"/>
      <link-type-ref ref="SEE_ALSO" direction="without" back-ref="SEE_ALSO" select="true" link-on="now"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;
var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
	ctx.setResult('Имеется гриф ограничения доступа');
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = ctx.get('DocSubject');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else if ("AddAgr".equals(Form)) {
    result = ctx.get('SubjectA');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else if ("DocDogovor".equals(Form)) {
    result = ctx.get('Displayheader');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else {
    result = ctx.get('Subject');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
}]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link for-general-document="true">
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="InternalDocsPrev"/>
      <module ident="InternalDocs"/>
    </source>
    <target doc-type="">
      <module ident="OutputDocsPrev"/>
      <module ident="OutputDocs"/>
    </target>
    <link-types>
      <link-type-ref ref="AT" direction="to" back-ref="FROM" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="AddAgr">
      <module ident="ContractsLite"/>
    </source>
    <target doc-type="">
      <module ident="InternalDocs"/>
      <module ident="InternalDocsPrev"/>
      <module ident="OutputDocs"/>
      <module ident="InputDocs"/>
      <module ident="OutputDocsPrev"/>
      <module ident="InputDocsPrev"/>
    </target>
    <link-types>
      <link-type-ref ref="EXECUTED" direction="to" back-ref="EXECUTE" select="true" link-on="now"/>
      <link-type-ref ref="BEFORE" direction="from" back-ref="AFTER" select="true" link-on="now"/>
      <link-type-ref ref="AFTER" direction="to" back-ref="BEFORE" select="true" link-on="now"/>
      <link-type-ref ref="EXECUTE" direction="from" back-ref="EXECUTED" select="true" link-on="now"/>
      <link-type-ref ref="ADD" direction="from" back-ref="ADDED" select="true" link-on="now"/>
      <link-type-ref ref="CANCEL" direction="from" back-ref="CANCELED" select="true" link-on="now"/>
      <link-type-ref ref="PROLONG" direction="from" back-ref="PROLONGED" select="true" link-on="now"/>
      <link-type-ref ref="LINK_WITH" direction="without" back-ref="LINK_WITH" select="true" link-on="now"/>
      <link-type-ref ref="SEE_ALSO" direction="without" back-ref="SEE_ALSO" select="true" link-on="now"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="RequestsPrev"/>
    </source>
    <target doc-type="">
      <module ident="*"/>
    </target>
    <link-types>
      <link-type-ref ref=""/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link for-general-document="true">
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="InternalDocs"/>
      <module ident="InternalDocsPrev"/>
    </source>
    <target doc-type="">
      <module ident="Missions"/>
      <module ident="MissionsPrev"/>
    </target>
    <link-types>
      <link-type-ref ref="EXECUTE" direction="from" back-ref="EXECUTED" select="true" link-on="registration"/>
      <link-type-ref ref="BASE_FOR" direction="to" back-ref="BASED_ON" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="Missions"/>
      <module ident="MissionsPrev"/>
    </source>
    <target doc-type="">
      <module ident="InputDocs"/>
    </target>
    <link-types>
      <link-type-ref ref="AFTER" direction="to" back-ref="BECAUSE" select="true" link-on="registration"/>
      <link-type-ref ref="CHANGE" direction="from" back-ref="CHANGED" select="true" link-on="registration"/>
      <link-type-ref ref="ADD" direction="from" back-ref="ADDED" select="true" default="true" link-on="registration"/>
      <link-type-ref ref="ADDED" direction="to" back-ref="ADD" select="true" link-on="registration"/>
      <link-type-ref ref="CANCEL" direction="from" back-ref="CANCELED" select="true" link-on="registration"/>
      <link-type-ref ref="CANCELED" direction="to" back-ref="CANCEL" select="true" link-on="registration"/>
      <link-type-ref ref="BECAUSE" direction="from" back-ref="AFTER" select="true" link-on="registration"/>
      <link-type-ref ref="CHANGED" direction="to" back-ref="CHANGE" select="true" link-on="registration"/>
      <link-type-ref ref="EXECUTE" direction="from" back-ref="EXECUTED" select="true" link-on="registration"/>
      <link-type-ref ref="EXECUTED" direction="to" back-ref="EXECUTE" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;var Form = ctx.get('form');Form = Form.size() > 0 ? Form.get(0) : '';var secStamp = ctx.get('security_stamp_name');if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {ctx.setResult('Имеется гриф ограничения доступа');} else  if ("Dog".equals(Form) || "Finance".equals(Form)) {    result = ctx.get('DocSubject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("AddAgr".equals(Form)) {    result = ctx.get('SubjectA');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("DocDogovor".equals(Form)) {    result = ctx.get('Displayheader');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("resolution".equals(Form)) {    result = ctx.get('resolution');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else {    result = ctx.get('Subject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);}]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="spismo">
      <module ident="InputDocsPrev"/>
      <module ident="InputDocs"/>
    </source>
    <target doc-type="">
      <module ident="OutputDocsPrev"/>
      <module ident="OutputDocs"/>
    </target>
    <link-types>
      <link-type-ref ref="AT" direction="to" back-ref="FROM" link-on="now"/>
      <link-type-ref ref="EXECUTED" direction="to" back-ref="EXECUTE" link-on="now"/>
      <link-type-ref ref="FROM" direction="from" back-ref="AT" link-on="now"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link for-general-document="true">
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="OutputDocs"/>
      <module ident="InputDocs"/>
      <module ident="Missions"/>
      <module ident="InternalDocs"/>
      <module ident="Requests"/>
      <module ident="Tasks"/>
      <module ident="InternalDocsPrev"/>
      <module ident="OutputDocsPrev"/>
      <module ident="InputDocsPrev"/>
      <module ident="MissionsPrev"/>
      <module ident="RequestsPrev"/>
    </source>
    <target doc-type="">
      <module ident="Tasks"/>
    </target>
    <link-types>
      <link-type-ref ref="ADDED" direction="to" back-ref="ADD" select="true" link-on="registration"/>
      <link-type-ref ref="ADD" direction="from" back-ref="ADDED" select="true" default="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;var Form = ctx.get('form');Form = Form.size() > 0 ? Form.get(0) : '';var secStamp = ctx.get('security_stamp_name');if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {ctx.setResult('Имеется гриф ограничения доступа');} else  if ("Dog".equals(Form) || "Finance".equals(Form)) {    result = ctx.get('DocSubject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("AddAgr".equals(Form)) {    result = ctx.get('SubjectA');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("DocDogovor".equals(Form)) {    result = ctx.get('Displayheader');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("resolution".equals(Form)) {    result = ctx.get('resolution');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else {    result = ctx.get('Subject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);}]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link for-general-document="true">
    <meta>
      <documentation>Тип "В ответ на" является системным.</documentation>
    </meta>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="InputDocsPrev"/>
      <module ident="InputDocs"/>
    </source>
    <target doc-type="">
      <module ident="OutputDocsPrev"/>
      <module ident="OutputDocs"/>
    </target>
    <link-types>
      <link-type-ref ref="FROM" direction="from" back-ref="AT" select="true" default="true" link-on="registration"/>
      <link-type-ref ref="AT" direction="to" back-ref="FROM" select="true" link-on="registration"/>
      <link-type-ref ref="EXECUTED" direction="to" back-ref="EXECUTE" select="true" link-on="registration"/>
      <link-type-ref ref="EXECUTE" direction="from" back-ref="EXECUTED" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="Tasks"/>
    </source>
    <target doc-type="">
      <module ident="Missions"/>
      <module ident="InternalDocs"/>
      <module ident="InternalDocsPrev"/>
      <module ident="MissionsPrev"/>
    </target>
    <link-types>
      <link-type-ref ref="EXECUTE" direction="from" back-ref="EXECUTED" select="true" link-on="registration"/>
      <link-type-ref ref="ADD" direction="from" back-ref="ADDED" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link for-general-document="true">
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="point">
      <module ident="Meetings"/>
    </source>
    <target doc-type="">
      <module ident="MissionsPrev"/>
      <module ident="Missions"/>
    </target>
    <link-types>
      <link-type-ref ref="LINK_WITH" direction="without" back-ref="LINK_WITH" select="true" link-on="now"/>
      <link-type-ref ref="FROM" direction="from" back-ref="AT" select="true" link-on="registration"/>
      <link-type-ref ref="AT" direction="to" back-ref="FROM" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[
var result;

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);		
	}
}

var vers = context.get('Cm6$Subject');
vers = vers.size() > 0 ? vers.get(0) : '';
if (vers != '') {
    var subj = context.get('title');
    subj = subj.size() > 0 ? subj.get(0) : '';
    result = subj;
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}
ctx.setResult(result);
    ]]>
    </calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="Missions"/>
    </source>
    <target doc-type="">
      <module ident="Tasks"/>
    </target>
    <link-types>
      <link-type-ref ref="ADD" direction="from" back-ref="ADDED" select="true" default="true" link-on="registration"/>
      <link-type-ref ref="ADDED" direction="to" back-ref="ADD" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;var Form = ctx.get('form');Form = Form.size() > 0 ? Form.get(0) : '';var secStamp = ctx.get('security_stamp_name');if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {ctx.setResult('Имеется гриф ограничения доступа');} else  if ("Dog".equals(Form) || "Finance".equals(Form)) {    result = ctx.get('DocSubject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("AddAgr".equals(Form)) {    result = ctx.get('SubjectA');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("DocDogovor".equals(Form)) {    result = ctx.get('Displayheader');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("resolution".equals(Form)) {    result = ctx.get('resolution');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else {    result = ctx.get('Subject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);}]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="Requests"/>
      <module ident="RequestsPrev"/>
    </source>
    <target doc-type="">
      <module ident="Requests"/>
      <module ident="RequestsPrev"/>
    </target>
    <link-types>
      <link-type-ref ref="PRIMARY" direction="from" back-ref="REPEATED" select="true" link-on="registration"/>
      <link-type-ref ref="REPEATED" direction="to" back-ref="PRIMARY" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link for-general-document="true">
    <meta>
      <documentation>Типы "Исполнение" и "В исполнение" являются системными.</documentation>
    </meta>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="InputDocsPrev"/>
      <module ident="InputDocs"/>
    </source>
    <target doc-type="">
      <module ident="InputDocsPrev"/>
      <module ident="InputDocs"/>
    </target>
    <link-types>
      <link-type-ref ref="BEFORE" direction="from" back-ref="AFTER" select="true" link-on="registration"/>
      <link-type-ref ref="AFTER" direction="to" back-ref="BEFORE" select="true" link-on="registration"/>
      <link-type-ref ref="EXECUTE" direction="from" back-ref="EXECUTED" link-on="registration"/>
      <link-type-ref ref="EXECUTED" direction="to" back-ref="EXECUTE" link-on="registration"/>
      <link-type-ref ref="FROM" direction="from" back-ref="AT" select="true" link-on="registration"/>
      <link-type-ref ref="AT" direction="to" back-ref="FROM" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;var Form = ctx.get('form');Form = Form.size() > 0 ? Form.get(0) : '';var secStamp = ctx.get('security_stamp_name');if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {ctx.setResult('Имеется гриф ограничения доступа');} else  if ("Dog".equals(Form) || "Finance".equals(Form)) {    result = ctx.get('DocSubject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("AddAgr".equals(Form)) {    result = ctx.get('SubjectA');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("DocDogovor".equals(Form)) {    result = ctx.get('Displayheader');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("resolution".equals(Form)) {    result = ctx.get('resolution');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else {    result = ctx.get('Subject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);}]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link for-general-document="true">
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="OutputDocs"/>
      <module ident="OutputDocsPrev"/>
    </source>
    <target doc-type="">
      <module ident="Missions"/>
      <module ident="MissionsPrev"/>
    </target>
    <link-types>
      <link-type-ref ref="EXECUTE" direction="from" back-ref="EXECUTED" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link for-general-document="true">
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="Missions"/>
      <module ident="MissionsPrev"/>
    </source>
    <target doc-type="">
      <module ident="Missions"/>
      <module ident="MissionsPrev"/>
    </target>
    <link-types>
      <link-type-ref ref="AFTER" direction="to" back-ref="BECAUSE" select="true" link-on="registration"/>
      <link-type-ref ref="CHANGE" direction="from" back-ref="CHANGED" select="true" link-on="registration"/>
      <link-type-ref ref="ADD" direction="from" back-ref="ADDED" select="true" link-on="registration"/>
      <link-type-ref ref="ADDED" direction="to" back-ref="ADD" select="true" link-on="registration"/>
      <link-type-ref ref="CANCEL" direction="from" back-ref="CANCELED" select="true" link-on="registration"/>
      <link-type-ref ref="CANCELED" direction="to" back-ref="CANCEL" select="true" link-on="registration"/>
      <link-type-ref ref="BECAUSE" direction="from" back-ref="AFTER" select="true" link-on="registration"/>
      <link-type-ref ref="CHANGED" direction="to" back-ref="CHANGE" select="true" link-on="registration"/>
      <link-type-ref ref="EXECUTE" direction="from" back-ref="EXECUTED" select="true" default="true" link-on="registration"/>
      <link-type-ref ref="EXECUTED" direction="to" back-ref="EXECUTE" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;var Form = ctx.get('form');Form = Form.size() > 0 ? Form.get(0) : '';var secStamp = ctx.get('security_stamp_name');if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {ctx.setResult('Имеется гриф ограничения доступа');} else  if ("Dog".equals(Form) || "Finance".equals(Form)) {    result = ctx.get('DocSubject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("AddAgr".equals(Form)) {    result = ctx.get('SubjectA');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("DocDogovor".equals(Form)) {    result = ctx.get('Displayheader');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("resolution".equals(Form)) {    result = ctx.get('resolution');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else {    result = ctx.get('Subject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);}]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="AddAgr">
      <module ident="ContractsLite"/>
    </source>
    <target doc-type="">
      <module ident="ContractsLite"/>
    </target>
    <link-types>
      <link-type-ref ref="BEFORE" direction="from" back-ref="AFTER" select="true" link-on="now"/>
      <link-type-ref ref="AFTER" direction="to" back-ref="BEFORE" select="true" link-on="now"/>
      <link-type-ref ref="ADD" direction="from" back-ref="ADDED" select="true" link-on="now"/>
      <link-type-ref ref="PROLONG" direction="from" back-ref="PROLONGED" select="true" link-on="now"/>
      <link-type-ref ref="LINK_WITH" direction="without" back-ref="LINK_WITH" select="true" link-on="now"/>
      <link-type-ref ref="CANCEL" direction="from" back-ref="CANCELED" select="true" link-on="now"/>
      <link-type-ref ref="SEE_ALSO" direction="without" back-ref="SEE_ALSO" select="true" link-on="now"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;
var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
	ctx.setResult('Имеется гриф ограничения доступа');
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = ctx.get('DocSubject');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else if ("AddAgr".equals(Form)) {
    result = ctx.get('SubjectA');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else if ("DocDogovor".equals(Form)) {
    result = ctx.get('Displayheader');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else {
    result = ctx.get('Subject');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
}]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link for-general-document="true">
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="Missions"/>
      <module ident="MissionsPrev"/>
    </source>
    <target doc-type="">
      <module ident="OutputDocsPrev"/>
      <module ident="OutputDocs"/>
    </target>
    <link-types>
      <link-type-ref ref="EXECUTED" direction="to" back-ref="EXECUTE" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="InputDocs"/>
      <module ident="Tasks"/>
    </source>
    <target doc-type="">
      <module ident="Requests"/>
      <module ident="InternalDocs"/>
      <module ident="InputDocs"/>
      <module ident="Missions"/>
      <module ident="OutputDocs"/>
      <module ident="Tasks"/>
    </target>
    <link-types>
      <link-type-ref ref="SEE_ALSO" direction="without" back-ref="SEE_ALSO" select="true" default="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var form = ctx.get('form');form = form.size() > 0 ? form.get(0) : '';var subject = ctx.get('Subject');subject = subject.size() > 0 ? subject.get(0) : '';var result;var secStamp = ctx.get('security_stamp_name');if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {ctx.setResult('Имеется гриф ограничения доступа');} else  if ("Dog".equals(form) || "Finance".equals(Form)) {    result = ctx.get('DocSubject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("AddAgr".equals(form)) {    result = ctx.get('SubjectA');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("DocDogovor".equals(form)) {    result = ctx.get('Displayheader');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("resolution".equals(form)) {    result = ctx.get('resolution');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if (!"".equals(subject)) {    result = subject;ctx.setResult(result);} else {    result = ctx.get('ProjectName');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);}]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="Finance">
      <module ident="ContractsLite"/>
    </source>
    <target doc-type="">
      <module ident="Tasks"/>
    </target>
    <link-types>
      <link-type-ref ref="EXECUTE" direction="from" back-ref="EXECUTED" select="true" link-on="now"/>
      <link-type-ref ref="ADD" direction="from" back-ref="ADDED" select="true" link-on="now"/>
      <link-type-ref ref="SEE_ALSO" direction="without" back-ref="SEE_ALSO" select="true" link-on="now"/>
      <link-type-ref ref="LINK_WITH" direction="without" back-ref="LINK_WITH" select="true" link-on="now"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="Requests"/>
      <module ident="RequestsPrev"/>
    </source>
    <target doc-type="">
      <module ident="InternalDocs"/>
      <module ident="InternalDocsPrev"/>
    </target>
    <link-types>
      <link-type-ref ref="FROM" direction="from" back-ref="AT" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="EDM-Catalog"/>
      <module ident="EDM-Docs"/>
    </source>
    <target doc-type="">
      <module ident="OutputDocsPrev"/>
      <module ident="InternalDocsPrev"/>
      <module ident="InputDocsPrev"/>
      <module ident="Requests"/>
      <module ident="InternalDocs"/>
      <module ident="RequestsPrev"/>
      <module ident="InputDocs"/>
      <module ident="Missions"/>
      <module ident="MissionsPrev"/>
      <module ident="OutputDocs"/>
    </target>
    <link-types>
      <link-type-ref ref="SEE_ALSO" direction="from" select="true" default="true"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var form = ctx.get('form');
form = form.size() > 0 ? form.get(0) : '';var subject = ctx.get('Subject');
subject = subject.size() > 0 ? subject.get(0) : '';
var result;
var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
	ctx.setResult('Имеется гриф ограничения доступа');
} else if ("Dog".equals(form) || "Finance".equals(Form)) {
    result = ctx.get('DocSubject');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else if ("AddAgr".equals(form)) {
    result = ctx.get('SubjectA');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else if ("DocDogovor".equals(form)) {
    result = ctx.get('Displayheader');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else if ("resolution".equals(form)) {
    result = ctx.get('resolution');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else if (!"".equals(subject)) {
    result = subject;
ctx.setResult(result);
} else {
    result = ctx.get('ProjectName');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
}]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[var result;var typeName;var vers=ctx.get('Cm6$Subject');vers = vers.size() > 0 ? vers.get(0) : '';if (vers != '') {typeName = ctx.get('type_document');var subj = ctx.get('title');subj = subj.size() > 0 ? subj.get(0) : '';typeName = typeName.size() > 0 ? typeName.get(0) : '';result = typeName + " " + subj;ctx.setResult(result);}else{ Type_Name = ctx.get('Type_Name');var Subject = ctx.get('Subject');Type_Name = Type_Name.size() > 0 ? Type_Name.get(0) : '';Subject = Subject.size() > 0 ? Subject.get(0) : ''; result = Type_Name + " " + Subject;ctx.setResult(result);}]]></calc-doc-info>
    <source doc-type="">
      <module ident="OutputDocsPrev"/>
      <module ident="Tasks"/>
    </source>
    <target doc-type="">
      <module ident="OutputDocs"/>
      <module ident="ContractsLite"/>
      <module ident="InternalDocs"/>
      <module ident="InputDocs"/>
      <module ident="EDM-Docs"/>
      <module ident="Missions"/>
      <module ident="InputDocs"/>
      <module ident="Tasks"/>
    </target>
    <link-types>
      <link-type-ref ref="SEE_ALSO" direction="without" back-ref="SEE_ALSO" select="true" default="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;var vers=ctx.get('Cm6$Subject');vers = vers.size() > 0 ? vers.get(0) : '';if (vers != '') {var subj = ctx.get('title');subj = subj.size() > 0 ? subj.get(0) : '';result = subj;}else{ result = ctx.get('Subject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);}ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link for-general-document="true">
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="Meetings"/>
    </source>
    <target doc-type="">
      <module ident="InternalDocsPrev"/>
      <module ident="MissionsPrev"/>
      <module ident="InternalDocs"/>
      <module ident="Missions"/>
      <module ident="OutputDocs"/>
      <module ident="OutputDocsPrev"/>
      <module ident="InputDocs"/>
      <module ident="InputDocsPrev"/>
    </target>
    <link-types>
      <link-type-ref ref="LINK_WITH" direction="without" back-ref="LINK_WITH" select="true" link-on="now"/>
      <link-type-ref ref="AT" direction="to" back-ref="FROM" select="true" link-on="now"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[
var result;

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);		
	}
}

var vers = context.get('Cm6$Subject');
vers = vers.size() > 0 ? vers.get(0) : '';
if (vers != '') {
    var subj = context.get('title');
    subj = subj.size() > 0 ? subj.get(0) : '';
    result = subj;
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}
ctx.setResult(result);
    ]]>
    </calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link for-general-document="true">
    <meta>
      <documentation>Тип "В ответ на" является системным.</documentation>
    </meta>
    <calc-doc-info lang="JavaScript"><![CDATA[var result;var Reqtype = ctx.get('Reqtype');var rprist = ctx.get('rprist');var RNumber = ctx.get('RNumber');var rfin = ctx.get('rfin');var Outdate = ctx.get('Outdate');Reqtype = Reqtype.size() > 0 ? Reqtype.get(0) : '';rprist = rprist.size() > 0 ? rprist.get(0) : '';RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';rfin = rfin.size() > 0 ? rfin.get(0) : '';Outdate = Outdate.size() > 0 ? Outdate.get(0).toString() : '';var result = Reqtype + " " + rprist + RNumber + rfin + " от " + Outdate;ctx.setResult(result);]]></calc-doc-info>
    <source doc-type="">
      <module ident="InternalDocsPrev"/>
      <module ident="InternalDocs"/>
    </source>
    <target doc-type="">
      <module ident="InternalDocsPrev"/>
      <module ident="InternalDocs"/>
    </target>
    <link-types>
      <link-type-ref ref="FROM" direction="from" back-ref="AT" select="true" default="true" link-on="registration"/>
      <link-type-ref ref="AT" direction="to" back-ref="FROM" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[
var result;

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);		
	}
}

var vers = context.get('Cm6$Subject');
vers = vers.size() > 0 ? vers.get(0) : '';
if (vers != '') {
    var subj = context.get('title');
    subj = subj.size() > 0 ? subj.get(0) : '';
    result = subj;
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}
ctx.setResult(result);
    ]]>
    </calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="DocDogovor">
      <module ident="ContractsLite"/>
    </source>
    <target doc-type="">
      <module ident="InternalDocsPrev"/>
      <module ident="InternalDocs"/>
      <module ident="OutputDocs"/>
      <module ident="InputDocs"/>
      <module ident="OutputDocsPrev"/>
      <module ident="InputDocsPrev"/>
    </target>
    <link-types>
      <link-type-ref ref="EXECUTED" direction="to" back-ref="EXECUTE" select="true" link-on="now"/>
      <link-type-ref ref="BEFORE" direction="from" back-ref="AFTER" select="true" link-on="now"/>
      <link-type-ref ref="AFTER" direction="to" back-ref="BEFORE" select="true" link-on="now"/>
      <link-type-ref ref="EXECUTE" direction="from" back-ref="EXECUTED" select="true" link-on="now"/>
      <link-type-ref ref="ADD" direction="from" back-ref="ADDED" select="true" link-on="now"/>
      <link-type-ref ref="CANCEL" direction="from" back-ref="CANCELED" select="true" link-on="now"/>
      <link-type-ref ref="PROLONG" direction="from" back-ref="PROLONGED" select="true" link-on="now"/>
      <link-type-ref ref="LINK_WITH" direction="without" back-ref="LINK_WITH" select="true" link-on="now"/>
      <link-type-ref ref="SEE_ALSO" direction="without" back-ref="SEE_ALSO" select="true" link-on="now"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link for-general-document="true">
    <calc-doc-info lang="JavaScript"><![CDATA[var result;var Reqtype = ctx.get('Reqtype');var rprist = ctx.get('rprist');var RNumber = ctx.get('RNumber');var rfin = ctx.get('rfin');var RDate = ctx.get('RDate');Reqtype = Reqtype.size() > 0 ? Reqtype.get(0) : '';rprist = rprist.size() > 0 ? rprist.get(0) : '';RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';rfin = rfin.size() > 0 ? rfin.get(0) : '';RDate = RDate.size() > 0 ? RDate.get(0).toString() : '';var result = Reqtype + " №" + rprist + RNumber + rfin + " от " + RDate;ctx.setResult(result);]]></calc-doc-info>
    <source doc-type="">
      <module ident="OutputDocs"/>
    </source>
    <target doc-type="">
      <module ident="Requests"/>
    </target>
    <link-types>
      <link-type-ref ref="SLATTERFROM" direction="from" back-ref="SLATTERTO" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;

var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

if ("resolution".equals(Form)) {
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
    result = 'Имеется гриф ограничения доступа';
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = context.get('DocSubject');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("AddAgr".equals(Form)) {
    result = context.get('SubjectA');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("DocDogovor".equals(Form)) {
    result = context.get('Displayheader');
    result = result.size() > 0 ? result.get(0) : '';    
} else if ("resolution".equals(Form)) {
    result = context.get('resolution');
    result = result.size() > 0 ? result.get(0) : '';    
} else {
    result = context.get('Subject');
    result = result.size() > 0 ? result.get(0) : '';    
}

ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="Dog">
      <module ident="ContractsLite"/>
    </source>
    <target doc-type="">
      <module ident="ContractsLite"/>
    </target>
    <link-types>
      <link-type-ref ref="BEFORE" direction="from" back-ref="AFTER" link-on="now"/>
      <link-type-ref ref="AFTER" direction="to" back-ref="BEFORE" link-on="now"/>
      <link-type-ref ref="ADDED" direction="to" back-ref="ADD" link-on="now"/>
      <link-type-ref ref="CANCELED" direction="to" back-ref="CANCEL" link-on="now"/>
      <link-type-ref ref="LINK_WITH" direction="without" back-ref="LINK_WITH" select="true" link-on="now"/>
      <link-type-ref ref="PROLONGED" direction="to" back-ref="PROLONG" link-on="now"/>
      <link-type-ref ref="ADD" direction="from" back-ref="ADDED" select="true" link-on="now"/>
      <link-type-ref ref="SEE_ALSO" direction="without" back-ref="SEE_ALSO" select="true" link-on="now"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;
var Form = ctx.get('form');
Form = Form.size() > 0 ? Form.get(0) : '';

var secStamp = ctx.get('security_stamp_name');
if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {
	ctx.setResult('Имеется гриф ограничения доступа');
} else if ("Dog".equals(Form) || "Finance".equals(Form)) {
    result = ctx.get('DocSubject');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else if ("AddAgr".equals(Form)) {
    result = ctx.get('SubjectA');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else if ("DocDogovor".equals(Form)) {
    result = ctx.get('Displayheader');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
} else {
    result = ctx.get('Subject');
result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);
}]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link for-general-document="true">
    <meta>
      <documentation>Типы "Исполнение" и "В исполнение" являются системными.</documentation>
    </meta>
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="InputDocsPrev"/>
      <module ident="InputDocs"/>
    </source>
    <target doc-type="">
      <module ident="InputDocsPrev"/>
    </target>
    <link-types>
      <link-type-ref ref="BEFORE" direction="from" back-ref="AFTER" select="true" link-on="registration"/>
      <link-type-ref ref="AFTER" direction="to" back-ref="BEFORE" select="true" link-on="registration"/>
      <link-type-ref ref="EXECUTE" direction="from" back-ref="EXECUTED" link-on="registration"/>
      <link-type-ref ref="EXECUTED" direction="to" back-ref="EXECUTE" link-on="registration"/>
      <link-type-ref ref="FROM" direction="from" back-ref="AT" select="true" link-on="registration"/>
      <link-type-ref ref="AT" direction="to" back-ref="FROM" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;var Form = ctx.get('form');Form = Form.size() > 0 ? Form.get(0) : '';var secStamp = ctx.get('security_stamp_name');if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {ctx.setResult('Имеется гриф ограничения доступа');} else  if ("Dog".equals(Form) || "Finance".equals(Form)) {    result = ctx.get('DocSubject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("AddAgr".equals(Form)) {    result = ctx.get('SubjectA');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("DocDogovor".equals(Form)) {    result = ctx.get('Displayheader');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("resolution".equals(Form)) {    result = ctx.get('resolution');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else {    result = ctx.get('Subject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);}]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[var result;var typeName;var vers=ctx.get('Cm6$Subject');vers = vers.size() > 0 ? vers.get(0) : '';if (vers != '') {typeName = ctx.get('type_document');var subj = ctx.get('title');subj = subj.size() > 0 ? subj.get(0) : '';typeName = typeName.size() > 0 ? typeName.get(0) : '';result = typeName + " " + subj;ctx.setResult(result);}else{ Type_Name = ctx.get('Type_Name');var Subject = ctx.get('Subject');Type_Name = Type_Name.size() > 0 ? Type_Name.get(0) : '';Subject = Subject.size() > 0 ? Subject.get(0) : ''; result = Type_Name + " " + Subject;ctx.setResult(result);}]]></calc-doc-info>
    <source doc-type="">
      <module ident="OutputDocs"/>
      <module ident="ContractsLite"/>
      <module ident="OutputDocsPrev"/>
      <module ident="InternalDocsPrev"/>
      <module ident="InputDocsPrev"/>
      <module ident="InternalDocs"/>
      <module ident="InputDocs"/>
      <module ident="Missions"/>
      <module ident="MissionsPrev"/>
    </source>
    <target doc-type="">
      <module ident="EDM-Docs"/>
    </target>
    <link-types>
      <link-type-ref ref="SEE_ALSO" direction="without" back-ref="SEE_ALSO" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;var vers=ctx.get('Cm6$Subject');vers = vers.size() > 0 ? vers.get(0) : '';if (vers != '') {var subj = ctx.get('title');subj = subj.size() > 0 ? subj.get(0) : '';result = subj;}else{ result = ctx.get('Subject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);}ctx.setResult(result);]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link for-general-document="true">
    <calc-doc-info lang="JavaScript"><![CDATA[
var complect = ctx.get('Complect');
complect = complect.size() > 0 ? complect.get(0) : '';
var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1) : '';

var Form = ctx.get('Form');
Form = Form.size() > 0 ? Form.get(0) : '';

var context = ctx;

var resolutionType = '';
if ("resolution".equals(Form)) {	
	if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("OutputDocs", "OutputDocsPrev", "Missions", "MissionsPrev", "Tasks", "ContractsLite"))) {
		resolutionType = "Поручение по документу ";
	} else {
		resolutionType = "Резолюция по документу ";
	}
	var rkkDocId = ctx.get('RkkDocId');
	rkkDocId = rkkDocId.size() > 0 ? rkkDocId.get(0) : '';
	if (rkkDocId !== '') {
		context = session.findByStrId(rkkDocId);
		Form = context.get('Form');
		Form = Form.size() > 0 ? Form.get(0) : '';
	}
}

var OutDate = context.get('OutDate');
OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
var Date;

if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
    Date = OutDate;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
    Date = context.get('ResDate');
    Date = Date.size() > 0 ? Date.get(0) : '';
} else {
    Date = context.get('Rdate');
    Date = Date.size() > 0 ? Date.get(0) : '';
}


var OutNumber = context.get('OutNumber');
OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
var Type;

if ("spismo".equals(Form)) {
    Type = "СП ";
} else if ("Dog".equals(Form)) {
    Type = context.get('dogtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
} else if ("AddAgr".equals(Form)) {
    Type = "ДС ";
} else if ("DocDogovor".equals(Form)) {
    Type = "Документ по договору ";
} else if ("Finance".equals(Form)) {
    Type = "Фин. документ ";
} else {
    Type = context.get('reqtype');
    Type = Type.size() > 0 ? Type.get(0) : '';
}

var Number;
if ("spismo".equals(Form)) {
    Number = OutNumber;
} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
} else if ("Finance".equals(Form)) {
    Number = context.get("Number");
    Number = Number.size() > 0 ? Number.get(0) : '';    
} else {
    var rprist = context.get('rprist');
    var RNumber = context.get('RNumber');
    var rfin = context.get('rfin');
    rprist = rprist.size() > 0 ? rprist.get(0) : '';
    RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';
    rfin = rfin.size() > 0 ? rfin.get(0) : '';
    Number = rprist + RNumber + rfin;
}

Date = Date == '' ? "" : Date.toString();
var result = resolutionType + Type + " " + Number + " от " + Date;
ctx.setResult(result);
    ]]>
    </calc-doc-info>
    <source doc-type="">
      <module ident="OutputDocs"/>
      <module ident="InputDocs"/>
      <module ident="Missions"/>
      <module ident="InternalDocs"/>
      <module ident="Requests"/>
      <module ident="Tasks"/>
      <module ident="InternalDocsPrev"/>
      <module ident="OutputDocsPrev"/>
      <module ident="InputDocsPrev"/>
      <module ident="MissionsPrev"/>
      <module ident="RequestsPrev"/>
    </source>
    <target doc-type="">
      <module ident="Tasks"/>
    </target>
    <link-types>
      <link-type-ref ref="EXECUTED" direction="to" back-ref="EXECUTE" select="true" link-on="registration"/>
      <link-type-ref ref="ADDED" direction="to" back-ref="ADD" select="true" link-on="registration"/>
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;var Form = ctx.get('form');Form = Form.size() > 0 ? Form.get(0) : '';var secStamp = ctx.get('security_stamp_name');if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {ctx.setResult('Имеется гриф ограничения доступа');} else  if ("Dog".equals(Form) || "Finance".equals(Form)) {    result = ctx.get('DocSubject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("AddAgr".equals(Form)) {    result = ctx.get('SubjectA');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("DocDogovor".equals(Form)) {    result = ctx.get('Displayheader');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("resolution".equals(Form)) {    result = ctx.get('resolution');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else {    result = ctx.get('Subject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);}]]></calc-name>
    <get-doc way="byDocID"/>
  </link>
  <link>
    <calc-doc-info lang="JavaScript"><![CDATA[
    var complect = ctx.get('Complect');
    complect = complect.size() > 0 ? complect.get(0) : '';
    var complect2 = complect != '' ? complect.substring(complect.lastIndexOf('%') + 1)  : '';
    var OutDate = ctx.get('OutDate');
    OutDate = OutDate.size() > 0 ? OutDate.get(0) : '';
    var Date;
    if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {
        if (OutDate == '') {
             Date = ctx.get('outdate_1');
             Date = Date.size() > 0 ? Date.get(0) : '';
        } else {
             Date = OutDate.toString();
        }
    } else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InternalDocs", "InternalDocsPrev", "Missions", "MissionsPrev"))) {
       Date = OutDate;
    } else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("Tasks"))) {
       Date = ctx.get('ResDate');Date = Date.size() > 0 ? Date.get(0) : '';
    } else {
      Date = ctx.get('Rdate');Date = Date.size() > 0 ? Date.get(0) : '';
    }var Form = ctx.get('Form');
    Form = Form.size() > 0 ? Form.get(0) : '';
    var OutNumber = ctx.get('OutNumber');
    OutNumber = OutNumber.size() > 0 ? OutNumber.get(0) : '';
    var Type;var Number;
    if ("spismo".equals(Form)) {
        Type = "СП ";
    } else if ("resolution".equals(Form)) {
         Type = "Поручение ";
    } else if ("Dog".equals(Form)) {
            Type = ctx.get('dogtype');
            Type = Type.size() > 0 ? Type.get(0) : '';
    } else if ("AddAgr".equals(Form)) {
            Type = "ДС ";
    } else if ("DocDogovor".equals(Form)) {
            Type = "Документ по договору ";
    } else if ("Finance".equals(Form)) {        Type = "Финдокумент ";    } else {        Type = ctx.get('reqtype');Type = Type.size() > 0 ? Type.get(0) : '';    }if ("spismo".equals(Form)) {   Number = OutNumber;} else if (session.equalsArrays(session.createArray(complect, complect2), session.createArray("InputDocs", "InputDocsPrev"))) {    Number = OutNumber;} else {var rprist = ctx.get('rprist');var RNumber = ctx.get('RNumber');var rfin = ctx.get('rfin');rprist = rprist.size() > 0 ? rprist.get(0) : '';RNumber = RNumber.size() > 0 ? RNumber.get(0) : '';rfin = rfin.size() > 0 ? rfin.get(0) : '';    Number = rprist + RNumber + rfin;}Date = Date == '' ? "" : Date.toString();var result = Type + " " + Number +  " от " + Date;ctx.setResult(result);]]></calc-doc-info>
    <source doc-type="">
      <module ident="Requests" />
      <module ident="RequestsPrev" />
    </source>
    <target doc-type="">
      <module ident="Requests" />
      <module ident="RequestsPrev" />
    </target>
    <link-types>
      <link-type-ref link-on="now" select="true" back-ref="RECALL" direction="to" ref="RECALL_REQUEST" />
      <link-type-ref link-on="registration" select="true" back-ref="RECALL_REQUEST" direction="from" ref="RECALL" />
    </link-types>
    <calc-name lang="JavaScript"><![CDATA[var result;var Form = ctx.get('form');Form = Form.size() > 0 ? Form.get(0) : '';var secStamp = ctx.get('security_stamp_name');if (secStamp.size() > 0 && !secStamp.get(0).equals('')) {ctx.setResult('Имеется гриф ограничения доступа');} else  if ("Dog".equals(Form) || "Finance".equals(Form)){    result = ctx.get('DocSubject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("AddAgr".equals(Form)) {    result = ctx.get('SubjectA');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("DocDogovor".equals(Form)) {    result = ctx.get('Displayheader');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else if ("resolution".equals(Form)) {    result = ctx.get('resolution');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);} else {    result = ctx.get('Subject');result = result.size() > 0 ? result.get(0) : '';ctx.setResult(result);}]]></calc-name>
    <get-doc way="byDocID" />
  </link>
</links>