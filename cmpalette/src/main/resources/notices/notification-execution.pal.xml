<?xml version='1.0' encoding='UTF-8'?>
<notifications xmlns="http://www.intertrust.ru/schema/palette/notifications">

  <!-- Работа с МРМ-->
  <notification locale="RU" type="RVZR1_41">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[Проект <#if document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">резолюции<#else>поручения</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if> утвержден]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>


Краткое содержание:

<#if document.get("Module.Type.Alias")=="Tasks" || document.get("regnumcnt")??>Поручение № <#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if> от <#if document.get("date")??><#assign d2 = document.get("date")?index_of("-")><#assign d0 = document.get("date")?last_index_of("-")><#assign dy = document.get("date")?substring(0,d2)><#assign dd = document.get("date")?substring(d0+1)><#assign dm = document.get("date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else>ДОКУМЕНТ:<#if document.get("DocType")??>${document.get("DocType")}<#else></#if><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if  document.get("Module.Type.Alias")=="Tasks"><#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else><#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if></#if>


СРОК: <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}</#if>

Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[Проект <#if document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">резолюции<#else>поручения</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if> утвержден]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>


Краткое содержание:

<#if document.get("Module.Type.Alias")=="Tasks" || document.get("regnumcnt")??>Поручение № <#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if> от <#if document.get("date")??><#assign d2 = document.get("date")?index_of("-")><#assign d0 = document.get("date")?last_index_of("-")><#assign dy = document.get("date")?substring(0,d2)><#assign dd = document.get("date")?substring(d0+1)><#assign dm = document.get("date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else>ДОКУМЕНТ:<#if document.get("DocType")??>${document.get("DocType")}<#else></#if><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if  document.get("Module.Type.Alias")=="Tasks"><#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else><#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if></#if>


СРОК: <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}</#if>

Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </inputbox-channel>
  </notification>
  <notification locale="RU" type="RVZR1_21">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция возвращена на доработку<#else>Поручение возвращено на доработку</#if> от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>

Для: ${cmjNotice.readStringField("To_WP")}

Краткое содержание:

ДОКУМЕНТ: <#if document.get("Type")??>${document.get("Type")}<#else></#if> № <#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if> от  <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")> <#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")> <#assign dy = document.get("HierRoot.regdate")?substring(0,d2)> <#assign dd = document.get("HierRoot.regdate")?substring(d0+1)> <#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)> <#assign ddl = dd?length> <#assign dml = dm?length> <#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>

Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>

<#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Проект резолюции<#else>Проект поручения</#if> от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if> возвращен на доработку]]></subject>
      <body-html lang="FreeMarker"><![CDATA[<i>От:</i> <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>
<br><br>
<i>Для:</i> ${cmjNotice.readStringField("To_WP")}
<br><br>
Краткое содержание:
<br><br>
ДОКУМЕНТ: <#if document.get("Type")??>${document.get("Type")}<#else></#if> № <#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if> от  <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")> <#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")> <#assign dy = document.get("HierRoot.regdate")?substring(0,d2)> <#assign dd = document.get("HierRoot.regdate")?substring(d0+1)> <#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)> <#assign ddl = dd?length> <#assign dml = dm?length> <#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>
<br><br>
Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>
<br><br>
<#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if>
<br><br>
<#if document.get("ctrldeadline")??><#assign resolutionDate = document.get("ctrldeadline")><#assign day = resolutionDate.getDayOfMonth()><#assign dayLessThan10 = day < 9><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = resolutionDate.getMonth() + 1><#assign monthLessThan10 = month < 9><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = resolutionDate.getYear()?c><#assign resultResolutionDate = resultDay + "." + resultMonth + "." + resultYear>Срок: ${resultResolutionDate}<#else>СРОК: </#if>
<br><br>
Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body-html>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>

Для: ${cmjNotice.readStringField("To_WP")}

Краткое содержание:

ДОКУМЕНТ: <#if document.get("Type")??>${document.get("Type")}<#else></#if> № <#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if> от  <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")> <#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")> <#assign dy = document.get("HierRoot.regdate")?substring(0,d2)> <#assign dd = document.get("HierRoot.regdate")?substring(d0+1)> <#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)> <#assign ddl = dd?length> <#assign dml = dm?length> <#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>

Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>

<#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </inputbox-channel>
  </notification>
  <notification locale="RU" type="RVZR1_11">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Создана резолюция<#else>Создано поручение</#if> от <#if Sochi$Pkd.nameFrom()??> ${Sochi$Pkd.nameFrom()}<#else><#if Sochi$Pkd.beardFrom()??>${crudService.find(Sochi$Pkd.beardFrom()).getString("orig_shortname")}<#else></#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if Sochi$Pkd.nameFrom()??> ${Sochi$Pkd.nameFrom()}<#else><#if Sochi$Pkd.beardFrom()??>${crudService.find(Sochi$Pkd.beardFrom()).getString("orig_shortname")}<#else></#if></#if>

Для: ${cmjNotice.readStringField("To_WP")}

Краткое содержание:

ДОКУМЕНТ: <#if document.get("Type")??>${document.get("Type")}<#else></#if> № <#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if> от  <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")> <#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")> <#assign dy = document.get("HierRoot.regdate")?substring(0,d2)> <#assign dd = document.get("HierRoot.regdate")?substring(d0+1)> <#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)> <#assign ddl = dd?length> <#assign dml = dm?length> <#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>

Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>

<#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Создана резолюция<#else>Создано поручение</#if> от <#if Sochi$Pkd.nameFrom()??> ${Sochi$Pkd.nameFrom()}<#else><#if Sochi$Pkd.beardFrom()??>${crudService.find(Sochi$Pkd.beardFrom()).getString("orig_shortname")}<#else></#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if Sochi$Pkd.nameFrom()??> ${Sochi$Pkd.nameFrom()}<#else><#if Sochi$Pkd.beardFrom()??>${crudService.find(Sochi$Pkd.beardFrom()).getString("orig_shortname")}<#else></#if></#if>

Для: ${cmjNotice.readStringField("To_WP")}

Краткое содержание:

ДОКУМЕНТ: <#if document.get("Type")??>${document.get("Type")}<#else></#if> № <#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if> от  <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")> <#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")> <#assign dy = document.get("HierRoot.regdate")?substring(0,d2)> <#assign dd = document.get("HierRoot.regdate")?substring(d0+1)> <#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)> <#assign ddl = dd?length> <#assign dml = dm?length> <#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>

Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>

<#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </inputbox-channel>
  </notification>
  <notification locale="RU" type="NotificationByResolutionApproval">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[Проект <#if document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">резолюции<#else>поручения</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if> утвержден]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>


Краткое содержание:

<#if document.get("Module.Type.Alias")=="Tasks" || document.get("regnumcnt")??>Поручение № <#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if> от <#if document.get("date")??><#assign d2 = document.get("date")?index_of("-")><#assign d0 = document.get("date")?last_index_of("-")><#assign dy = document.get("date")?substring(0,d2)><#assign dd = document.get("date")?substring(d0+1)><#assign dm = document.get("date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else>ДОКУМЕНТ:<#if document.get("DocType")??>${document.get("DocType")}<#else></#if><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if  document.get("Module.Type.Alias")=="Tasks"><#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else><#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if></#if>


СРОК: <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}</#if>

Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[Проект <#if document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">резолюции<#else>поручения</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if> утвержден]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>


Краткое содержание:

<#if document.get("Module.Type.Alias")=="Tasks" || document.get("regnumcnt")??>Поручение № <#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if> от <#if document.get("date")??><#assign d2 = document.get("date")?index_of("-")><#assign d0 = document.get("date")?last_index_of("-")><#assign dy = document.get("date")?substring(0,d2)><#assign dd = document.get("date")?substring(d0+1)><#assign dm = document.get("date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else>ДОКУМЕНТ:<#if document.get("DocType")??>${document.get("DocType")}<#else></#if><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if  document.get("Module.Type.Alias")=="Tasks"><#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else><#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if></#if>


СРОК: <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}</#if>

Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </inputbox-channel>
  </notification>

  <!-- На утверждение -->
  <notification locale="RU" type="SEND1_21">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[<#assign moduleType = document.get("Module.Type.Alias")>На утверждение проект <#if  moduleType=="InputDocs" || moduleType=="InternalDocs" || moduleType=="Requests">резолюции<#else>поручения</#if> по документу № <#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if>]]></subject>
      <body-html lang="FreeMarker"><![CDATA[<#assign moduleType = document.get("Module.Type.Alias")><#assign resolutionText = document.get("Resolution")><#assign resolutionAuthor = document.get("Author.orig_shortname")>
<i>От:</i> <#if Sochi$Pkd.nameFrom()??> ${Sochi$Pkd.nameFrom()}<#else><#if Sochi$Pkd.beardFrom()??>${crudService.find(Sochi$Pkd.beardFrom()).getString("orig_shortname")}<#else></#if></#if>
<br><br>
<i>Для:</i> ${resolutionAuthor}
<br><br>
<i>Краткое содержание:</i>
<br><br>
ДОКУМЕНТ: <#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>
<br><br>
Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>
<br><br>
<#if  moduleType=="InputDocs" || moduleType=="InternalDocs" || moduleType=="Requests">Резолюция: <#else>Поручение: </#if>${resolutionText}
<br><br>
<#if document.get("ctrldeadline")??><#assign resolutionDate = document.get("ctrldeadline")><#assign day = resolutionDate.getDayOfMonth()><#assign dayLessThan10 = day < 9><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = resolutionDate.getMonth() + 1><#assign monthLessThan10 = month < 9><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = resolutionDate.getYear()?c><#assign resultResolutionDate = resultDay + "." + resultMonth + "." + resultYear>Срок: ${resultResolutionDate}<#else>СРОК: </#if>
<br><br>
Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body-html>
    </email-channel>
    <inputbox-channel />
  </notification>

  <!-- На исполнение -->
  <notification locale="RU" type="EXEC1_11">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[На исполнение <#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if> от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if> (срок <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}<#else>не указан</#if>)<#if document.get("Module.Type.Alias")=="Tasks" || document.get("regnumcnt")??><#else> по документу № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>


Для: ${cmjNotice.readStringField("To_WP")}

Краткое содержание:

<#if document.get("Module.Type.Alias")=="Tasks" || document.get("regnumcnt")??>Поручение № <#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if> от <#if document.get("date")??><#assign d2 = document.get("date")?index_of("-")><#assign d0 = document.get("date")?last_index_of("-")><#assign dy = document.get("date")?substring(0,d2)><#assign dd = document.get("date")?substring(d0+1)><#assign dm = document.get("date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else>ДОКУМЕНТ: <#if document.get("HierRoot.Form")=="AddAgr">Доп. соглашение<#else><#if document.get("DocType")??>${document.get("DocType")}<#else></#if><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if  document.get("Module.Type.Alias")=="Tasks"><#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else><#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if></#if>


СРОК: <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}</#if>

Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[На исполнение <#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if> от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if> (срок <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}<#else>не указан</#if>)<#if document.get("Module.Type.Alias")=="Tasks" || document.get("regnumcnt")??><#else> по документу № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>


Для: ${cmjNotice.readStringField("To_WP")}

Краткое содержание:

<#if document.get("Module.Type.Alias")=="Tasks" || document.get("regnumcnt")??>Поручение № <#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if> от <#if document.get("date")??><#assign d2 = document.get("date")?index_of("-")><#assign d0 = document.get("date")?last_index_of("-")><#assign dy = document.get("date")?substring(0,d2)><#assign dd = document.get("date")?substring(d0+1)><#assign dm = document.get("date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else>ДОКУМЕНТ: <#if document.get("HierRoot.Form")=="AddAgr">Доп. соглашение<#else><#if document.get("DocType")??>${document.get("DocType")}<#else></#if><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if  document.get("Module.Type.Alias")=="Tasks"><#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else><#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if></#if>


СРОК: <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}</#if>

Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </inputbox-channel>
  </notification>

  <!-- Изменение реквизитов -->
  <notification locale="RU" type="EXEC1_12">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[<#assign srcDelText = "Добавлен:"><#assign srcSubject = cmjNotice.readStringField("Subject_WP")><#assign delExecutors = srcSubject?substring(srcSubject?last_index_of(srcDelText))?replace(srcDelText, "Добавлен исполнитель:")><#assign moduleType = document.get("Module.Type.Alias")>${delExecutors} в <#if document.get("HierRoot")?? && moduleType=="Tasks">Поручение № <#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if><#assign resolutionDate = document.get("date")><#if resolutionDate??><#assign day = resolutionDate.getDayOfMonth()><#assign dayLessThan10 = day < 9><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = resolutionDate.getMonth() + 1><#assign monthLessThan10 = month < 9><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = resolutionDate.getYear()?c><#assign resultResolutionDate = resultDay + "." + resultMonth + "." + resultYear> от ${resultResolutionDate}<#else></#if><#else><#if  moduleType=="InputDocs" || moduleType=="InternalDocs" || moduleType=="Requests">резолюцию<#else>поручение</#if> по <#if  moduleType=="Tasks">Поручение<#else><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if><#assign regDate = document.get("HierRoot.regdate")><#if regDate??><#assign day = regDate.getDayOfMonth()><#assign dayLessThan10 = day < 9><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = regDate.getMonth() + 1><#assign monthLessThan10 = month < 9><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = regDate.getYear()?c><#assign resultRegDate = resultDay + "." + resultMonth + "." + resultYear> от ${resultRegDate}<#else></#if></#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[<#assign moduleType = document.get("Module.Type.Alias")><#assign resolutionText = document.get("Resolution")><#assign resolutionAuthor = document.get("Author.orig_shortname")><#if  moduleType=="InputDocs" || moduleType=="InternalDocs" || moduleType=="Requests">Резолюция: <#else>Поручение: </#if>${resolutionText}

Автор: ${resolutionAuthor}

<#if document.get("ctrldeadline")??><#assign resolutionDate = document.get("ctrldeadline")><#assign day = resolutionDate.getDayOfMonth()><#assign dayLessThan10 = day < 9><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = resolutionDate.getMonth() + 1><#assign monthLessThan10 = month < 9><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = resolutionDate.getYear()?c><#assign resultResolutionDate = resultDay + "." + resultMonth + "." + resultYear>Срок: ${resultResolutionDate}<#else>Срок: </#if>

Кто добавил: <#if Sochi$Pkd.nameFrom()??> ${Sochi$Pkd.nameFrom()}<#else><#if Sochi$Pkd.beardFrom()??>${crudService.find(Sochi$Pkd.beardFrom()).getString("orig_shortname")}<#else></#if></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </email-channel>
    <inputbox-channel />
  </notification>
  <notification locale="RU" type="EXEC1_13">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[<#assign srcDelText = "Удален:"><#assign srcSubject = cmjNotice.readStringField("Subject_WP")><#assign delExecutors = srcSubject?substring(srcSubject?last_index_of(srcDelText))?replace(srcDelText, "Удален исполнитель:")><#assign moduleType = document.get("Module.Type.Alias")>${delExecutors} из <#if document.get("HierRoot")?? && moduleType=="Tasks">Поручения № <#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if><#assign resolutionDate = document.get("date")><#if resolutionDate??><#assign day = resolutionDate.getDayOfMonth()><#assign dayLessThan10 = day < 9><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = resolutionDate.getMonth() + 1><#assign monthLessThan10 = month < 9><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = resolutionDate.getYear()?c><#assign resultResolutionDate = resultDay + "." + resultMonth + "." + resultYear> от ${resultResolutionDate}<#else></#if><#else><#if  moduleType=="InputDocs" || moduleType=="InternalDocs" || moduleType=="Requests">резолюции<#else>поручения</#if> по <#if  moduleType=="Tasks">Поручение<#else><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if><#assign regDate = document.get("HierRoot.regdate")><#if regDate??><#assign day = regDate.getDayOfMonth()><#assign dayLessThan10 = day < 9><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = regDate.getMonth() + 1><#assign monthLessThan10 = month < 9><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = regDate.getYear()?c><#assign resultRegDate = resultDay + "." + resultMonth + "." + resultYear> от ${resultRegDate}<#else></#if></#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[<#assign moduleType = document.get("Module.Type.Alias")><#assign resolutionText = document.get("Resolution")><#assign resolutionAuthor = document.get("Author.orig_shortname")><#if  moduleType=="InputDocs" || moduleType=="InternalDocs" || moduleType=="Requests">Резолюция: <#else>Поручение: </#if>${resolutionText}

Автор: ${resolutionAuthor}

<#if document.get("ctrldeadline")??><#assign resolutionDate = document.get("ctrldeadline")><#assign day = resolutionDate.getDayOfMonth()><#assign dayLessThan10 = day < 9><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = resolutionDate.getMonth() + 1><#assign monthLessThan10 = month < 9><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = resolutionDate.getYear()?c><#assign resultResolutionDate = resultDay + "." + resultMonth + "." + resultYear>Срок: ${resultResolutionDate}<#else>Срок: </#if>

Кто удалил: <#if Sochi$Pkd.nameFrom()??> ${Sochi$Pkd.nameFrom()}<#else><#if Sochi$Pkd.beardFrom()??>${crudService.find(Sochi$Pkd.beardFrom()).getString("orig_shortname")}<#else></#if></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </email-channel>
    <inputbox-channel />
  </notification>
  <notification locale="RU" type="EXEC1_17">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[Изменен текст в содержании <#if document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests"> резолюции. <#else> поручения. </#if><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)> <#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#if document.get("Module.Type.Alias")=="Tasks"><#else>: <#if document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests"> Резолюция <#else>	Поручение </#if> от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>, срок исполнения <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}<#else>не указан</#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>


Для: ${cmjNotice.readStringField("To_WP")}

Краткое содержание:

<#if document.get("Module.Type.Alias")=="Tasks" || document.get("regnumcnt")??>Поручение № <#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if> от <#if document.get("date")??><#assign d2 = document.get("date")?index_of("-")><#assign d0 = document.get("date")?last_index_of("-")><#assign dy = document.get("date")?substring(0,d2)><#assign dd = document.get("date")?substring(d0+1)><#assign dm = document.get("date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else>ДОКУМЕНТ: <#if document.get("HierRoot.Form")=="AddAgr">Доп. соглашение<#else><#if document.get("DocType")??>${document.get("DocType")}<#else></#if><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if  document.get("Module.Type.Alias")=="Tasks"><#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else><#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if></#if>


СРОК: <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}</#if>

Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[Изменен текст в содержании <#if document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests"> резолюции. <#else> поручения. </#if><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)> <#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#if document.get("Module.Type.Alias")=="Tasks"><#else>: <#if document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests"> Резолюция <#else>	Поручение </#if> от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>, срок исполнения <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}<#else>не указан</#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>


Для: ${cmjNotice.readStringField("To_WP")}

Краткое содержание:

<#if document.get("Module.Type.Alias")=="Tasks" || document.get("regnumcnt")??>Поручение № <#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if> от <#if document.get("date")??><#assign d2 = document.get("date")?index_of("-")><#assign d0 = document.get("date")?last_index_of("-")><#assign dy = document.get("date")?substring(0,d2)><#assign dd = document.get("date")?substring(d0+1)><#assign dm = document.get("date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else>ДОКУМЕНТ: <#if document.get("HierRoot.Form")=="AddAgr">Доп. соглашение<#else><#if document.get("DocType")??>${document.get("DocType")}<#else></#if><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if  document.get("Module.Type.Alias")=="Tasks"><#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else><#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if></#if>


СРОК: <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}</#if>

Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </inputbox-channel>
  </notification>
  <notification locale="RU" type="EXEC1_16">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[Изменен текст <#if document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests"> резолюции. <#else> поручения. </#if><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)> <#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#if document.get("Module.Type.Alias")=="Tasks"><#else>: <#if document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests"> Резолюция <#else>	Поручение </#if> от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>, срок исполнения <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}<#else>не указан</#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>


Для: ${cmjNotice.readStringField("To_WP")}

Краткое содержание:

<#if document.get("Module.Type.Alias")=="Tasks" || document.get("regnumcnt")??>Поручение № <#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if> от <#if document.get("date")??><#assign d2 = document.get("date")?index_of("-")><#assign d0 = document.get("date")?last_index_of("-")><#assign dy = document.get("date")?substring(0,d2)><#assign dd = document.get("date")?substring(d0+1)><#assign dm = document.get("date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else>ДОКУМЕНТ: <#if document.get("HierRoot.Form")=="AddAgr">Доп. соглашение<#else><#if document.get("DocType")??>${document.get("DocType")}<#else></#if><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if  document.get("Module.Type.Alias")=="Tasks"><#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else><#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if></#if>


СРОК: <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}</#if>

Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[Изменен текст <#if document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests"> резолюции. <#else> поручения. </#if><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)> <#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#if document.get("Module.Type.Alias")=="Tasks"><#else>: <#if document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests"> Резолюция <#else>	Поручение </#if> от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>, срок исполнения <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}<#else>не указан</#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>


Для: ${cmjNotice.readStringField("To_WP")}

Краткое содержание:

<#if document.get("Module.Type.Alias")=="Tasks" || document.get("regnumcnt")??>Поручение № <#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if> от <#if document.get("date")??><#assign d2 = document.get("date")?index_of("-")><#assign d0 = document.get("date")?last_index_of("-")><#assign dy = document.get("date")?substring(0,d2)><#assign dd = document.get("date")?substring(d0+1)><#assign dm = document.get("date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else>ДОКУМЕНТ: <#if document.get("HierRoot.Form")=="AddAgr">Доп. соглашение<#else><#if document.get("DocType")??>${document.get("DocType")}<#else></#if><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if  document.get("Module.Type.Alias")=="Tasks"><#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else><#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if></#if>


СРОК: <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}</#if>

Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </inputbox-channel>
  </notification>
  <notification locale="RU" type="EXEC1_18">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[Изменен состав файлов в содержании <#if document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests"> резолюции. <#else> поручения. </#if><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)> <#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#if document.get("Module.Type.Alias")=="Tasks"><#else>: <#if document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests"> Резолюция <#else>	Поручение </#if> от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>, срок исполнения <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}<#else>не указан</#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>


Для: ${cmjNotice.readStringField("To_WP")}

Краткое содержание:

<#if document.get("Module.Type.Alias")=="Tasks" || document.get("regnumcnt")??>Поручение № <#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if> от <#if document.get("date")??><#assign d2 = document.get("date")?index_of("-")><#assign d0 = document.get("date")?last_index_of("-")><#assign dy = document.get("date")?substring(0,d2)><#assign dd = document.get("date")?substring(d0+1)><#assign dm = document.get("date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else>ДОКУМЕНТ: <#if document.get("HierRoot.Form")=="AddAgr">Доп. соглашение<#else><#if document.get("DocType")??>${document.get("DocType")}<#else></#if><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if  document.get("Module.Type.Alias")=="Tasks"><#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else><#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if></#if>


СРОК: <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}</#if>

Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[Изменен состав файлов в содержании <#if document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests"> резолюции. <#else> поручения. </#if><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)> <#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#if document.get("Module.Type.Alias")=="Tasks"><#else>: <#if document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests"> Резолюция <#else>	Поручение </#if> от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>, срок исполнения <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}<#else>не указан</#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>


Для: ${cmjNotice.readStringField("To_WP")}

Краткое содержание:

<#if document.get("Module.Type.Alias")=="Tasks" || document.get("regnumcnt")??>Поручение № <#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if> от <#if document.get("date")??><#assign d2 = document.get("date")?index_of("-")><#assign d0 = document.get("date")?last_index_of("-")><#assign dy = document.get("date")?substring(0,d2)><#assign dd = document.get("date")?substring(d0+1)><#assign dm = document.get("date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else>ДОКУМЕНТ: <#if document.get("HierRoot.Form")=="AddAgr">Доп. соглашение<#else><#if document.get("DocType")??>${document.get("DocType")}<#else></#if><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if  document.get("Module.Type.Alias")=="Tasks"><#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else><#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if></#if>


СРОК: <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}</#if>

Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </inputbox-channel>
  </notification>
  <notification locale="RU" type="EXEC1_19">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[<#if document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Изменена резолюция. <#else>Изменено поручение. </#if><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)> <#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#if document.get("Module.Type.Alias")=="Tasks"><#else>: <#if document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests"> Резолюция <#else>	Поручение </#if> от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>, срок исполнения <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}<#else>не указан</#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>


Для: ${cmjNotice.readStringField("To_WP")}

Краткое содержание:

<#if document.get("Module.Type.Alias")=="Tasks" || document.get("regnumcnt")??>Поручение № <#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if> от <#if document.get("date")??><#assign d2 = document.get("date")?index_of("-")><#assign d0 = document.get("date")?last_index_of("-")><#assign dy = document.get("date")?substring(0,d2)><#assign dd = document.get("date")?substring(d0+1)><#assign dm = document.get("date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else>ДОКУМЕНТ: <#if document.get("HierRoot.Form")=="AddAgr">Доп. соглашение<#else><#if document.get("DocType")??>${document.get("DocType")}<#else></#if><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if  document.get("Module.Type.Alias")=="Tasks"><#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else><#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if></#if>


СРОК: <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}</#if>

Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[<#if document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Изменена резолюция. <#else>Изменено поручение. </#if><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)> <#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#if document.get("Module.Type.Alias")=="Tasks"><#else>: <#if document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests"> Резолюция <#else>	Поручение </#if> от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>, срок исполнения <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}<#else>не указан</#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>


Для: ${cmjNotice.readStringField("To_WP")}

Краткое содержание:

<#if document.get("Module.Type.Alias")=="Tasks" || document.get("regnumcnt")??>Поручение № <#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if> от <#if document.get("date")??><#assign d2 = document.get("date")?index_of("-")><#assign d0 = document.get("date")?last_index_of("-")><#assign dy = document.get("date")?substring(0,d2)><#assign dd = document.get("date")?substring(d0+1)><#assign dm = document.get("date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else>ДОКУМЕНТ: <#if document.get("HierRoot.Form")=="AddAgr">Доп. соглашение<#else><#if document.get("DocType")??>${document.get("DocType")}<#else></#if><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if  document.get("Module.Type.Alias")=="Tasks"><#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else><#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if></#if>


СРОК: <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}</#if>

Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </inputbox-channel>
  </notification>

  <!-- Исполнение -->
  <notification locale="RU" type="EXEC1_41">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Исполнена резолюция<#else>Исполнено поручение</#if> от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if><#if  document.get("Module.Type.Alias")=="Tasks"><#else> по документу <#if document.get("Module.Title")??>${document.get("Module.Title")}<#else></#if> №<#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if Sochi$Pkd.nameFrom()??> ${Sochi$Pkd.nameFrom()}<#else><#if Sochi$Pkd.beardFrom()??>${crudService.find(Sochi$Pkd.beardFrom()).getString("orig_shortname")}<#else></#if></#if>


Для: <#list Sochi$Pkd.beardsTo() as beard>${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

<#if  document.get("Module.Type.Alias")=="Tasks">Поручение № <#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if> от <#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Поручение: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if><#else>ДОКУМЕНТ: <#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if></#if>


СРОК: <#if document.get("ctrldeadline")??><#assign d2 = document.get("ctrldeadline")?index_of("-")><#assign d0 = document.get("ctrldeadline")?last_index_of("-")><#assign dy = document.get("ctrldeadline")?substring(0,d2)><#assign dd = document.get("ctrldeadline")?substring(d0+1)><#assign dm = document.get("ctrldeadline")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Исполнена резолюция<#else>Исполнено поручение</#if> от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if><#if  document.get("Module.Type.Alias")=="Tasks"><#else> по документу <#if document.get("Module.Title")??>${document.get("Module.Title")}<#else></#if> №<#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if Sochi$Pkd.nameFrom()??> ${Sochi$Pkd.nameFrom()}<#else><#if Sochi$Pkd.beardFrom()??>${crudService.find(Sochi$Pkd.beardFrom()).getString("orig_shortname")}<#else></#if></#if>


Для: <#list Sochi$Pkd.beardsTo() as beard>${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

<#if  document.get("Module.Type.Alias")=="Tasks">Поручение № <#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if> от <#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Поручение: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if><#else>ДОКУМЕНТ: <#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if></#if>


СРОК: <#if document.get("ctrldeadline")??><#assign d2 = document.get("ctrldeadline")?index_of("-")><#assign d0 = document.get("ctrldeadline")?last_index_of("-")><#assign dy = document.get("ctrldeadline")?substring(0,d2)><#assign dd = document.get("ctrldeadline")?substring(d0+1)><#assign dm = document.get("ctrldeadline")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </inputbox-channel>
  </notification>
  <notification locale="RU" type="EXEC1_42">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Исполнена резолюция<#else>Исполнено поручение</#if> от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if><#if  document.get("Module.Type.Alias")=="Tasks"><#else> по документу <#if document.get("Module.Title")??>${document.get("Module.Title")}<#else></#if> №<#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if Sochi$Pkd.nameFrom()??> ${Sochi$Pkd.nameFrom()}<#else><#if Sochi$Pkd.beardFrom()??>${crudService.find(Sochi$Pkd.beardFrom()).getString("orig_shortname")}<#else></#if></#if>


Для: <#list Sochi$Pkd.beardsTo() as beard>${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

<#if  document.get("Module.Type.Alias")=="Tasks">ДОКУМЕНТ: Поручение № <#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else><#if document.get("RegNumPrist")??>${document.get("RegNumPrist")}<#else></#if></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else><#if document.get("RegNumCnt")??>${document.get("RegNumCnt")}<#else></#if></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else><#if document.get("RegNumFin")??>${document.get("RegNumFin")}<#else></#if></#if> от <#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else><#if document.get("date")??><#assign d2 = document.get("date")?index_of("-")><#assign d0 = document.get("date")?last_index_of("-")><#assign dy = document.get("date")?substring(0,d2)><#assign dd = document.get("date")?substring(d0+1)><#assign dm = document.get("date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if></#if>


Поручение: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if><#else>ДОКУМЕНТ: <#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


Поручение: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if></#if>


СРОК: <#if document.get("ctrldeadline")??><#assign d2 = document.get("ctrldeadline")?index_of("-")><#assign d0 = document.get("ctrldeadline")?last_index_of("-")><#assign dy = document.get("ctrldeadline")?substring(0,d2)><#assign dd = document.get("ctrldeadline")?substring(d0+1)><#assign dm = document.get("ctrldeadline")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Исполнена резолюция<#else>Исполнено поручение</#if> от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if><#if  document.get("Module.Type.Alias")=="Tasks"><#else> по документу <#if document.get("Module.Title")??>${document.get("Module.Title")}<#else></#if> №<#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if Sochi$Pkd.nameFrom()??> ${Sochi$Pkd.nameFrom()}<#else><#if Sochi$Pkd.beardFrom()??>${crudService.find(Sochi$Pkd.beardFrom()).getString("orig_shortname")}<#else></#if></#if>


Для: <#list Sochi$Pkd.beardsTo() as beard>${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

<#if  document.get("Module.Type.Alias")=="Tasks">ДОКУМЕНТ: Поручение № <#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else><#if document.get("RegNumPrist")??>${document.get("RegNumPrist")}<#else></#if></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else><#if document.get("RegNumCnt")??>${document.get("RegNumCnt")}<#else></#if></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else><#if document.get("RegNumFin")??>${document.get("RegNumFin")}<#else></#if></#if> от <#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else><#if document.get("date")??><#assign d2 = document.get("date")?index_of("-")><#assign d0 = document.get("date")?last_index_of("-")><#assign dy = document.get("date")?substring(0,d2)><#assign dd = document.get("date")?substring(d0+1)><#assign dm = document.get("date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if></#if>


Поручение: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if><#else>ДОКУМЕНТ: <#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


Поручение: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if></#if>


СРОК: <#if document.get("ctrldeadline")??><#assign d2 = document.get("ctrldeadline")?index_of("-")><#assign d0 = document.get("ctrldeadline")?last_index_of("-")><#assign dy = document.get("ctrldeadline")?substring(0,d2)><#assign dd = document.get("ctrldeadline")?substring(d0+1)><#assign dm = document.get("ctrldeadline")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </inputbox-channel>
  </notification>

  <!-- Напоминание о сроке -->
  <notification locale="RU" type="EXEC1_51">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[<#assign daysBeforeTerm = (Sochi$Pkd.dueDate()?long / 86400000)?round - (.now?long / 86400000)?round/>
Срок исполнения контрольного задания истекает через <#if daysBeforeTerm??>${daysBeforeTerm}<#else></#if> дней(-я) (срок <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string[""dd.MM.yyyy""]}<#else>не указан</#if>) <#if  document.get(""Module.Type.Alias"")==""Tasks"">Поручение<#else>Резолюция</#if>. от <#if document.get(""Author.Orig_ShortName"")??>${document.get(""Author.Orig_ShortName"")}<#else></#if> <#if  document.get(""Module.Type.Alias"")==""Tasks""><#else> по документу <#if document.get(""HierRoot.Type"")??>${document.get(""HierRoot.Type"")}<#else></#if></#if> от <#if document.get(""HierRoot.created_date"")??>${document.get(""HierRoot.created_date"")?date?string('dd.MM.yyyy')}<#else><#if document.get(""created_date"")??>${document.get(""created_date"")?date?string('dd.MM.yyyy')}<#else></#if></#if> № <#if document.get(""HierRoot.regnumber"")??>${document.get(""HierRoot.regnumber"")}<#else><#if document.get(""HierRoot.RegNumPrist"")??>${document.get(""HierRoot.RegNumPrist"")}<#else><#if document.get(""regNumPrist"")??>${document.get(""regNumPrist"")}<#else></#if></#if><#if document.get(""HierRoot.RegNumCnt"")??>${document.get(""HierRoot.RegNumCnt"")}<#else><#if document.get(""regNumCnt"")??>${document.get(""regNumCnt"")}<#else></#if></#if><#if document.get(""HierRoot.RegNumFin"")??>${document.get(""HierRoot.RegNumFin"")}<#else><#if document.get(""regNumFin"")??>${document.get(""regNumFin"")}<#else></#if></#if></#if>"]]></subject>
      <body-html lang="FreeMarker"><![CDATA[<head><style>p { font-family: Microsoft Sans Serif;font-size: 10pt;}</style></head>
<body><p>Для: <#list Sochi$Pkd.beardsTo() as beard> ${crudService.find(beard).getString(""orig_shortname"")}<#if beard_has_next >, <#else></#if></#list></p>
<p></p>
<p>Срок: <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string[""dd.MM.yyyy""]}<#else>не указан</#if></p>
<p></p>
<p>Автор: <#if document.get(""Author.Orig_ShortName"")??>${document.get(""Author.Orig_ShortName"")}<#else></#if></p>
<p></p>
<p>Контроллер:
<#assign formulaResContrl = ""select sb.orig_shortname
	from F_DP_ResltnBase_Cntrller rbc
	join F_DP_Resolution r on r.id = rbc.owner
	join so_beard sb on sb.id = rbc.controller
	where r.id = {0}"">
<#assign resContrl = session.findByQuery(formulaResContrl, document.getId())>
<#assign resContrlSize = resContrl.size()>
<#assign idx=0>
<#assign daysBeforeTerm = (Sochi$Pkd.dueDate()?long / 86400000)?round - (.now?long / 86400000)?round/>
<#if resContrl.size() != 0>
	<#list 0..resContrlSize - 1 as i>
		${resContrl.get(idx).getString(""orig_shortname"")}
		<#if i_has_next>,<#else></#if>
		<#assign idx= idx + 1>
	</#list>
<#else>
	<#if document.get(""HierRoot"")??><#else>
		<#if  document.get(""Module.Type.Alias"")==""Tasks"">
			<#assign formulaResTasks = ""select sb.orig_shortname
				from f_dp_rkkbase_controller rbc
				join f_dp_tasksresolution r on r.id = rbc.owner
				join so_beard sb on sb.id = rbc.controller
				where r.id = {0}"">
			<#assign resTasks = session.findByQuery(formulaResTasks, document.getId())>
			<#assign resTasksSize = resTasks.size()>
			<#if resTasks.size() != 0>
				<#list 0..resTasksSize - 1 as i>
					${resTasks.get(idx).getString(""orig_shortname"")}
					<#if i_has_next>,<#else></#if>
					<#assign idx= idx + 1>
				</#list>
			<#else>
			</#if>
		<#else>
		</#if>
	</#if>
</#if></p>
<p></p>
<p>Отв.исполнитель:
<#assign formulaExecContrl = ""SELECT execcurr_name.orig_shortname as executor FROM F_DP_Resolution res LEFT JOIN F_DP_ResltnBase_ExecResp executor ON executor.owner = res.id LEFT JOIN so_beard execcurr_name ON execcurr_name.id = executor.ExecutorResp WHERE res.id = {0}"">
<#assign execContrl = session.findByQuery(formulaExecContrl, document.getId())>
<#assign execContrlSize = execContrl.size()>
<#assign idx=0>
<#if execContrl.size() != 0>
	<#list 0..execContrlSize - 1 as i>
		${execContrl.get(idx).getString(""executor"")}
		<#if i_has_next>,<#else></#if>
		<#assign idx= idx + 1>
	</#list>
<#else>
	<#if document.get(""HierRoot"")??>
	<#else>
		<#if  document.get(""Module.Type.Alias"")==""Tasks"">
			<#assign formulaExecTasks = ""SELECT execcurr_name.orig_shortname as executor FROM F_DP_TasksResolution res LEFT JOIN F_DP_TasksResolution_ER executor ON executor.owner = res.id LEFT JOIN so_beard execcurr_name ON execcurr_name.id = executor.ExecutorResp WHERE res.id = {0}"">
			<#assign execTasks = session.findByQuery(formulaExecTasks, document.getId())>
			<#assign execTasksSize = execTasks.size()>
			<#if execTasks.size() != 0>
				<#list 0..execTasksSize - 1 as i>
					${execTasks.get(idx).getString(""executor"")}
					<#if i_has_next>,<#else></#if>
					<#assign idx= idx + 1>
				</#list>
			<#else>
			</#if>
		<#else>
		</#if>
	</#if>
</#if></p>
<p></p>
<p>Модуль: <#assign formula = ""SELECT name FROM ss_module sm left join f_dp_rkkbase fdr on fdr.module =sm.id left join ss_moduletype sm2 on sm2.id = sm.type WHERE fdr.id = {0}""> <#assign collection = session.findByQuery(formula, document.get(""HierRoot""))> ${collection.get(0).getString(""name"")}</p>
<p></p>
<p>Заголовок: <#if  document.get(""Module.Type.Alias"")==""Tasks"">Поручение<#else></#if> <#if document.get(""HierRoot.Type"")??>${document.get(""HierRoot.Type"")}<#else></#if> от <#if document.get(""HierRoot.created_date"")??>${document.get(""HierRoot.created_date"")?date?string('dd.MM.yyyy')}<#else><#if document.get(""created_date"")??>${document.get(""created_date"")?date?string('dd.MM.yyyy')}<#else></#if></#if> № <#if document.get(""HierRoot.regnumber"")??>${document.get(""HierRoot.regnumber"")}<#else><#if document.get(""HierRoot.RegNumPrist"")??>${document.get(""HierRoot.RegNumPrist"")}<#else><#if document.get(""regNumPrist"")??>${document.get(""regNumPrist"")}<#else></#if></#if><#if document.get(""HierRoot.RegNumCnt"")??>${document.get(""HierRoot.RegNumCnt"")}<#else><#if document.get(""regNumCnt"")??>${document.get(""regNumCnt"")}<#else></#if></#if><#if document.get(""HierRoot.RegNumFin"")??>${document.get(""HierRoot.RegNumFin"")}<#else><#if document.get(""regNumFin"")??>${document.get(""regNumFin"")}<#else></#if></#if></#if> <#if document.get(""Module.Type.Alias"")==""Tasks""><#else>«<#if document.get(""HierRoot.Subject"")??>${document.get(""HierRoot.Subject"")}<#else></#if>»</#if></p>
<p></p>
<p>Краткое содержание:  Срок исполнения контрольного задания истекает через <#if daysBeforeTerm??>${daysBeforeTerm}<#else></#if> дней(-я) </p>
<p></p>
<p><#if document.get(""Module.Type.Alias"")==""Tasks"">Поручение<#else>Резолюция</#if> : <#if document.get(""Resolution"")??>${document.get(""Resolution"")}<#else></#if></p>
<p></p>
<p>Открыть документ: <a href='${urlFormer.getUrl(""cm-sochi"", addressee.getId(), document.getId())}'>cсылка</a></p>
</body>]]></body-html>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[<#assign daysBeforeTerm = (Sochi$Pkd.dueDate()?long / 86400000)?round - (.now?long / 86400000)?round/>
Срок исполнения контрольного задания истекает через <#if daysBeforeTerm??>${daysBeforeTerm}<#else></#if> дней(-я) (срок <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string[""dd.MM.yyyy""]}<#else>не указан</#if>) <#if  document.get(""Module.Type.Alias"")==""Tasks"">Поручение<#else>Резолюция</#if>. от <#if document.get(""Author.Orig_ShortName"")??>${document.get(""Author.Orig_ShortName"")}<#else></#if> <#if  document.get(""Module.Type.Alias"")==""Tasks""><#else> по документу <#if document.get(""HierRoot.Type"")??>${document.get(""HierRoot.Type"")}<#else></#if></#if> от <#if document.get(""HierRoot.created_date"")??>${document.get(""HierRoot.created_date"")?date?string('dd.MM.yyyy')}<#else><#if document.get(""created_date"")??>${document.get(""created_date"")?date?string('dd.MM.yyyy')}<#else></#if></#if> № <#if document.get(""HierRoot.regnumber"")??>${document.get(""HierRoot.regnumber"")}<#else><#if document.get(""HierRoot.RegNumPrist"")??>${document.get(""HierRoot.RegNumPrist"")}<#else><#if document.get(""regNumPrist"")??>${document.get(""regNumPrist"")}<#else></#if></#if><#if document.get(""HierRoot.RegNumCnt"")??>${document.get(""HierRoot.RegNumCnt"")}<#else><#if document.get(""regNumCnt"")??>${document.get(""regNumCnt"")}<#else></#if></#if><#if document.get(""HierRoot.RegNumFin"")??>${document.get(""HierRoot.RegNumFin"")}<#else><#if document.get(""regNumFin"")??>${document.get(""regNumFin"")}<#else></#if></#if></#if>"]]></subject>
      <body-html lang="FreeMarker"><![CDATA[<head><style>p { font-family: Microsoft Sans Serif;font-size: 10pt;}</style></head>
<body><p>Для: <#list Sochi$Pkd.beardsTo() as beard> ${crudService.find(beard).getString(""orig_shortname"")}<#if beard_has_next >, <#else></#if></#list></p>
<p></p>
<p>Срок: <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string[""dd.MM.yyyy""]}<#else>не указан</#if></p>
<p></p>
<p>Автор: <#if document.get(""Author.Orig_ShortName"")??>${document.get(""Author.Orig_ShortName"")}<#else></#if></p>
<p></p>
<p>Контроллер:
<#assign formulaResContrl = ""select sb.orig_shortname
	from F_DP_ResltnBase_Cntrller rbc
	join F_DP_Resolution r on r.id = rbc.owner
	join so_beard sb on sb.id = rbc.controller
	where r.id = {0}"">
<#assign resContrl = session.findByQuery(formulaResContrl, document.getId())>
<#assign resContrlSize = resContrl.size()>
<#assign idx=0>
<#assign daysBeforeTerm = (Sochi$Pkd.dueDate()?long / 86400000)?round - (.now?long / 86400000)?round/>
<#if resContrl.size() != 0>
	<#list 0..resContrlSize - 1 as i>
		${resContrl.get(idx).getString(""orig_shortname"")}
		<#if i_has_next>,<#else></#if>
		<#assign idx= idx + 1>
	</#list>
<#else>
	<#if document.get(""HierRoot"")??><#else>
		<#if  document.get(""Module.Type.Alias"")==""Tasks"">
			<#assign formulaResTasks = ""select sb.orig_shortname
				from f_dp_rkkbase_controller rbc
				join f_dp_tasksresolution r on r.id = rbc.owner
				join so_beard sb on sb.id = rbc.controller
				where r.id = {0}"">
			<#assign resTasks = session.findByQuery(formulaResTasks, document.getId())>
			<#assign resTasksSize = resTasks.size()>
			<#if resTasks.size() != 0>
				<#list 0..resTasksSize - 1 as i>
					${resTasks.get(idx).getString(""orig_shortname"")}
					<#if i_has_next>,<#else></#if>
					<#assign idx= idx + 1>
				</#list>
			<#else>
			</#if>
		<#else>
		</#if>
	</#if>
</#if></p>
<p></p>
<p>Отв.исполнитель:
<#assign formulaExecContrl = ""SELECT execcurr_name.orig_shortname as executor FROM F_DP_Resolution res LEFT JOIN F_DP_ResltnBase_ExecResp executor ON executor.owner = res.id LEFT JOIN so_beard execcurr_name ON execcurr_name.id = executor.ExecutorResp WHERE res.id = {0}"">
<#assign execContrl = session.findByQuery(formulaExecContrl, document.getId())>
<#assign execContrlSize = execContrl.size()>
<#assign idx=0>
<#if execContrl.size() != 0>
	<#list 0..execContrlSize - 1 as i>
		${execContrl.get(idx).getString(""executor"")}
		<#if i_has_next>,<#else></#if>
		<#assign idx= idx + 1>
	</#list>
<#else>
	<#if document.get(""HierRoot"")??>
	<#else>
		<#if  document.get(""Module.Type.Alias"")==""Tasks"">
			<#assign formulaExecTasks = ""SELECT execcurr_name.orig_shortname as executor FROM F_DP_TasksResolution res LEFT JOIN F_DP_TasksResolution_ER executor ON executor.owner = res.id LEFT JOIN so_beard execcurr_name ON execcurr_name.id = executor.ExecutorResp WHERE res.id = {0}"">
			<#assign execTasks = session.findByQuery(formulaExecTasks, document.getId())>
			<#assign execTasksSize = execTasks.size()>
			<#if execTasks.size() != 0>
				<#list 0..execTasksSize - 1 as i>
					${execTasks.get(idx).getString(""executor"")}
					<#if i_has_next>,<#else></#if>
					<#assign idx= idx + 1>
				</#list>
			<#else>
			</#if>
		<#else>
		</#if>
	</#if>
</#if></p>
<p></p>
<p>Модуль: <#assign formula = ""SELECT name FROM ss_module sm left join f_dp_rkkbase fdr on fdr.module =sm.id left join ss_moduletype sm2 on sm2.id = sm.type WHERE fdr.id = {0}""> <#assign collection = session.findByQuery(formula, document.get(""HierRoot""))> ${collection.get(0).getString(""name"")}</p>
<p></p>
<p>Заголовок: <#if  document.get(""Module.Type.Alias"")==""Tasks"">Поручение<#else></#if> <#if document.get(""HierRoot.Type"")??>${document.get(""HierRoot.Type"")}<#else></#if> от <#if document.get(""HierRoot.created_date"")??>${document.get(""HierRoot.created_date"")?date?string('dd.MM.yyyy')}<#else><#if document.get(""created_date"")??>${document.get(""created_date"")?date?string('dd.MM.yyyy')}<#else></#if></#if> № <#if document.get(""HierRoot.regnumber"")??>${document.get(""HierRoot.regnumber"")}<#else><#if document.get(""HierRoot.RegNumPrist"")??>${document.get(""HierRoot.RegNumPrist"")}<#else><#if document.get(""regNumPrist"")??>${document.get(""regNumPrist"")}<#else></#if></#if><#if document.get(""HierRoot.RegNumCnt"")??>${document.get(""HierRoot.RegNumCnt"")}<#else><#if document.get(""regNumCnt"")??>${document.get(""regNumCnt"")}<#else></#if></#if><#if document.get(""HierRoot.RegNumFin"")??>${document.get(""HierRoot.RegNumFin"")}<#else><#if document.get(""regNumFin"")??>${document.get(""regNumFin"")}<#else></#if></#if></#if> <#if document.get(""Module.Type.Alias"")==""Tasks""><#else>«<#if document.get(""HierRoot.Subject"")??>${document.get(""HierRoot.Subject"")}<#else></#if>»</#if></p>
<p></p>
<p>Краткое содержание:  Срок исполнения контрольного задания истекает через <#if daysBeforeTerm??>${daysBeforeTerm}<#else></#if> дней(-я) </p>
<p></p>
<p><#if document.get(""Module.Type.Alias"")==""Tasks"">Поручение<#else>Резолюция</#if> : <#if document.get(""Resolution"")??>${document.get(""Resolution"")}<#else></#if></p>
<p></p>
<p>Открыть документ: <a href='${urlFormer.getUrl(""cm-sochi"", addressee.getId(), document.getId())}'>cсылка</a></p>
</body>]]></body-html>
    </inputbox-channel>
  </notification>
  <notification locale="RU" type="EXEC1_52">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[Истек срок исполнения <#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if><#if document.get("Module.Type.Alias")=="Tasks"> № <#if document.get("regnumber")??>${document.get("regnumber")}<#else><#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if></#if></#if> от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>( срок <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}<#elseif Sochi$Pkd.taskRemindTime()??>${Sochi$Pkd.taskRemindTime()?string["dd.MM.yyyy"]}<#elseif Sochi$Pkd.taskPlanDate()??>${Sochi$Pkd.taskPlanDate()?string["dd.MM.yyyy"]}</#if> )]]></subject>
      <body lang="FreeMarker"><![CDATA[От: Система

Для: <#list Sochi$Pkd.beardsTo() as beard>${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

<#if document.get("Module.Type.Alias")=="Tasks">Поручение № <#if document.get("regnumber")??>${document.get("regnumber")}<#else><#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if></#if> : <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if> от <#if document.get("date")??><#assign d2 = document.get("date")?index_of("-")><#assign d0 = document.get("date")?last_index_of("-")><#assign dy = document.get("date")?substring(0,d2)><#assign dd = document.get("date")?substring(d0+1)><#assign dm = document.get("date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>
<#else>ДОКУМЕНТ: <#if document.get("HierRoot")??><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>
<#else>№ <#if document.get("regnumber")??>${document.get("regnumber")}<#else><#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if></#if></#if>


Заголовок: <#if document.get("HierRoot")??><#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>
<#else><#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция: <#else>Поручение: </#if><#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if></#if>


СРОК: <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}<#elseif Sochi$Pkd.taskRemindTime()??>${Sochi$Pkd.taskRemindTime()?string["dd.MM.yyyy"]}<#elseif Sochi$Pkd.taskPlanDate()??>${Sochi$Pkd.taskPlanDate()?string["dd.MM.yyyy"]}</#if>

Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[Истек срок исполнения <#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if><#if document.get("Module.Type.Alias")=="Tasks"> № <#if document.get("regnumber")??>${document.get("regnumber")}<#else><#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if></#if></#if> от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if> ( срок <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}<#elseif Sochi$Pkd.taskRemindTime()??>${Sochi$Pkd.taskRemindTime()?string["dd.MM.yyyy"]}<#elseif Sochi$Pkd.taskPlanDate()??>${Sochi$Pkd.taskPlanDate()?string["dd.MM.yyyy"]}</#if> )]]></subject>
      <body lang="FreeMarker"><![CDATA[От: Система

Для: <#list Sochi$Pkd.beardsTo() as beard>${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

<#if document.get("Module.Type.Alias")=="Tasks">Поручение № <#if document.get("regnumber")??>${document.get("regnumber")}<#else><#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if></#if> : <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if> от <#if document.get("date")??><#assign d2 = document.get("date")?index_of("-")><#assign d0 = document.get("date")?last_index_of("-")><#assign dy = document.get("date")?substring(0,d2)><#assign dd = document.get("date")?substring(d0+1)><#assign dm = document.get("date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>
<#else>ДОКУМЕНТ: <#if document.get("HierRoot")??><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>
<#else>№ <#if document.get("regnumber")??>${document.get("regnumber")}<#else><#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if></#if></#if>


Заголовок: <#if document.get("HierRoot")??><#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>
<#else><#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция: <#else>Поручение: </#if> <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if></#if>


СРОК: <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}<#elseif Sochi$Pkd.taskRemindTime()??>${Sochi$Pkd.taskRemindTime()?string["dd.MM.yyyy"]}<#elseif Sochi$Pkd.taskPlanDate()??>${Sochi$Pkd.taskPlanDate()?string["dd.MM.yyyy"]}</#if>

Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </inputbox-channel>
  </notification>
  <notification locale="RU" type="EXEC1_54">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[Перенесен срок исполнения <#if document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if><#if document.get("Module.Type.Alias")=="Tasks"> № <#if document.get("regnumber")??>${document.get("regnumber")}<#else><#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if></#if></#if> от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if> (срок <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}</#if>)]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>


Для: ${cmjNotice.readStringField("To_WP")}

Краткое содержание:

<#if document.get("Module.Type.Alias")=="Tasks">Поручение № <#if document.get("regnumber")??>${document.get("regnumber")}<#else><#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if></#if> : </#if><#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if> от <#if document.get("date")??><#assign d2 = document.get("date")?index_of("-")><#assign d0 = document.get("date")?last_index_of("-")><#assign dy = document.get("date")?substring(0,d2)><#assign dd = document.get("date")?substring(d0+1)><#assign dm = document.get("date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>
<#else>ДОКУМЕНТ: <#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)> <#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if></#if>


СРОК: <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}</#if>

Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[Перенесен срок исполнения <#if document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if><#if document.get("Module.Type.Alias")=="Tasks"> № <#if document.get("regnumber")??>${document.get("regnumber")}<#else><#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if></#if></#if> от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if> (срок <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}</#if>)]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>


Для: ${cmjNotice.readStringField("To_WP")}

Краткое содержание:

<#if document.get("Module.Type.Alias")=="Tasks">Поручение № <#if document.get("regnumber")??>${document.get("regnumber")}<#else><#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if></#if> : </#if><#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if> от <#if document.get("date")??><#assign d2 = document.get("date")?index_of("-")><#assign d0 = document.get("date")?last_index_of("-")><#assign dy = document.get("date")?substring(0,d2)><#assign dd = document.get("date")?substring(d0+1)><#assign dm = document.get("date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>
<#else>ДОКУМЕНТ: <#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)> <#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if></#if>


СРОК: <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}</#if>

Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </inputbox-channel>
  </notification>
  <notification locale="RU" type="NotificationByChangeDeadlineExecResp">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[Перенесен срок исполнения <#if document.get("HierParent.Module.Type.Alias")=="InputDocs" ||document.get("HierParent.Module.Type.Alias")=="InternalDocs" || document.get("HierParent.Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if><#if document.get("HierParent.Module.Type.Alias")=="Tasks"> № <#if document.get("HierParent.regnumber")??>${document.get("HierParent.regnumber")}<#else><#if document.get("HierParent.regnumprist")??>${document.get("HierParent.regnumprist")}<#else></#if><#if document.get("HierParent.regnumcnt")??>${document.get("HierParent.regnumcnt")}<#else></#if><#if document.get("HierParent.regnumfin")??>${document.get("HierParent.regnumfin")}<#else></#if></#if></#if> от <#if document.get("HierParent.Author.Orig_ShortName")??>${document.get("HierParent.Author.Orig_ShortName")}<#else></#if> (срок <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}</#if>)]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if Sochi$Pkd.nameFrom()??> ${Sochi$Pkd.nameFrom()}<#else><#if Sochi$Pkd.beardFrom()??>${crudService.find(Sochi$Pkd.beardFrom()).getString("orig_shortname")}<#else></#if></#if>


Для: <#list Sochi$Pkd.beardsTo() as beard> ${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

<#if  document.get("HierParent.Module.Type.Alias")=="Tasks">Поручение № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> <#if document.get("HierParent.Resolution")??>${document.get("HierParent.Resolution")}<#else></#if> от <#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else>ДОКУМЕНТ: <#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("HierParent.Module.Type.Alias")=="InputDocs" || document.get("HierParent.Module.Type.Alias")=="InternalDocs" || document.get("HierParent.Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("HierParent.Resolution")??>${document.get("HierParent.Resolution")}<#else></#if></#if>


СРОК: <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}</#if>

Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.get("HierParent"))}]]></body>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[Перенесен срок исполнения <#if document.get("HierParent.Module.Type.Alias")=="InputDocs" ||document.get("HierParent.Module.Type.Alias")=="InternalDocs" || document.get("HierParent.Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if><#if document.get("HierParent.Module.Type.Alias")=="Tasks"> № <#if document.get("HierParent.regnumber")??>${document.get("HierParent.regnumber")}<#else><#if document.get("HierParent.regnumprist")??>${document.get("HierParent.regnumprist")}<#else></#if><#if document.get("HierParent.regnumcnt")??>${document.get("HierParent.regnumcnt")}<#else></#if><#if document.get("HierParent.regnumfin")??>${document.get("HierParent.regnumfin")}<#else></#if></#if></#if> от <#if document.get("HierParent.Author.Orig_ShortName")??>${document.get("HierParent.Author.Orig_ShortName")}<#else></#if> (срок <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}</#if>)]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if Sochi$Pkd.nameFrom()??> ${Sochi$Pkd.nameFrom()}<#else><#if Sochi$Pkd.beardFrom()??>${crudService.find(Sochi$Pkd.beardFrom()).getString("orig_shortname")}<#else></#if></#if>


Для: <#list Sochi$Pkd.beardsTo() as beard> ${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

<#if  document.get("HierParent.Module.Type.Alias")=="Tasks">Поручение № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> <#if document.get("HierParent.Resolution")??>${document.get("HierParent.Resolution")}<#else></#if> от <#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else>ДОКУМЕНТ: <#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("HierParent.Module.Type.Alias")=="InputDocs" || document.get("HierParent.Module.Type.Alias")=="InternalDocs" || document.get("HierParent.Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("HierParent.Resolution")??>${document.get("HierParent.Resolution")}<#else></#if></#if>


СРОК: <#if Sochi$Pkd.dueDate()??>${Sochi$Pkd.dueDate()?string["dd.MM.yyyy"]}</#if>

Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.get("HierParent"))}]]></body>
    </inputbox-channel>
  </notification>
  <notification locale="RU" type="EXEC1_56">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[Приближается срок исполнения по документу <#if document.get("Type")??>${document.get("Type")}<#else></#if> № <#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if> <#if document.get("Subject")??>${document.get("Subject")}<#else></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: Система

Для: <#list Sochi$Pkd.beardsTo() as beard>${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

ДОКУМЕНТ: <#if document.get("Type")??>${document.get("Type")}<#else></#if> № <#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if> от <#if document.get("regdate")??><#assign d2 = document.get("regdate")?index_of("-")> <#assign d0 = document.get("regdate")?last_index_of("-")><#assign dy = document.get("regdate")?substring(0,d2)><#assign dd = document.get("regdate")?substring(d0+1)><#assign dm = document.get("regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Заголовок: <#if document.get("Subject")??>${document.get("Subject")}<#else></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[Приближается срок исполнения по документу <#if document.get("Type")??>${document.get("Type")}<#else></#if> № <#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if> <#if document.get("Subject")??>${document.get("Subject")}<#else></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: Система

Для: <#list Sochi$Pkd.beardsTo() as beard>${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

ДОКУМЕНТ: <#if document.get("Type")??>${document.get("Type")}<#else></#if> № <#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if> от <#if document.get("regdate")??><#assign d2 = document.get("regdate")?index_of("-")> <#assign d0 = document.get("regdate")?last_index_of("-")><#assign dy = document.get("regdate")?substring(0,d2)><#assign dd = document.get("regdate")?substring(d0+1)><#assign dm = document.get("regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Заголовок: <#if document.get("Subject")??>${document.get("Subject")}<#else></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </inputbox-channel>
  </notification>
  <notification locale="RU" type="EXEC1_57">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[Наступил срок исполнения по документу <#if document.get("Type")??>${document.get("Type")}<#else></#if> № <#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if> <#if document.get("Subject")??>${document.get("Subject")}<#else></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: Система

Для: <#list Sochi$Pkd.beardsTo() as beard>${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

ДОКУМЕНТ: <#if document.get("Type")??>${document.get("Type")}<#else></#if> № <#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if> от <#if document.get("regdate")??><#assign d2 = document.get("regdate")?index_of("-")> <#assign d0 = document.get("regdate")?last_index_of("-")><#assign dy = document.get("regdate")?substring(0,d2)><#assign dd = document.get("regdate")?substring(d0+1)><#assign dm = document.get("regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Заголовок: <#if document.get("Subject")??>${document.get("Subject")}<#else></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[Наступил срок исполнения по документу <#if document.get("Type")??>${document.get("Type")}<#else></#if> № <#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if> <#if document.get("Subject")??>${document.get("Subject")}<#else></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: Система

Для: <#list Sochi$Pkd.beardsTo() as beard>${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

ДОКУМЕНТ: <#if document.get("Type")??>${document.get("Type")}<#else></#if> № <#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if> от <#if document.get("regdate")??><#assign d2 = document.get("regdate")?index_of("-")> <#assign d0 = document.get("regdate")?last_index_of("-")><#assign dy = document.get("regdate")?substring(0,d2)><#assign dd = document.get("regdate")?substring(d0+1)><#assign dm = document.get("regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Заголовок: <#if document.get("Subject")??>${document.get("Subject")}<#else></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </inputbox-channel>
  </notification>

  <!-- Перенесен срок исполнения -->
  <notification locale="RU" type="NotificationByChangeDeadlineResolution2">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[Перенесен срок исполнения.<#if document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if> (срок <#if document.get("ctrldeadline")??><#assign d2 = document.get("ctrldeadline")?index_of("-")> <#assign d0 = document.get("ctrldeadline")?last_index_of("-")> <#assign dy = document.get("ctrldeadline")?substring(0,d2)> <#assign dd = document.get("ctrldeadline")?substring(d0+1)> <#assign dm = document.get("ctrldeadline")?substring(d2+1,d0)> <#assign ddl = dd?length> <#assign dml = dm?length> <#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if> )]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>


Для:<#list Sochi$Pkd.beardsTo() as beard> ${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >,<#else> </#if></#list>

Краткое содержание:

ДОКУМЕНТ: <#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")> <#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")> <#assign dy = document.get("HierRoot.regdate")?substring(0,d2)> <#assign dd = document.get("HierRoot.regdate")?substring(d0+1)> <#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)> <#assign ddl = dd?length> <#assign dml = dm?length> <#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if>


СРОК: <#if document.get("ctrldeadline")??><#assign d2 = document.get("ctrldeadline")?index_of("-")> <#assign d0 = document.get("ctrldeadline")?last_index_of("-")> <#assign dy = document.get("ctrldeadline")?substring(0,d2)> <#assign dd = document.get("ctrldeadline")?substring(d0+1)> <#assign dm = document.get("ctrldeadline")?substring(d2+1,d0)> <#assign ddl = dd?length> <#assign dml = dm?length> <#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[Перенесен срок исполнения.<#if document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if> (срок <#if document.get("ctrldeadline")??><#assign d2 = document.get("ctrldeadline")?index_of("-")> <#assign d0 = document.get("ctrldeadline")?last_index_of("-")> <#assign dy = document.get("ctrldeadline")?substring(0,d2)> <#assign dd = document.get("ctrldeadline")?substring(d0+1)> <#assign dm = document.get("ctrldeadline")?substring(d2+1,d0)> <#assign ddl = dd?length> <#assign dml = dm?length> <#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if> )]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>


Для:<#list Sochi$Pkd.beardsTo() as beard> ${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >,<#else> </#if></#list>

Краткое содержание:

ДОКУМЕНТ: <#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")> <#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")> <#assign dy = document.get("HierRoot.regdate")?substring(0,d2)> <#assign dd = document.get("HierRoot.regdate")?substring(d0+1)> <#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)> <#assign ddl = dd?length> <#assign dml = dm?length> <#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if>


СРОК: <#if document.get("ctrldeadline")??><#assign d2 = document.get("ctrldeadline")?index_of("-")> <#assign d0 = document.get("ctrldeadline")?last_index_of("-")> <#assign dy = document.get("ctrldeadline")?substring(0,d2)> <#assign dd = document.get("ctrldeadline")?substring(d0+1)> <#assign dm = document.get("ctrldeadline")?substring(d2+1,d0)> <#assign ddl = dd?length> <#assign dml = dm?length> <#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </inputbox-channel>
  </notification>

  <!-- Назначение контролером -->
  <notification locale="RU" type="NotificationByControlResolution2">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[Вы назначены контролером по <#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюции<#else>Поручению</#if> от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if> (срок <#if document.get("ctrldeadline")??><#assign d2 = document.get("ctrldeadline")?index_of("-")><#assign d0 = document.get("ctrldeadline")?last_index_of("-")><#assign dy = document.get("ctrldeadline")?substring(0,d2)><#assign dd = document.get("ctrldeadline")?substring(d0+1)><#assign dm = document.get("ctrldeadline")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>)]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>

Для: <#list Sochi$Pkd.beardsTo() as beard>${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

ДОКУМЕНТ: <#if document.get("Type")??>${document.get("Type")}<#else></#if> № <#if document.get("RegNumPrist")??>${document.get("RegNumPrist")}<#else></#if><#if document.get("RegNumCnt")??>${document.get("RegNumCnt")}<#else></#if><#if document.get("RegNumFin")??>${document.get("RegNumFin")}<#else></#if> от <#if document.get("date")??><#assign d2 = document.get("date")?index_of("-")><#assign d0 = document.get("date")?last_index_of("-")><#assign dy = document.get("date")?substring(0,d2)><#assign dd = document.get("date")?substring(d0+1)><#assign dm = document.get("date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if>


Срок: <#if document.get("ctrldeadline")??><#assign d2 = document.get("ctrldeadline")?index_of("-")><#assign d0 = document.get("ctrldeadline")?last_index_of("-")><#assign dy = document.get("ctrldeadline")?substring(0,d2)><#assign dd = document.get("ctrldeadline")?substring(d0+1)><#assign dm = document.get("ctrldeadline")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[Вы назначены контролером по <#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюции<#else>Поручению</#if> от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if> (срок <#if document.get("ctrldeadline")??><#assign d2 = document.get("ctrldeadline")?index_of("-")><#assign d0 = document.get("ctrldeadline")?last_index_of("-")><#assign dy = document.get("ctrldeadline")?substring(0,d2)><#assign dd = document.get("ctrldeadline")?substring(d0+1)><#assign dm = document.get("ctrldeadline")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>)]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>


Для: <#list Sochi$Pkd.beardsTo() as beard>${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

ДОКУМЕНТ: <#if document.get("Type")??>${document.get("Type")}<#else></#if> № <#if document.get("RegNumPrist")??>${document.get("RegNumPrist")}<#else></#if><#if document.get("RegNumCnt")??>${document.get("RegNumCnt")}<#else></#if><#if document.get("RegNumFin")??>${document.get("RegNumFin")}<#else></#if> от <#if document.get("regdate")??><#assign d2 = document.get("date")?index_of("-")><#assign d0 = document.get("date")?last_index_of("-")><#assign dy = document.get("date")?substring(0,d2)><#assign dd = document.get("date")?substring(d0+1)><#assign dm = document.get("date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if>


Срок: <#if document.get("ctrldeadline")??><#assign d2 = document.get("ctrldeadline")?index_of("-")> <#assign d0 = document.get("ctrldeadline")?last_index_of("-")><#assign dy = document.get("ctrldeadline")?substring(0,d2)><#assign dd = document.get("ctrldeadline")?substring(d0+1)><#assign dm = document.get("ctrldeadline")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </inputbox-channel>
  </notification>

  <!-- Отчет об исполнении -->
  <notification locale="RU" type="NotificationByCtrlAddressingExecution">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[Отчет об исполнении от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if> по <#if document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюции <#else>поручению </#if>по документу <#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if	document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>


Для: <#list Sochi$Pkd.beardsTo() as beard>${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

ДОКУМЕНТ: <#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от<#if document.get("HierRoot.regDate")??><#assign d2 = document.get("HierRoot.regDate")?index_of("-")> <#assign d0 = document.get("HierRoot.regDate")?last_index_of("-")> <#assign dy = document.get("HierRoot.regDate")?substring(0,d2)> <#assign dd = document.get("HierRoot.regDate")?substring(d0+1)> <#assign dm = document.get("HierRoot.regDate")?substring(d2+1,d0)> <#assign ddl = dd?length> <#assign dml = dm?length> <#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("HierParent.Resolution")??>${document.get("HierParent.Resolution")}<#else></#if>


СРОК: <#if document.get("Hierparent.ctrldeadline")??><#assign d2 = document.get("Hierparent.ctrldeadline")?index_of("-")><#assign d0 = document.get("Hierparent.ctrldeadline")?last_index_of("-")><#assign dy = document.get("Hierparent.ctrldeadline")?substring(0,d2)><#assign dd = document.get("Hierparent.ctrldeadline")?substring(d0+1)><#assign dm = document.get("Hierparent.ctrldeadline")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Исп.: <#if document.get("Text")??>${document.get("Text")}<#else></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[Отчет об исполнении от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if> по <#if document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюции <#else>поручению </#if>по документу <#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if	document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>


Для: <#list Sochi$Pkd.beardsTo() as beard>${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

ДОКУМЕНТ: <#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от<#if document.get("HierRoot.regDate")??><#assign d2 = document.get("HierRoot.regDate")?index_of("-")> <#assign d0 = document.get("HierRoot.regDate")?last_index_of("-")> <#assign dy = document.get("HierRoot.regDate")?substring(0,d2)> <#assign dd = document.get("HierRoot.regDate")?substring(d0+1)> <#assign dm = document.get("HierRoot.regDate")?substring(d2+1,d0)> <#assign ddl = dd?length> <#assign dml = dm?length> <#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("HierParent.Resolution")??>${document.get("HierParent.Resolution")}<#else></#if>


СРОК: <#if document.get("Hierparent.ctrldeadline")??><#assign d2 = document.get("Hierparent.ctrldeadline")?index_of("-")><#assign d0 = document.get("Hierparent.ctrldeadline")?last_index_of("-")><#assign dy = document.get("Hierparent.ctrldeadline")?substring(0,d2)><#assign dd = document.get("Hierparent.ctrldeadline")?substring(d0+1)><#assign dm = document.get("Hierparent.ctrldeadline")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Исп.: <#if document.get("Text")??>${document.get("Text")}<#else></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </inputbox-channel>
  </notification>
  <notification locale="RU" type="NotificationByCtrlAddressingExecutionForRespExec">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[Отчет об исполнении от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if> по <#if document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюции <#else>поручению </#if>по документу <#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if	document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>


Для: <#list Sochi$Pkd.beardsTo() as beard>${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

ДОКУМЕНТ: <#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от<#if document.get("HierRoot.regDate")??><#assign d2 = document.get("HierRoot.regDate")?index_of("-")> <#assign d0 = document.get("HierRoot.regDate")?last_index_of("-")> <#assign dy = document.get("HierRoot.regDate")?substring(0,d2)> <#assign dd = document.get("HierRoot.regDate")?substring(d0+1)> <#assign dm = document.get("HierRoot.regDate")?substring(d2+1,d0)> <#assign ddl = dd?length> <#assign dml = dm?length> <#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("HierParent.Resolution")??>${document.get("HierParent.Resolution")}<#else></#if>


СРОК: <#if document.get("Hierparent.ctrldeadline")??><#assign d2 = document.get("Hierparent.ctrldeadline")?index_of("-")><#assign d0 = document.get("Hierparent.ctrldeadline")?last_index_of("-")><#assign dy = document.get("Hierparent.ctrldeadline")?substring(0,d2)><#assign dd = document.get("Hierparent.ctrldeadline")?substring(d0+1)><#assign dm = document.get("Hierparent.ctrldeadline")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Исп.: <#if document.get("Text")??>${document.get("Text")}<#else></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[Отчет об исполнении от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if> по <#if document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюции <#else>поручению </#if>по документу <#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if	document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>


Для: <#list Sochi$Pkd.beardsTo() as beard>${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

ДОКУМЕНТ: <#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от<#if document.get("HierRoot.regDate")??><#assign d2 = document.get("HierRoot.regDate")?index_of("-")> <#assign d0 = document.get("HierRoot.regDate")?last_index_of("-")> <#assign dy = document.get("HierRoot.regDate")?substring(0,d2)> <#assign dd = document.get("HierRoot.regDate")?substring(d0+1)> <#assign dm = document.get("HierRoot.regDate")?substring(d2+1,d0)> <#assign ddl = dd?length> <#assign dml = dm?length> <#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("HierParent.Resolution")??>${document.get("HierParent.Resolution")}<#else></#if>


СРОК: <#if document.get("Hierparent.ctrldeadline")??><#assign d2 = document.get("Hierparent.ctrldeadline")?index_of("-")><#assign d0 = document.get("Hierparent.ctrldeadline")?last_index_of("-")><#assign dy = document.get("Hierparent.ctrldeadline")?substring(0,d2)><#assign dd = document.get("Hierparent.ctrldeadline")?substring(d0+1)><#assign dm = document.get("Hierparent.ctrldeadline")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Исп.: <#if document.get("Text")??>${document.get("Text")}<#else></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </inputbox-channel>
  </notification>
  <notification locale="RU" type="NotificationByApprovedExecution">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[Принят отчет по <#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюции<#else>Поручению</#if><#if  document.get("Module.Type.Alias")=="Tasks"> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if><#else></#if> от <#if document.get("HierParent.Author.Orig_ShortName")??>${document.get("HierParent.Author.Orig_ShortName")}<#else></#if><#if  document.get("Module.Type.Alias")=="Tasks"><#else> по документу <#if document.get("Module.Title")??>${document.get("Module.Title")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if Sochi$Pkd.nameFrom()??> ${Sochi$Pkd.nameFrom()}<#else><#if Sochi$Pkd.beardFrom()??>${crudService.find(Sochi$Pkd.beardFrom()).getString("orig_shortname")}<#else></#if></#if>


Для: <#list Sochi$Pkd.beardsTo() as beard>${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

<#if  document.get("Module.Type.Alias")=="Tasks">Поручение № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> <#if document.get("HierParent.Resolution")??>${document.get("HierParent.Resolution")}<#else></#if> от <#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else>ДОКУМЕНТ: <#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("HierParent.Resolution")??>${document.get("HierParent.Resolution")}<#else></#if></#if>


СРОК: <#if document.get("HierParent.ctrldeadline")??><#assign d2 = document.get("HierParent.ctrldeadline")?index_of("-")><#assign d0 = document.get("HierParent.ctrldeadline")?last_index_of("-")><#assign dy = document.get("HierParent.ctrldeadline")?substring(0,d2)><#assign dd = document.get("HierParent.ctrldeadline")?substring(d0+1)><#assign dm = document.get("HierParent.ctrldeadline")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Исп.: ${document.get("Text")}

Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[Принят отчет по <#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюции<#else>Поручению</#if><#if  document.get("Module.Type.Alias")=="Tasks"> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if><#else></#if> от <#if document.get("HierParent.Author.Orig_ShortName")??>${document.get("HierParent.Author.Orig_ShortName")}<#else></#if><#if  document.get("Module.Type.Alias")=="Tasks"><#else> по документу <#if document.get("Module.Title")??>${document.get("Module.Title")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if Sochi$Pkd.nameFrom()??> ${Sochi$Pkd.nameFrom()}<#else><#if Sochi$Pkd.beardFrom()??>${crudService.find(Sochi$Pkd.beardFrom()).getString("orig_shortname")}<#else></#if></#if>


Для: <#list Sochi$Pkd.beardsTo() as beard>${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

<#if  document.get("Module.Type.Alias")=="Tasks">Поручение № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> <#if document.get("HierParent.Resolution")??>${document.get("HierParent.Resolution")}<#else></#if> от <#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else>ДОКУМЕНТ: <#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("HierParent.Resolution")??>${document.get("HierParent.Resolution")}<#else></#if></#if>


СРОК: <#if document.get("HierParent.ctrldeadline")??><#assign d2 = document.get("HierParent.ctrldeadline")?index_of("-")><#assign d0 = document.get("HierParent.ctrldeadline")?last_index_of("-")><#assign dy = document.get("HierParent.ctrldeadline")?substring(0,d2)><#assign dd = document.get("HierParent.ctrldeadline")?substring(d0+1)><#assign dm = document.get("HierParent.ctrldeadline")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Исп.: ${document.get("Text")}

Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </inputbox-channel>
  </notification>
  <notification locale="RU" type="NotificationByRejectExecution">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[Отказ приема отчета по <#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">резолюции<#else>поручению</#if><#if  document.get("Module.Type.Alias")=="Tasks"> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if><#else></#if> от <#if document.get("HierParent.Author.Orig_ShortName")??>${document.get("HierParent.Author.Orig_ShortName")}<#else></#if><#if  document.get("Module.Type.Alias")=="Tasks"><#else> по документу <#if document.get("HierRoot.Form")=="AddAgr">Дополнительное соглашение<#else><#if document.get("Module.Title")??>${document.get("Module.Title")}<#else></#if></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if Sochi$Pkd.nameFrom()??>${Sochi$Pkd.nameFrom()}<#else><#if Sochi$Pkd.beardFrom()??>${crudService.find(Sochi$Pkd.beardFrom()).getString("orig_shortname")}<#else></#if></#if>


Для: <#list Sochi$Pkd.beardsTo() as beard>${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

<#if  document.get("Module.Type.Alias")=="Tasks">Поручение № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> <#if document.get("HierParent.Resolution")??>${document.get("HierParent.Resolution")}<#else></#if> от <#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else>ДОКУМЕНТ: <#if document.get("HierRoot.Form")=="AddAgr">Доп. соглашение<#else><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция <#else>Поручение</#if>: <#if document.get("HierParent.Resolution")??>${document.get("HierParent.Resolution")}<#else></#if></#if>


СРОК: <#if document.get("HierParent.ctrldeadline")??><#assign d2 = document.get("HierParent.ctrldeadline")?index_of("-")><#assign d0 = document.get("HierParent.ctrldeadline")?last_index_of("-")><#assign dy = document.get("HierParent.ctrldeadline")?substring(0,d2)><#assign dd = document.get("HierParent.ctrldeadline")?substring(d0+1)><#assign dm = document.get("HierParent.ctrldeadline")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Исп.: ${document.get("Text")}

Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[Отказ приема отчета по <#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">резолюции<#else>поручению</#if><#if  document.get("Module.Type.Alias")=="Tasks"> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if><#else></#if> от <#if document.get("HierParent.Author.Orig_ShortName")??>${document.get("HierParent.Author.Orig_ShortName")}<#else></#if><#if  document.get("Module.Type.Alias")=="Tasks"><#else> по документу <#if document.get("HierRoot.Form")=="AddAgr">Дополнительное соглашение<#else><#if document.get("Module.Title")??>${document.get("Module.Title")}<#else></#if></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if Sochi$Pkd.nameFrom()??>${Sochi$Pkd.nameFrom()}<#else><#if Sochi$Pkd.beardFrom()??>${crudService.find(Sochi$Pkd.beardFrom()).getString("orig_shortname")}<#else></#if></#if>


Для: <#list Sochi$Pkd.beardsTo() as beard>${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

<#if  document.get("Module.Type.Alias")=="Tasks">Поручение № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> <#if document.get("HierParent.Resolution")??>${document.get("HierParent.Resolution")}<#else></#if> от <#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else>ДОКУМЕНТ: <#if document.get("HierRoot.Form")=="AddAgr">Доп. соглашение<#else><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if></#if> № <#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция <#else>Поручение</#if>: <#if document.get("HierParent.Resolution")??>${document.get("HierParent.Resolution")}<#else></#if></#if>


СРОК: <#if document.get("HierParent.ctrldeadline")??><#assign d2 = document.get("HierParent.ctrldeadline")?index_of("-")><#assign d0 = document.get("HierParent.ctrldeadline")?last_index_of("-")><#assign dy = document.get("HierParent.ctrldeadline")?substring(0,d2)><#assign dd = document.get("HierParent.ctrldeadline")?substring(d0+1)><#assign dm = document.get("HierParent.ctrldeadline")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Исп.: ${document.get("Text")}

Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </inputbox-channel>
  </notification>
  <notification locale="RU" type="EXEC3_41">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[Принят отчет по <#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюции<#else>Поручению</#if> от <#if document.get("HierParent.Author.Orig_ShortName")??>${document.get("HierParent.Author.Orig_ShortName")}<#else></#if><#if  document.get("Module.Type.Alias")=="Tasks"><#else> по документу <#if document.get("Module.Title")??>${document.get("Module.Title")}<#else></#if> №<#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if Sochi$Pkd.nameFrom()??> ${Sochi$Pkd.nameFrom()}<#else><#if Sochi$Pkd.beardFrom()??>${crudService.find(Sochi$Pkd.beardFrom()).getString("orig_shortname")}<#else></#if></#if>


Для: <#list Sochi$Pkd.beardsTo() as beard>${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

<#if  document.get("Module.Type.Alias")=="Tasks">Поручение № <#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if> от <#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Поручение: <#if document.get("HierParent.Resolution")??>${document.get("HierParent.Resolution")}<#else></#if><#else>ДОКУМЕНТ: <#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("HierParent.Resolution")??>${document.get("HierParent.Resolution")}<#else></#if></#if>


СРОК: <#if document.get("HierParent.ctrldeadline")??><#assign d2 = document.get("HierParent.ctrldeadline")?index_of("-")><#assign d0 = document.get("HierParent.ctrldeadline")?last_index_of("-")><#assign dy = document.get("HierParent.ctrldeadline")?substring(0,d2)><#assign dd = document.get("HierParent.ctrldeadline")?substring(d0+1)><#assign dm = document.get("HierParent.ctrldeadline")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Исп.: ${document.get("Text")}

Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[Принят отчет по <#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюции<#else>Поручению</#if> от <#if document.get("HierParent.Author.Orig_ShortName")??>${document.get("HierParent.Author.Orig_ShortName")}<#else></#if><#if  document.get("Module.Type.Alias")=="Tasks"><#else> по документу <#if document.get("Module.Title")??>${document.get("Module.Title")}<#else></#if> №<#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if Sochi$Pkd.nameFrom()??> ${Sochi$Pkd.nameFrom()}<#else><#if Sochi$Pkd.beardFrom()??>${crudService.find(Sochi$Pkd.beardFrom()).getString("orig_shortname")}<#else></#if></#if>


Для: <#list Sochi$Pkd.beardsTo() as beard>${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

<#if  document.get("Module.Type.Alias")=="Tasks">Поручение № <#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if> от <#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Поручение: <#if document.get("HierParent.Resolution")??>${document.get("HierParent.Resolution")}<#else></#if><#else>ДОКУМЕНТ: <#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if> от <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("HierParent.Resolution")??>${document.get("HierParent.Resolution")}<#else></#if></#if>


СРОК: <#if document.get("HierParent.ctrldeadline")??><#assign d2 = document.get("HierParent.ctrldeadline")?index_of("-")><#assign d0 = document.get("HierParent.ctrldeadline")?last_index_of("-")><#assign dy = document.get("HierParent.ctrldeadline")?substring(0,d2)><#assign dd = document.get("HierParent.ctrldeadline")?substring(d0+1)><#assign dm = document.get("HierParent.ctrldeadline")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Исп.: ${document.get("Text")}

Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </inputbox-channel>
  </notification>

  <!-- Возращено на доработку -->
  <notification locale="RU" type="NotificationByResolutionRejection">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция возвращена на доработку<#else>Поручение возвращено на доработку</#if> от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>

Для: ${cmjNotice.readStringField("To_WP")}

Краткое содержание:

ДОКУМЕНТ: <#if document.get("Type")??>${document.get("Type")}<#else></#if> № <#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if> от  <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")> <#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")> <#assign dy = document.get("HierRoot.regdate")?substring(0,d2)> <#assign dd = document.get("HierRoot.regdate")?substring(d0+1)> <#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)> <#assign ddl = dd?length> <#assign dml = dm?length> <#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>

Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>

<#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция возвращена на доработку<#else>Поручение возвращено на доработку</#if> от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>

Для: ${cmjNotice.readStringField("To_WP")}

Краткое содержание:

ДОКУМЕНТ: <#if document.get("Type")??>${document.get("Type")}<#else></#if> № <#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if> от  <#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")> <#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")> <#assign dy = document.get("HierRoot.regdate")?substring(0,d2)> <#assign dd = document.get("HierRoot.regdate")?substring(d0+1)> <#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)> <#assign ddl = dd?length> <#assign dml = dm?length> <#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>

Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>

<#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </inputbox-channel>
  </notification>

  <!-- Периодические резолюции -->
  <notification locale="RU" type="PERR1_21">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[Завершено создание периодических <#assign moduleType = document.get("Module.Type.Alias")><#assign isResolution = moduleType=="InputDocs" || moduleType=="InternalDocs" || moduleType=="Requests"><#assign isContract = moduleType=="ContractsLite"><#assign isInput = moduleType=="InputDocs"><#assign resolutionAuthor = document.get("Author.orig_shortname")><#if isResolution>резолюций<#else>поручений</#if> от ${resolutionAuthor} (срок <#if document.get("ctrldeadline")??><#assign ctrldeadline = document.get("ctrldeadline")><#assign day = ctrldeadline.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = ctrldeadline.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = ctrldeadline.getYear()?c><#assign resultСtrldeadline = resultDay + "." + resultMonth + "." + resultYear>${resultСtrldeadline}<#else>не указан</#if>)<#if moduleType=="Tasks"> от <#assign resolutionDate = document.get("date")><#if resolutionDate??><#assign day = resolutionDate.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = resolutionDate.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = resolutionDate.getYear()?c><#assign resultResolutionDate = resultDay + "." + resultMonth + "." + resultYear>${resultResolutionDate}<#else></#if><#else> по документу <#if isContract><#assign dogForm = document.get("HierRoot.Form")><#if dogForm??><#if dogForm=="Dog">Договор<#else></#if><#if dogForm=="AddAgr">Доп. соглашение<#else></#if><#if dogForm=="DocDogovor">Документ к договору<#else></#if><#if dogForm=="Finance">Финансовый документ<#else></#if><#else></#if><#else><#if document.get("HierRoot.Type")??><#assign type = document.get("HierRoot.Type")><#if (document.get("HierRoot.medogatestate")?? && (document.get("HierRoot.medogatestate")==2 || document.get("HierRoot.medogatestate")==3))><#assign colon = type?index_of(":")><#if colon == -1>${type}<#else>${type?substring(0, colon)}</#if><#else>${type}</#if><#else></#if></#if><#if document.get("HierRoot.regdate")??><#assign regDate = document.get("HierRoot.regdate")><#assign day = regDate.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = regDate.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = regDate.getYear()?c><#assign resultRegDate = resultDay + "." + resultMonth + "." + resultYear> от ${resultRegDate}<#else></#if></#if> № <#if document.get("HierRoot")??><#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if></#if><#else><#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if></#if>]]></subject>
      <body-html lang="FreeMarker"><![CDATA[<#assign moduleType = document.get("Module.Type.Alias")><#assign isResolution = moduleType=="InputDocs" || moduleType=="InternalDocs" || moduleType=="Requests"><#assign resolutionAuthor = document.get("Author.orig_shortname")>
<head><style>p { font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 10pt;}</style></head>
<body><p><#if isResolution>Резолюция<#else>Поручение</#if>: ${document.get("Resolution")}</p>
<p>От: Система</p>
<p>Для:<#list Sochi$Pkd.beardsTo() as beard> ${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list></p>
<p>Контролер: <#if document.get("HierRoot")??><#assign formula = "SELECT contrl_name.orig_shortname as controller FROM F_DP_Resolution res LEFT JOIN F_DP_ResltnBase_Cntrller contrl ON contrl.owner = res.id LEFT JOIN so_beard contrl_name ON contrl_name.id = contrl.Controller WHERE res.id = {0}"><#assign collection = session.findByQuery(formula, document.getId())><#list collection.stream().toArray() as beard><#if collection.get(0).getString("controller")??>${beard.getString("controller")}<#if beard_has_next>, <#else></#if><#else>не указан</#if></#list>
<#else><#assign formula = "SELECT contrl_name.orig_shortname as controller FROM F_DP_TasksResolution res LEFT JOIN F_DP_RkkBase_Controller contrl ON contrl.owner = res.id LEFT JOIN so_beard contrl_name ON contrl_name.id = contrl.Controller WHERE res.id = {0}"><#assign collection = session.findByQuery(formula, document.getId())><#list collection.stream().toArray() as beard><#if collection.get(0).getString("controller")??>${beard.getString("controller")}<#if beard_has_next>, <#else></#if><#else>не указан</#if></#list></#if></p>
<p>Срок: <#if document.get("ctrldeadline")??><#assign ctrldeadline = document.get("ctrldeadline")><#assign day = ctrldeadline.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = ctrldeadline.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = ctrldeadline.getYear()?c><#assign resultСtrldeadline = resultDay + "." + resultMonth + "." + resultYear>${resultСtrldeadline}<#else>не указан</#if></p>
<p>Модуль: <#if document.get("Module.Title")??>${document.get("Module.Title")}<#else></#if></p>
<p>Заголовок: <#if moduleType=="Tasks">Поручение<#assign resolutionDate = document.get("date")><#if resolutionDate??><#assign day = resolutionDate.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = resolutionDate.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = resolutionDate.getYear()?c><#assign resultResolutionDate = resultDay + "." + resultMonth + "." + resultYear> от ${resultResolutionDate}<#else></#if>
<#else><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else><#if document.get("HierRoot.HierRoot")?? && document.get("HierRoot.HierRoot.Type")??>${document.get("HierRoot.HierRoot.Type")}<#else></#if></#if><#if document.get("HierRoot.regdate")??><#assign regDate = document.get("HierRoot.regdate")><#assign day = regDate.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = regDate.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = regDate.getYear()?c><#assign resultRegDate = resultDay + "." + resultMonth + "." + resultYear> от ${resultRegDate}<#else></#if>
</#if> № <#if document.get("HierRoot")??><#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if></#if>
<#else><#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if>
</#if><#if moduleType=="Tasks"><#else><#if document.get("HierRoot.Subject")??> «${document.get("HierRoot.Subject")}»<#else></#if></#if></p>
<p>Краткое содержание: Завершено создание периодических <#if isResolution>резолюций<#else>поручений</#if> от ${resolutionAuthor}</p>
<p>Открыть документ: <a href="${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}">ссылка</a></p>
</body>]]></body-html>
      <attachment lang="FreeMarker"><![CDATA[<#if document.get("HierRoot")??>${document.get("HierRoot").toStringRepresentation()}#F_ContentFiles_Rkk;${document.get("HierRoot").toStringRepresentation()}#F_AddFiles_Rkk#contentAdditional;${document.getId().toStringRepresentation()}#F_ContentFiles_Res<#else>${document.getId().toStringRepresentation()}#F_ContentFiles_TaskRes;${document.getId().toStringRepresentation()}#F_AddFiles_Rkk#contentAdditional</#if>]]></attachment>
      <richText lang="FreeMarker"><![CDATA[<#if document.get("HierRoot")??>${document.get("HierRoot").toStringRepresentation()}#F_ContentRichText_Rkk##Текст документа;${document.get("HierRoot").toStringRepresentation()}#F_AddFiles_Rkk#richTextAdditional#Дополнительный текст документа;${document.getId().toStringRepresentation()}#F_ContentRichText_Res##Текст<#else>${document.getId().toStringRepresentation()}#F_ContentRichText_TaskRes##Текст;${document.getId().toStringRepresentation()}#F_AddFiles_Rkk#richTextAdditional#Дополнительный текст</#if>]]></richText>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[Завершено создание периодических <#assign moduleType = document.get("Module.Type.Alias")><#assign isResolution = moduleType=="InputDocs" || moduleType=="InternalDocs" || moduleType=="Requests"><#assign isContract = moduleType=="ContractsLite"><#assign isInput = moduleType=="InputDocs"><#assign resolutionAuthor = document.get("Author.orig_shortname")><#if isResolution>резолюций<#else>поручений</#if> от ${resolutionAuthor} (срок <#if document.get("ctrldeadline")??><#assign ctrldeadline = document.get("ctrldeadline")><#assign day = ctrldeadline.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = ctrldeadline.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = ctrldeadline.getYear()?c><#assign resultСtrldeadline = resultDay + "." + resultMonth + "." + resultYear>${resultСtrldeadline}<#else>не указан</#if>)<#if moduleType=="Tasks"> от <#assign resolutionDate = document.get("date")><#if resolutionDate??><#assign day = resolutionDate.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = resolutionDate.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = resolutionDate.getYear()?c><#assign resultResolutionDate = resultDay + "." + resultMonth + "." + resultYear>${resultResolutionDate}<#else></#if><#else> по документу <#if isContract><#assign dogForm = document.get("HierRoot.Form")><#if dogForm??><#if dogForm=="Dog">Договор<#else></#if><#if dogForm=="AddAgr">Доп. соглашение<#else></#if><#if dogForm=="DocDogovor">Документ к договору<#else></#if><#if dogForm=="Finance">Финансовый документ<#else></#if><#else></#if><#else><#if document.get("HierRoot.Type")??><#assign type = document.get("HierRoot.Type")><#if (document.get("HierRoot.medogatestate")?? && (document.get("HierRoot.medogatestate")==2 || document.get("HierRoot.medogatestate")==3))><#assign colon = type?index_of(":")><#if colon == -1>${type}<#else>${type?substring(0, colon)}</#if><#else>${type}</#if><#else></#if></#if><#if document.get("HierRoot.regdate")??><#assign regDate = document.get("HierRoot.regdate")><#assign day = regDate.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = regDate.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = regDate.getYear()?c><#assign resultRegDate = resultDay + "." + resultMonth + "." + resultYear> от ${resultRegDate}<#else></#if></#if> № <#if document.get("HierRoot")??><#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if></#if><#else><#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if></#if>]]></subject>
      <body-html lang="FreeMarker"><![CDATA[<#assign moduleType = document.get("Module.Type.Alias")><#assign isResolution = moduleType=="InputDocs" || moduleType=="InternalDocs" || moduleType=="Requests"><#assign resolutionAuthor = document.get("Author.orig_shortname")>
<head><style>p { font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 10pt;}</style></head>
<body><p><#if isResolution>Резолюция<#else>Поручение</#if>: ${document.get("Resolution")}</p>
<p>От: Система</p>
<p>Для:<#list Sochi$Pkd.beardsTo() as beard> ${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list></p>
<p>Контролер: <#if document.get("HierRoot")??><#assign formula = "SELECT contrl_name.orig_shortname as controller FROM F_DP_Resolution res LEFT JOIN F_DP_ResltnBase_Cntrller contrl ON contrl.owner = res.id LEFT JOIN so_beard contrl_name ON contrl_name.id = contrl.Controller WHERE res.id = {0}"><#assign collection = session.findByQuery(formula, document.getId())><#list collection.stream().toArray() as beard><#if collection.get(0).getString("controller")??>${beard.getString("controller")}<#if beard_has_next>, <#else></#if><#else>не указан</#if></#list>
<#else><#assign formula = "SELECT contrl_name.orig_shortname as controller FROM F_DP_TasksResolution res LEFT JOIN F_DP_RkkBase_Controller contrl ON contrl.owner = res.id LEFT JOIN so_beard contrl_name ON contrl_name.id = contrl.Controller WHERE res.id = {0}"><#assign collection = session.findByQuery(formula, document.getId())><#list collection.stream().toArray() as beard><#if collection.get(0).getString("controller")??>${beard.getString("controller")}<#if beard_has_next>, <#else></#if><#else>не указан</#if></#list></#if></p>
<p>Срок: <#if document.get("ctrldeadline")??><#assign ctrldeadline = document.get("ctrldeadline")><#assign day = ctrldeadline.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = ctrldeadline.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = ctrldeadline.getYear()?c><#assign resultСtrldeadline = resultDay + "." + resultMonth + "." + resultYear>${resultСtrldeadline}<#else>не указан</#if></p>
<p>Модуль: <#if document.get("Module.Title")??>${document.get("Module.Title")}<#else></#if></p>
<p>Заголовок: <#if moduleType=="Tasks">Поручение<#assign resolutionDate = document.get("date")><#if resolutionDate??><#assign day = resolutionDate.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = resolutionDate.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = resolutionDate.getYear()?c><#assign resultResolutionDate = resultDay + "." + resultMonth + "." + resultYear> от ${resultResolutionDate}<#else></#if>
<#else><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else><#if document.get("HierRoot.HierRoot")?? && document.get("HierRoot.HierRoot.Type")??>${document.get("HierRoot.HierRoot.Type")}<#else></#if></#if><#if document.get("HierRoot.regdate")??><#assign regDate = document.get("HierRoot.regdate")><#assign day = regDate.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = regDate.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = regDate.getYear()?c><#assign resultRegDate = resultDay + "." + resultMonth + "." + resultYear> от ${resultRegDate}<#else></#if>
</#if> № <#if document.get("HierRoot")??><#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if></#if>
<#else><#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if>
</#if><#if moduleType=="Tasks"><#else><#if document.get("HierRoot.Subject")??> «${document.get("HierRoot.Subject")}»<#else></#if></#if></p>
<p>Краткое содержание: Завершено создание периодических <#if isResolution>резолюций<#else>поручений</#if> от ${resolutionAuthor}</p>
<p>Открыть документ: <a href="${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}">ссылка</a></p>
</body>]]></body-html>
    </inputbox-channel>
  </notification>
  <notification locale="RU" type="PERR1_11">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[Увольнение исполнителя <#assign moduleType = document.get("Module.Type.Alias")><#assign isResolution = moduleType=="InputDocs" || moduleType=="InternalDocs" || moduleType=="Requests"><#assign isContract = moduleType=="ContractsLite"><#assign isInput = moduleType=="InputDocs"><#assign resolutionAuthor = document.get("Author.orig_shortname")><#if isResolution>резолюции<#else>поручения</#if> от ${resolutionAuthor} (срок <#if document.get("ctrldeadline")??><#assign ctrldeadline = document.get("ctrldeadline")><#assign day = ctrldeadline.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = ctrldeadline.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = ctrldeadline.getYear()?c><#assign resultСtrldeadline = resultDay + "." + resultMonth + "." + resultYear>${resultСtrldeadline}<#else>не указан</#if>)<#if moduleType=="Tasks"> от <#assign resolutionDate = document.get("date")><#if resolutionDate??><#assign day = resolutionDate.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = resolutionDate.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = resolutionDate.getYear()?c><#assign resultResolutionDate = resultDay + "." + resultMonth + "." + resultYear>${resultResolutionDate}<#else></#if><#else> по документу <#if isContract><#assign dogForm = document.get("HierRoot.Form")><#if dogForm??><#if dogForm=="Dog">Договор<#else></#if><#if dogForm=="AddAgr">Доп. соглашение<#else></#if><#if dogForm=="DocDogovor">Документ к договору<#else></#if><#if dogForm=="Finance">Финансовый документ<#else></#if><#else></#if><#else><#if document.get("HierRoot.Type")??><#assign type = document.get("HierRoot.Type")><#if (document.get("HierRoot.medogatestate")?? && (document.get("HierRoot.medogatestate")==2 || document.get("HierRoot.medogatestate")==3))><#assign colon = type?index_of(":")><#if colon == -1>${type}<#else>${type?substring(0, colon)}</#if><#else>${type}</#if><#else></#if></#if><#if document.get("HierRoot.regdate")??><#assign regDate = document.get("HierRoot.regdate")><#assign day = regDate.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = regDate.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = regDate.getYear()?c><#assign resultRegDate = resultDay + "." + resultMonth + "." + resultYear> от ${resultRegDate}<#else></#if></#if> № <#if document.get("HierRoot")??><#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if></#if><#else><#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if></#if>]]></subject>
      <body-html lang="FreeMarker"><![CDATA[<#assign moduleType = document.get("Module.Type.Alias")><#assign isResolution = moduleType=="InputDocs" || moduleType=="InternalDocs" || moduleType=="Requests"><#assign resolutionAuthor = document.get("Author.orig_shortname")>
<head><style>p { font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 10pt;}</style></head>
<body><p><#if isResolution>Резолюция<#else>Поручение</#if>: ${document.get("Resolution")}</p>
<p>От: Система</p>
<p>Для:<#list Sochi$Pkd.beardsTo() as beard> ${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list></p>
<p>Контролер: <#if document.get("HierRoot")??><#assign formula = "SELECT contrl_name.orig_shortname as controller FROM F_DP_Resolution res LEFT JOIN F_DP_ResltnBase_Cntrller contrl ON contrl.owner = res.id LEFT JOIN so_beard contrl_name ON contrl_name.id = contrl.Controller WHERE res.id = {0}"><#assign collection = session.findByQuery(formula, document.getId())><#list collection.stream().toArray() as beard><#if collection.get(0).getString("controller")??>${beard.getString("controller")}<#if beard_has_next>, <#else></#if><#else>не указан</#if></#list>
<#else><#assign formula = "SELECT contrl_name.orig_shortname as controller FROM F_DP_TasksResolution res LEFT JOIN F_DP_RkkBase_Controller contrl ON contrl.owner = res.id LEFT JOIN so_beard contrl_name ON contrl_name.id = contrl.Controller WHERE res.id = {0}"><#assign collection = session.findByQuery(formula, document.getId())><#list collection.stream().toArray() as beard><#if collection.get(0).getString("controller")??>${beard.getString("controller")}<#if beard_has_next>, <#else></#if><#else>не указан</#if></#list></#if></p>
<p>Срок: <#if document.get("ctrldeadline")??><#assign ctrldeadline = document.get("ctrldeadline")><#assign day = ctrldeadline.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = ctrldeadline.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = ctrldeadline.getYear()?c><#assign resultСtrldeadline = resultDay + "." + resultMonth + "." + resultYear>${resultСtrldeadline}<#else>не указан</#if></p>
<p>Модуль: <#if document.get("Module.Title")??>${document.get("Module.Title")}<#else></#if></p>
<p>Заголовок: <#if moduleType=="Tasks">Поручение<#assign resolutionDate = document.get("date")><#if resolutionDate??><#assign day = resolutionDate.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = resolutionDate.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = resolutionDate.getYear()?c><#assign resultResolutionDate = resultDay + "." + resultMonth + "." + resultYear> от ${resultResolutionDate}<#else></#if>
<#else><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else><#if document.get("HierRoot.HierRoot")?? && document.get("HierRoot.HierRoot.Type")??>${document.get("HierRoot.HierRoot.Type")}<#else></#if></#if><#if document.get("HierRoot.regdate")??><#assign regDate = document.get("HierRoot.regdate")><#assign day = regDate.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = regDate.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = regDate.getYear()?c><#assign resultRegDate = resultDay + "." + resultMonth + "." + resultYear> от ${resultRegDate}<#else></#if>
</#if> № <#if document.get("HierRoot")??><#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if></#if>
<#else><#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if>
</#if><#if moduleType=="Tasks"><#else><#if document.get("HierRoot.Subject")??> «${document.get("HierRoot.Subject")}»<#else></#if></#if></p>
<p>Краткое содержание: Исполнитель <#if isResolution>резолюции<#else>поручения</#if> <#if document.get("HierRoot")??><#assign formula = "SELECT execcurr_name.orig_shortname as executor FROM F_DP_Resolution res LEFT JOIN f_dp_resltnbase_execcurr executor ON executor.owner = res.id LEFT JOIN so_beard execcurr_name ON execcurr_name.id = executor.executorcurr WHERE execcurr_name.isactive <> 1 AND res.id = {0}"><#assign collection = session.findByQuery(formula, document.getId())>
<#else><#assign formula = "SELECT execcurr_name.orig_shortname as executor FROM F_DP_TasksResolution res LEFT JOIN F_DP_TasksResolution_EC executor ON executor.owner = res.id LEFT JOIN so_beard execcurr_name ON execcurr_name.id = executor.executorcurr WHERE execcurr_name.isactive <> 1 AND res.id = {0}"><#assign collection = session.findByQuery(formula, document.getId())>
</#if><#list collection.stream().toArray() as beard><#if collection.get(0).getString("executor")??>${beard.getString("executor")}<#if beard_has_next>, <#else></#if><#else></#if></#list> уволен</p>
<p>Исполнители: <#if document.get("HierRoot")??><#assign formula = "SELECT execcurr_name.orig_shortname as executor FROM F_DP_Resolution res LEFT JOIN f_dp_resltnbase_execcurr executor ON executor.owner = res.id LEFT JOIN so_beard execcurr_name ON execcurr_name.id = executor.executorcurr WHERE res.id = {0}"><#assign collection = session.findByQuery(formula, document.getId())>
<#else><#assign formula = "SELECT execcurr_name.orig_shortname as executor FROM F_DP_TasksResolution res LEFT JOIN F_DP_TasksResolution_EC executor ON executor.owner = res.id LEFT JOIN so_beard execcurr_name ON execcurr_name.id = executor.executorcurr WHERE res.id = {0}"><#assign collection = session.findByQuery(formula, document.getId())>
</#if><#list collection.stream().toArray() as beard><#if collection.get(0).getString("executor")??>${beard.getString("executor")}<#if beard_has_next>, <#else></#if><#else></#if></#list></p>
<p>Открыть документ: <a href="${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}">ссылка</a></p>
</body>]]></body-html>
      <attachment lang="FreeMarker"><![CDATA[<#if document.get("HierRoot")??>${document.get("HierRoot").toStringRepresentation()}#F_ContentFiles_Rkk;${document.get("HierRoot").toStringRepresentation()}#F_AddFiles_Rkk#contentAdditional;${document.getId().toStringRepresentation()}#F_ContentFiles_Res<#else>${document.getId().toStringRepresentation()}#F_ContentFiles_TaskRes;${document.getId().toStringRepresentation()}#F_AddFiles_Rkk#contentAdditional</#if>]]></attachment>
      <richText lang="FreeMarker"><![CDATA[<#if document.get("HierRoot")??>${document.get("HierRoot").toStringRepresentation()}#F_ContentRichText_Rkk##Текст документа;${document.get("HierRoot").toStringRepresentation()}#F_AddFiles_Rkk#richTextAdditional#Дополнительный текст документа;${document.getId().toStringRepresentation()}#F_ContentRichText_Res##Текст<#else>${document.getId().toStringRepresentation()}#F_ContentRichText_TaskRes##Текст;${document.getId().toStringRepresentation()}#F_AddFiles_Rkk#richTextAdditional#Дополнительный текст</#if>]]></richText>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[Увольнение исполнителя <#assign moduleType = document.get("Module.Type.Alias")><#assign isResolution = moduleType=="InputDocs" || moduleType=="InternalDocs" || moduleType=="Requests"><#assign isContract = moduleType=="ContractsLite"><#assign isInput = moduleType=="InputDocs"><#assign resolutionAuthor = document.get("Author.orig_shortname")><#if isResolution>резолюции<#else>поручения</#if> от ${resolutionAuthor} (срок <#if document.get("ctrldeadline")??><#assign ctrldeadline = document.get("ctrldeadline")><#assign day = ctrldeadline.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = ctrldeadline.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = ctrldeadline.getYear()?c><#assign resultСtrldeadline = resultDay + "." + resultMonth + "." + resultYear>${resultСtrldeadline}<#else>не указан</#if>)<#if moduleType=="Tasks"> от <#assign resolutionDate = document.get("date")><#if resolutionDate??><#assign day = resolutionDate.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = resolutionDate.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = resolutionDate.getYear()?c><#assign resultResolutionDate = resultDay + "." + resultMonth + "." + resultYear>${resultResolutionDate}<#else></#if><#else> по документу <#if isContract><#assign dogForm = document.get("HierRoot.Form")><#if dogForm??><#if dogForm=="Dog">Договор<#else></#if><#if dogForm=="AddAgr">Доп. соглашение<#else></#if><#if dogForm=="DocDogovor">Документ к договору<#else></#if><#if dogForm=="Finance">Финансовый документ<#else></#if><#else></#if><#else><#if document.get("HierRoot.Type")??><#assign type = document.get("HierRoot.Type")><#if (document.get("HierRoot.medogatestate")?? && (document.get("HierRoot.medogatestate")==2 || document.get("HierRoot.medogatestate")==3))><#assign colon = type?index_of(":")><#if colon == -1>${type}<#else>${type?substring(0, colon)}</#if><#else>${type}</#if><#else></#if></#if><#if document.get("HierRoot.regdate")??><#assign regDate = document.get("HierRoot.regdate")><#assign day = regDate.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = regDate.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = regDate.getYear()?c><#assign resultRegDate = resultDay + "." + resultMonth + "." + resultYear> от ${resultRegDate}<#else></#if></#if> № <#if document.get("HierRoot")??><#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if></#if><#else><#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if></#if>]]></subject>
      <body-html lang="FreeMarker"><![CDATA[<#assign moduleType = document.get("Module.Type.Alias")><#assign isResolution = moduleType=="InputDocs" || moduleType=="InternalDocs" || moduleType=="Requests"><#assign resolutionAuthor = document.get("Author.orig_shortname")>
<head><style>p { font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 10pt;}</style></head>
<body><p><#if isResolution>Резолюция<#else>Поручение</#if>: ${document.get("Resolution")}</p>
<p>От: Система</p>
<p>Для:<#list Sochi$Pkd.beardsTo() as beard> ${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list></p>
<p>Контролер: <#if document.get("HierRoot")??><#assign formula = "SELECT contrl_name.orig_shortname as controller FROM F_DP_Resolution res LEFT JOIN F_DP_ResltnBase_Cntrller contrl ON contrl.owner = res.id LEFT JOIN so_beard contrl_name ON contrl_name.id = contrl.Controller WHERE res.id = {0}"><#assign collection = session.findByQuery(formula, document.getId())><#list collection.stream().toArray() as beard><#if collection.get(0).getString("controller")??>${beard.getString("controller")}<#if beard_has_next>, <#else></#if><#else>не указан</#if></#list>
<#else><#assign formula = "SELECT contrl_name.orig_shortname as controller FROM F_DP_TasksResolution res LEFT JOIN F_DP_RkkBase_Controller contrl ON contrl.owner = res.id LEFT JOIN so_beard contrl_name ON contrl_name.id = contrl.Controller WHERE res.id = {0}"><#assign collection = session.findByQuery(formula, document.getId())><#list collection.stream().toArray() as beard><#if collection.get(0).getString("controller")??>${beard.getString("controller")}<#if beard_has_next>, <#else></#if><#else>не указан</#if></#list></#if></p>
<p>Срок: <#if document.get("ctrldeadline")??><#assign ctrldeadline = document.get("ctrldeadline")><#assign day = ctrldeadline.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = ctrldeadline.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = ctrldeadline.getYear()?c><#assign resultСtrldeadline = resultDay + "." + resultMonth + "." + resultYear>${resultСtrldeadline}<#else>не указан</#if></p>
<p>Модуль: <#if document.get("Module.Title")??>${document.get("Module.Title")}<#else></#if></p>
<p>Заголовок: <#if moduleType=="Tasks">Поручение<#assign resolutionDate = document.get("date")><#if resolutionDate??><#assign day = resolutionDate.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = resolutionDate.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = resolutionDate.getYear()?c><#assign resultResolutionDate = resultDay + "." + resultMonth + "." + resultYear> от ${resultResolutionDate}<#else></#if>
<#else><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else><#if document.get("HierRoot.HierRoot")?? && document.get("HierRoot.HierRoot.Type")??>${document.get("HierRoot.HierRoot.Type")}<#else></#if></#if><#if document.get("HierRoot.regdate")??><#assign regDate = document.get("HierRoot.regdate")><#assign day = regDate.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = regDate.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = regDate.getYear()?c><#assign resultRegDate = resultDay + "." + resultMonth + "." + resultYear> от ${resultRegDate}<#else></#if>
</#if> № <#if document.get("HierRoot")??><#if document.get("HierRoot.regnumber")??>${document.get("HierRoot.regnumber")}<#else><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if></#if>
<#else><#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if>
</#if><#if moduleType=="Tasks"><#else><#if document.get("HierRoot.Subject")??> «${document.get("HierRoot.Subject")}»<#else></#if></#if></p>
<p>Краткое содержание: Исполнитель <#if isResolution>резолюции<#else>поручения</#if> <#if document.get("HierRoot")??><#assign formula = "SELECT execcurr_name.orig_shortname as executor FROM F_DP_Resolution res LEFT JOIN f_dp_resltnbase_execcurr executor ON executor.owner = res.id LEFT JOIN so_beard execcurr_name ON execcurr_name.id = executor.executorcurr WHERE execcurr_name.isactive <> 1 AND res.id = {0}"><#assign collection = session.findByQuery(formula, document.getId())>
<#else><#assign formula = "SELECT execcurr_name.orig_shortname as executor FROM F_DP_TasksResolution res LEFT JOIN F_DP_TasksResolution_EC executor ON executor.owner = res.id LEFT JOIN so_beard execcurr_name ON execcurr_name.id = executor.executorcurr WHERE execcurr_name.isactive <> 1 AND res.id = {0}"><#assign collection = session.findByQuery(formula, document.getId())>
</#if><#list collection.stream().toArray() as beard><#if collection.get(0).getString("executor")??>${beard.getString("executor")}<#if beard_has_next>, <#else></#if><#else></#if></#list> уволен</p>
<p>Исполнители: <#if document.get("HierRoot")??><#assign formula = "SELECT execcurr_name.orig_shortname as executor FROM F_DP_Resolution res LEFT JOIN f_dp_resltnbase_execcurr executor ON executor.owner = res.id LEFT JOIN so_beard execcurr_name ON execcurr_name.id = executor.executorcurr WHERE res.id = {0}"><#assign collection = session.findByQuery(formula, document.getId())>
<#else><#assign formula = "SELECT execcurr_name.orig_shortname as executor FROM F_DP_TasksResolution res LEFT JOIN F_DP_TasksResolution_EC executor ON executor.owner = res.id LEFT JOIN so_beard execcurr_name ON execcurr_name.id = executor.executorcurr WHERE res.id = {0}"><#assign collection = session.findByQuery(formula, document.getId())>
</#if><#list collection.stream().toArray() as beard><#if collection.get(0).getString("executor")??>${beard.getString("executor")}<#if beard_has_next>, <#else></#if><#else></#if></#list></p>
<p>Открыть документ: <a href="${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}">ссылка</a></p>
</body>]]></body-html>
    </inputbox-channel>
  </notification>

  <!-- Назначение контролера -->
  <notification locale="RU" type="NotificationByControlResolution1">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[Вы назначены контролером по <#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюции<#else>Поручению</#if> от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if> (срок <#if document.get("ctrldeadline")??><#assign d2 = document.get("ctrldeadline")?index_of("-")><#assign d0 = document.get("ctrldeadline")?last_index_of("-")> <#assign dy = document.get("ctrldeadline")?substring(0,d2)><#assign dd = document.get("ctrldeadline")?substring(d0+1)><#assign dm = document.get("ctrldeadline")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>)]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>


Для: <#list Sochi$Pkd.beardsTo() as beard>${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

ДОКУМЕНТ: <#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if> от <#if  document.get("HierRoot.Module.Type.Alias")=="Tasks"><#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else><#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}
<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if>


Срок: <#if document.get("ctrldeadline")??><#assign d2 = document.get("ctrldeadline")?index_of("-")><#assign d0 = document.get("ctrldeadline")?last_index_of("-")><#assign dy = document.get("ctrldeadline")?substring(0,d2)><#assign dd = document.get("ctrldeadline")?substring(d0+1)><#assign dm = document.get("ctrldeadline")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[Вы назначены контролером по <#if  document.get("Module.Type.Alias")=="InputDocs" || document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюции<#else>Поручению</#if> от <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if> (срок <#if document.get("ctrldeadline")??><#assign d2 = document.get("ctrldeadline")?index_of("-")><#assign d0 = document.get("ctrldeadline")?last_index_of("-")><#assign dy = document.get("ctrldeadline")?substring(0,d2)><#assign dd = document.get("ctrldeadline")?substring(d0+1)><#assign dm = document.get("ctrldeadline")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>)]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Author.Orig_ShortName")??>${document.get("Author.Orig_ShortName")}<#else></#if>


Для: <#list Sochi$Pkd.beardsTo() as beard>${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

ДОКУМЕНТ: <#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if> № <#if document.get("HierRoot.RegNumPrist")??>${document.get("HierRoot.RegNumPrist")}<#else></#if><#if document.get("HierRoot.RegNumCnt")??>${document.get("HierRoot.RegNumCnt")}<#else></#if><#if document.get("HierRoot.RegNumFin")??>${document.get("HierRoot.RegNumFin")}<#else></#if> от <#if  document.get("HierRoot.Module.Type.Alias")=="Tasks"><#if document.get("HierRoot.date")??><#assign d2 = document.get("HierRoot.date")?index_of("-")><#assign d0 = document.get("HierRoot.date")?last_index_of("-")><#assign dy = document.get("HierRoot.date")?substring(0,d2)><#assign dd = document.get("HierRoot.date")?substring(d0+1)><#assign dm = document.get("HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else><#if document.get("HierRoot.regdate")??><#assign d2 = document.get("HierRoot.regdate")?index_of("-")><#assign d0 = document.get("HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if></#if>


Заголовок: <#if document.get("HierRoot.Subject")??>${document.get("HierRoot.Subject")}<#else></#if>


<#if  document.get("Module.Type.Alias")=="InputDocs" ||document.get("Module.Type.Alias")=="InternalDocs" || document.get("Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("Resolution")??>${document.get("Resolution")}<#else></#if>


Срок: <#if document.get("ctrldeadline")??><#assign d2 = document.get("ctrldeadline")?index_of("-")><#assign d0 = document.get("ctrldeadline")?last_index_of("-")><#assign dy = document.get("ctrldeadline")?substring(0,d2)><#assign dd = document.get("ctrldeadline")?substring(d0+1)><#assign dm = document.get("ctrldeadline")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}]]></body>
    </inputbox-channel>
  </notification>
  <notification locale="RU" type="NotificationByControlResolution3">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[Вы назначены контролером по <#if  document.get("owner.HierRoot.Module.Type.Alias")=="InputDocs" || document.get("owner.HierRoot.Module.Type.Alias")=="InternalDocs" || document.get("owner.HierRoot.Module.Type.Alias")=="Requests">Резолюции<#else>Поручению</#if> от <#if document.get("Owner.Author.Orig_ShortName")??>${document.get("Owner.Author.Orig_ShortName")}<#else></#if> (срок <#if document.get("owner.ctrldeadline")??><#assign d2 = document.get("owner.ctrldeadline")?index_of("-")><#assign d0 = document.get("owner.ctrldeadline")?last_index_of("-")><#assign dy = document.get("owner.ctrldeadline")?substring(0,d2)><#assign dd = document.get("owner.ctrldeadline")?substring(d0+1)><#assign dm = document.get("owner.ctrldeadline")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length> <#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>)]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Owner.Author.Orig_ShortName")??>${document.get("Owner.Author.Orig_ShortName")}<#else></#if>


Для: <#list Sochi$Pkd.beardsTo() as beard>${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

ДОКУМЕНТ: <#if document.get("owner.HierRoot.Type")??>${document.get("owner.HierRoot.Type")}<#else></#if> № <#if document.get("owner.HierRoot.regnumber")??>${document.get("owner.HierRoot.regnumber")}<#else><#if document.get("owner.HierRoot.regnumprist")??>${document.get("owner.HierRoot.regnumprist")}<#else></#if><#if document.get("owner.HierRoot.regnumcnt")??>${document.get("owner.HierRoot.regnumcnt")}<#else></#if><#if document.get("owner.HierRoot.regnumfin")??>${document.get("owner.HierRoot.regnumfin")}<#else></#if></#if> от <#if  document.get("Owner.HierRoot.Module.Type.Alias")=="Tasks"><#if document.get("Owner.HierRoot.date")??><#assign d2 = document.get("Owner.HierRoot.date")?index_of("-")><#assign d0 = document.get("Owner.HierRoot.date")?last_index_of("-")><#assign dy = document.get("Owner.HierRoot.date")?substring(0,d2)><#assign dd = document.get("Owner.HierRoot.date")?substring(d0+1)><#assign dm = document.get("Owner.HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else><#if document.get("owner.HierRoot.regdate")??><#assign d2 = document.get("owner.HierRoot.regdate")?index_of("-")><#assign d0 = document.get("owner.HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("owner.HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("owner.HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("owner.HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if></#if>


Заголовок:  <#if document.get("Owner.HierRoot.Subject")??>${document.get("Owner.HierRoot.Subject")}<#else></#if>


<#if  document.get("owner.HierRoot.Module.Type.Alias")=="InputDocs" ||document.get("owner.HierRoot.Module.Type.Alias")=="InternalDocs" || document.get("owner.HierRoot.Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("owner.Resolution")??>${document.get("owner.Resolution")}<#else></#if>


Срок: <#if document.get("owner.ctrldeadline")??><#assign d2 = document.get("owner.ctrldeadline")?index_of("-")><#assign d0 = document.get("owner.ctrldeadline")?last_index_of("-")><#assign dy = document.get("owner.ctrldeadline")?substring(0,d2)><#assign dd = document.get("owner.ctrldeadline")?substring(d0+1)><#assign dm = document.get("owner.ctrldeadline")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.get("Owner"))}]]></body>
    </email-channel>
    <inputbox-channel>
      <subject lang="FreeMarker"><![CDATA[Вы назначены контролером по <#if  document.get("owner.HierRoot.Module.Type.Alias")=="InputDocs" || document.get("owner.HierRoot.Module.Type.Alias")=="InternalDocs" || document.get("owner.HierRoot.Module.Type.Alias")=="Requests">Резолюции<#else>Поручению</#if> от <#if document.get("Owner.Author.Orig_ShortName")??>${document.get("Owner.Author.Orig_ShortName")}<#else></#if> (срок <#if document.get("owner.ctrldeadline")??><#assign d2 = document.get("owner.ctrldeadline")?index_of("-")><#assign d0 = document.get("owner.ctrldeadline")?last_index_of("-")><#assign dy = document.get("owner.ctrldeadline")?substring(0,d2)><#assign dd = document.get("owner.ctrldeadline")?substring(d0+1)><#assign dm = document.get("owner.ctrldeadline")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>)]]></subject>
      <body lang="FreeMarker"><![CDATA[От: <#if document.get("Owner.Author.Orig_ShortName")??>${document.get("Owner.Author.Orig_ShortName")}<#else></#if>


Для: <#list Sochi$Pkd.beardsTo() as beard>${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list>


Краткое содержание:

ДОКУМЕНТ: <#if document.get("owner.HierRoot.Type")??>${document.get("owner.HierRoot.Type")}<#else></#if> № <#if document.get("owner.HierRoot.regnumber")??>${document.get("owner.HierRoot.regnumber")}<#else><#if document.get("owner.HierRoot.regnumprist")??>${document.get("owner.HierRoot.regnumprist")}<#else></#if><#if document.get("owner.HierRoot.regnumcnt")??>${document.get("owner.HierRoot.regnumcnt")}<#else></#if><#if document.get("owner.HierRoot.regnumfin")??>${document.get("owner.HierRoot.regnumfin")}<#else></#if></#if> от <#if  document.get("Owner.HierRoot.Module.Type.Alias")=="Tasks"><#if document.get("Owner.HierRoot.date")??><#assign d2 = document.get("Owner.HierRoot.date")?index_of("-")><#assign d0 = document.get("Owner.HierRoot.date")?last_index_of("-")><#assign dy = document.get("Owner.HierRoot.date")?substring(0,d2)><#assign dd = document.get("Owner.HierRoot.date")?substring(d0+1)><#assign dm = document.get("Owner.HierRoot.date")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if><#else><#if document.get("owner.HierRoot.regdate")??><#assign d2 = document.get("owner.HierRoot.regdate")?index_of("-")><#assign d0 = document.get("owner.HierRoot.regdate")?last_index_of("-")><#assign dy = document.get("owner.HierRoot.regdate")?substring(0,d2)><#assign dd = document.get("owner.HierRoot.regdate")?substring(d0+1)><#assign dm = document.get("owner.HierRoot.regdate")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>
</#if>


Заголовок:  <#if document.get("Owner.HierRoot.Subject")??>${document.get("Owner.HierRoot.Subject")}<#else></#if>


<#if  document.get("owner.HierRoot.Module.Type.Alias")=="InputDocs" ||document.get("owner.HierRoot.Module.Type.Alias")=="InternalDocs" || document.get("owner.HierRoot.Module.Type.Alias")=="Requests">Резолюция<#else>Поручение</#if>: <#if document.get("owner.Resolution")??>${document.get("owner.Resolution")}<#else></#if>


Срок: <#if document.get("owner.ctrldeadline")??><#assign d2 = document.get("owner.ctrldeadline")?index_of("-")><#assign d0 = document.get("owner.ctrldeadline")?last_index_of("-")><#assign dy = document.get("owner.ctrldeadline")?substring(0,d2)><#assign dd = document.get("owner.ctrldeadline")?substring(d0+1)><#assign dm = document.get("owner.ctrldeadline")?substring(d2+1,d0)><#assign ddl = dd?length><#assign dml = dm?length><#if ddl??><#if ddl==2>${dd}<#else>0${dd}</#if><#else></#if>.<#if dml??><#if dml==2>${dm}<#else>0${dm}</#if><#else></#if>.<#if dy??>${dy}<#else></#if><#else></#if>


Открыть документ: ${urlFormer.getUrl("cm-sochi", addressee.getId(), document.get("Owner"))}]]></body>
    </inputbox-channel>
  </notification>

  <!-- Поручение прекращено -->
  <notification locale="RU" type="CanceledExecutionNotification">
    <email-channel>
      <subject lang="FreeMarker"><![CDATA[<#assign moduleType = document.get("Module.Type.Alias")><#assign isResolution = moduleType=="InputDocs" || moduleType=="InternalDocs" || moduleType=="Requests"><#assign resolutionAuthor = document.get("Author.orig_shortname")><#if isResolution>Прекращена резолюция<#else>Прекращено поручение</#if> от <#if moduleType=="Tasks"><#assign resolutionDate = document.get("date")><#if resolutionDate??><#assign day = resolutionDate.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = resolutionDate.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = resolutionDate.getYear()?c><#assign resultResolutionDate = resultDay + "." + resultMonth + "." + resultYear>${resultResolutionDate}<#else></#if><#else>${resolutionAuthor} по документу <#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if><#assign regDate = document.get("HierRoot.regdate")><#if regDate??><#assign day = regDate.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = regDate.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = regDate.getYear()?c><#assign resultRegDate = resultDay + "." + resultMonth + "." + resultYear> от ${resultRegDate}<#else></#if></#if> № <#if document.get("HierRoot")??><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if><#else><#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if></#if><#if moduleType=="Tasks"> от ${resolutionAuthor}<#else></#if>]]></subject>
      <body-html lang="FreeMarker"><![CDATA[<#assign moduleType = document.get("Module.Type.Alias")><#assign isResolution = moduleType=="InputDocs" || moduleType=="InternalDocs" || moduleType=="Requests"><#assign resolutionAuthor = document.get("Author.orig_shortname")><#assign resolutionText = document.get("Resolution")>
<head><style>p { font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 10pt;}</style></head>
<body><p>Для:<#list Sochi$Pkd.beardsTo() as beard> ${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list></p>
<p>Модуль: <#if document.get("Module.Title")??>${document.get("Module.Title")}<#else></#if></p>
<p>Заголовок: <#if moduleType=="Tasks">Поручение<#assign resolutionDate = document.get("date")><#if resolutionDate??><#assign day = resolutionDate.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = resolutionDate.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = resolutionDate.getYear()?c><#assign resultResolutionDate = resultDay + "." + resultMonth + "." + resultYear> от ${resultResolutionDate}<#else></#if>
<#else><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if><#assign regDate = document.get("HierRoot.regdate")><#if regDate??><#assign day = regDate.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = regDate.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = regDate.getYear()?c><#assign resultRegDate = resultDay + "." + resultMonth + "." + resultYear> от ${resultRegDate}<#else></#if>
</#if> № <#if document.get("HierRoot")??><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if>
<#else><#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if>
</#if><#if moduleType=="Tasks"><#else><#if document.get("HierRoot.Subject")??> «${document.get("HierRoot.Subject")}»<#else></#if></#if></p>
<p>Краткое содержание: <#if isResolution>Прекращена резолюция<#else>Прекращено поручение</#if> от ${resolutionAuthor}</p>
<p><#if isResolution>Резолюция<#else>Поручение</#if>: ${resolutionText}</p>
<p>Открыть документ: <a href="${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}">ссылка</a></p>
</body>]]></body-html>
      <body lang="FreeMarker"><![CDATA[<#assign moduleType = document.get("Module.Type.Alias")><#assign isResolution = moduleType=="InputDocs" || moduleType=="InternalDocs" || moduleType=="Requests"><#assign resolutionAuthor = document.get("Author.orig_shortname")><#assign resolutionText = document.get("Resolution")>
<head><style>p { font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 10pt;}</style></head>
<body><p>Для:<#list Sochi$Pkd.beardsTo() as beard> ${crudService.find(beard).getString("orig_shortname")}<#if beard_has_next >, <#else></#if></#list></p>
<p>Модуль: <#if document.get("Module.Title")??>${document.get("Module.Title")}<#else></#if></p>
<p>Заголовок: <#if moduleType=="Tasks">Поручение<#assign resolutionDate = document.get("date")><#if resolutionDate??><#assign day = resolutionDate.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = resolutionDate.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = resolutionDate.getYear()?c><#assign resultResolutionDate = resultDay + "." + resultMonth + "." + resultYear> от ${resultResolutionDate}<#else></#if>
<#else><#if document.get("HierRoot.Type")??>${document.get("HierRoot.Type")}<#else></#if><#assign regDate = document.get("HierRoot.regdate")><#if regDate??><#assign day = regDate.getDayOfMonth()><#assign dayLessThan10 = day < 10><#assign dayPrefix = dayLessThan10?string("0", "")><#assign resultDay = dayPrefix + day><#assign month = regDate.getMonth() + 1><#assign monthLessThan10 = month < 10><#assign monthPrefix = monthLessThan10?string("0", "")><#assign resultMonth = monthPrefix + month><#assign resultYear = regDate.getYear()?c><#assign resultRegDate = resultDay + "." + resultMonth + "." + resultYear> от ${resultRegDate}<#else></#if>
</#if> № <#if document.get("HierRoot")??><#if document.get("HierRoot.regnumprist")??>${document.get("HierRoot.regnumprist")}<#else></#if><#if document.get("HierRoot.regnumcnt")??>${document.get("HierRoot.regnumcnt")}<#else></#if><#if document.get("HierRoot.regnumfin")??>${document.get("HierRoot.regnumfin")}<#else></#if>
<#else><#if document.get("regnumprist")??>${document.get("regnumprist")}<#else></#if><#if document.get("regnumcnt")??>${document.get("regnumcnt")}<#else></#if><#if document.get("regnumfin")??>${document.get("regnumfin")}<#else></#if>
</#if><#if moduleType=="Tasks"><#else><#if document.get("HierRoot.Subject")??> «${document.get("HierRoot.Subject")}»<#else></#if></#if></p>
<p>Краткое содержание: <#if isResolution>Прекращена резолюция<#else>Прекращено поручение</#if> от ${resolutionAuthor}</p>
<p><#if isResolution>Резолюция<#else>Поручение</#if>: ${resolutionText}</p>
<p>Открыть документ: <a href="${urlFormer.getUrl("cm-sochi", addressee.getId(), document.getId())}">ссылка</a></p>
</body>]]></body>
    </email-channel>
    <inputbox-channel />
  </notification>

</notifications>